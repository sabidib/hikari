<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>hikari.impl.entity_factory API documentation</title>
<meta name="description" content="Basic implementation of an entity factory for general bots and HTTP apps.">
<meta property="og:title" content="hikari.impl.entity_factory module list">
<meta property="og:type" content="website">
<meta property="og:image" content="https://hikari-py.github.io/hikari/logo.png">
<meta property="og:description" content="A Discord Bot framework for modern Python and asyncio built on good intentions">
<meta property="theme-color" content="#ff029a">
<link rel="shortcut icon" type="image/png" href="../../logo.png">
<!--<script async src="https://cse.google.com/cse.js?cx=017837193012385208679:pey8ky8gdqw"></script>
<style>.gsc-control-cse {padding:0 !important;margin-top:1em}</style>-->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css" rel="stylesheet">
<style>
img#logo {
border-radius: 15px;
width: 30px;
height: 30px;
margin-right: 0.5em;
text-indent: 100%;
white-space: nowrap;
overflow: hidden;
}
small.smaller {
font-size: 0.50em;
}
html {
height: 100%;
scroll-behavior: smooth;
scrollbar-color: #202324 #454a4d;
}
body {
background-color: #181A1B;
color: #C9C5C0;
height: fit-content;
}
h1 {
margin-top: 3rem;
}
h2 {
margin-top: 1.75rem;
margin-bottom: 1em;
}
h3 {
margin-top: 1.25rem;
}
h4 {
margin-top: 1rem;
}
.nav-section {
margin-top: 2em;
}
.monospaced {
font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
a.sidebar-nav-pill,
a.sidebar-nav-pill:active,
a.sidebar-nav-pill:hover {
color: #BDB7AF;
}
.module-source > details > pre {
display: block;
overflow-x: auto;
overflow-y: auto;
max-height: 600px;
font-size: 0.8em;
}
a {
color: #DE4F91;
}
a:hover {
color: #64B1F2;
}
.container > li {
margin-left: 1em;
margin-top: 2.5em;
}
.jumbotron {
background-color: #232627;
}
.breadcrumb-item.inactive > a {
color: #d264d0 !important;
}
.breadcrumb-item.active > a {
color: #de4f91 !important;
}
.breadcrumb-item+.breadcrumb-item::before {
content: ".";
}
.module-breadcrumb {
padding-left: 0 !important;
background-color: #232627;
}
ul.nested {
margin-left: 1em;
}
h2#parameters::after {
margin-left: 2em;
}
.anchor:target {
background-color: var(--dark);
}
@media screen and (max-width: 990px) {
.anchor:target {
margin-left: -2em;
padding-left: 2em;
}
}
@media screen and (min-width: 990px) {
.anchor:target {
border-radius: 0.5em; !important
margin-right: -2em;
padding-right: 2em;
margin-top: -1em;
padding-top: 1em;
}
}
dt {
margin-left: 2em;
}
dd {
margin-left: 4em;
}
dl.no-nest > dt {
margin-left: 0em;
}
dl.no-nest > dd {
margin-left: 2em;
}
dl.root {
margin-bottom: 2em;
}
.definition {
display: block;
margin-bottom: 8em !important;
}
.definition .row {
display: block;
margin-bottom: 4em !important;
}
.definition h2 {
font-size: 1em;
font-weight: bolder;
}
.sep {
height: 2em;
}
code {
color: #DB61D9;
}
code .active {
color: #e83e8c;
}
code a {
color: #E94A93;
}
a.dotted:hover, abbr:hover {
text-decoration: underline #9E9689 dotted !important;
}
a.dotted, abbr {
text-decoration: none !important;
}
.gsc-search-box, .gsc-search-box-tools, .gsc-control-cse {
background: none !important;
border: none !important;
}
.gsc-search-button-v2, .gsc-search-button-v2:hover, .gsc-search-button-v2:focus {
color: var(--success) !important;
border-color: var(--success) !important;
background: none !important;
padding: 6px 32px !important;
font-size: inherit !important;
}
.gsc-search-button-v2 > svg {
fill: var(--success) !important;
}
.gsc-input-box {
border-radius: 3px;
}
.gsc-control-cse {
width: 300px !important;
margin-top: 0 !important;
}
.gsc-control-cse .gsc-control-cse-en {
margin-top: 0 !important;
}
.bg-dark {
background-color: #2C2F31 !important;
}
.text-muted {
color: #9E9689 !important;
}
.alert-primary {
color: #7CC3FF;
background-color: #262A2B;
border-color: #003B7B;
}
.alert-secondary {
color: #C2BCB4;
background-color: #282B2C;
border-color: #3B4042;
}
.alert-success {
color: #99E6AB;
background-color: #1A3E29;
border-color: #255A32;
}
.alert-info {
color: #8EE3F1;
background-color: #143B43;
border-color: #1E5961;
}
.alert-warning {
color: #FBD770;
background-color: #513E00;
border-color: #7B5C00;
}
.alert-danger {
color: rgb(225, 134, 143);
background-color: rgb(67, 12, 17);
border-color: rgb(104, 18, 27);
}
mark {
background-color: #333333;
border-radius: 0.1em;
color: #DB61D9;
}
</style>
<script async src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_CHTML'></script>
</head>
<body>
<nav id="main-nav" class="navbar navbar-dark navbar-expand-lg bg-dark">
<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"/>
</button>
<a class="navbar-brand" href="https://github.com/hikari-py/hikari"><img class="d-inline-block align-top" src="../../logo.png" id="logo" alt="hikari logo" loading="lazy"/>Hikari <small class="smaller">2.0.0.dev102</small></a>
<div class="collapse navbar-collapse" id="navbarNavDropdown">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link active" href="../../hikari/index.html">Documentation</a></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/hikari-py/hikari">GitHub</a></li>
<li class="nav-item"><a class="nav-link" href="https://pypi.org/project/hikari">PyPI</a></li>
<li class="nav-item"><a class="nav-link" href="https://discord.gg/Jx4cNGG">Discord Server</a></li>
</ul>
<form class="form-inline" action="../../hikari/search.html">
<input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" id="lunr-search" name="q"/>
<button class="btn btn-outline-success my-2 my-sm-0" type="submit">&gt;</button>
</form>
</div>
</nav>
<div class="jumbotron jumbotron-fluid">
<div class="container">
<h1 class="display-4"><code>
<nav aria-label="breadcrumb">
<ol class="breadcrumb module-breadcrumb">
<li class="breadcrumb-item inactive"><a title="hikari -- A sane Python framework for writing modern Discord bots …" href="../index.html"
>hikari</a></li>
<li class="breadcrumb-item inactive"><a title="hikari.impl -- Basic implementations of application components …" href="index.html"
>impl</a></li>
<li class="breadcrumb-item active"><a href="#">entity_factory</a></li>
</ol>
</nav>
</code></h1>
<p class="lead"><p>Basic implementation of an entity factory for general bots and HTTP apps.</p></p>
</div>
</div>
<div class="container-xl">
<div class="row">
<div class="d-md-none d-lg-block col-lg-5 col-xl-4">
<!--<nav class="nav" id="content-nav">-->
<h3>This module</h3>
<ul class="list-unstyled text-truncate">
<li class="monospaced text-truncate">
<small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="EntityFactoryImpl -- Standard implementation for a serializer/deserializer …" href="#hikari.impl.entity_factory.EntityFactoryImpl"
>EntityFactoryImpl</a>
<ul class="list-unstyled nested text-truncate">
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_action_row -- Parse a raw payload from Discord into an action row component object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_action_row"
>deserialize_action_row</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_application -- Parse a raw payload from Discord into an application object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application"
>deserialize_application</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_application_webhook -- Parse a raw payload from Discord into an application webhook object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application_webhook"
>deserialize_application_webhook</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_audit_log -- Parse a raw payload from Discord into an audit log object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_audit_log"
>deserialize_audit_log</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_authorization_information -- Parse a raw payload from Discord into an authorization information object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_authorization_information"
>deserialize_authorization_information</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_authorization_token -- Parse a raw payload from Discord into an authorization token object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_authorization_token"
>deserialize_authorization_token</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_button -- Parse a raw payload from Discord into a button component object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_button"
>deserialize_button</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_channel -- Parse a raw payload from Discord into a channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel"
>deserialize_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_channel_follow -- Parse a raw payload from Discord into a channel follow object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follow"
>deserialize_channel_follow</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_channel_follower_webhook -- Parse a raw payload from Discord into a channel follower webhook object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follower_webhook"
>deserialize_channel_follower_webhook</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_command -- Parse a raw payload from Discord into a command object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_command"
>deserialize_command</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_command_interaction -- Parse a raw payload from Discord into a command interaction object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_command_interaction"
>deserialize_command_interaction</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_component -- Parse a raw payload from Discord into a message component object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_component"
>deserialize_component</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_component_interaction -- Parser a raw payload from Discord into a component interaction object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_component_interaction"
>deserialize_component_interaction</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_custom_emoji -- Parse a raw payload from Discord into a custom emoji object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_custom_emoji"
>deserialize_custom_emoji</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_dm -- Parse a raw payload from Discord into a DM channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_dm"
>deserialize_dm</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_embed -- Parse a raw payload from Discord into an embed object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_embed"
>deserialize_embed</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_emoji -- Parse a raw payload from Discord into an emoji object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_emoji"
>deserialize_emoji</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_gateway_bot_info -- Parse a raw payload from Discord into a gateway bot object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_bot_info"
>deserialize_gateway_bot_info</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_gateway_guild -- Parse a raw payload from Discord into a guild object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_guild"
>deserialize_gateway_guild</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_group_dm -- Parse a raw payload from Discord into a group DM channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_group_dm"
>deserialize_group_dm</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_category -- Parse a raw payload from Discord into a guild category object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_category"
>deserialize_guild_category</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_command_permissions -- Parse a raw payload from Discord into guild command permissions object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_command_permissions"
>deserialize_guild_command_permissions</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_member_ban -- Parse a raw payload from Discord into a guild member ban object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_member_ban"
>deserialize_guild_member_ban</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_news_channel -- Parse a raw payload from Discord into a guild news channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_news_channel"
>deserialize_guild_news_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_preview -- Parse a raw payload from Discord into a guild preview object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_preview"
>deserialize_guild_preview</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_stage_channel -- Parse a raw payload from Discord into a guild stage channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_stage_channel"
>deserialize_guild_stage_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_sticker -- Parse a raw payload from Discord into a guild sticker object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_sticker"
>deserialize_guild_sticker</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_store_channel -- Parse a raw payload from Discord into a guild store channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_store_channel"
>deserialize_guild_store_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_text_channel -- Parse a raw payload from Discord into a guild text channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_text_channel"
>deserialize_guild_text_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_voice_channel -- Parse a raw payload from Discord into a guild voice channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_voice_channel"
>deserialize_guild_voice_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_guild_widget -- Parse a raw payload from Discord into a guild widget object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_widget"
>deserialize_guild_widget</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_implicit_token -- Parse a query from Discord into an implicit token object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_implicit_token"
>deserialize_implicit_token</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_incoming_webhook -- Parse a raw payload from Discord into a incoming webhook object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_incoming_webhook"
>deserialize_incoming_webhook</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_integration -- Parse a raw payload from Discord into an integration object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_integration"
>deserialize_integration</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_interaction -- Parse a raw payload from Discord into a interaction object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_interaction"
>deserialize_interaction</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_invite -- Parse a raw payload from Discord into an invite object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite"
>deserialize_invite</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_invite_with_metadata -- Parse a raw payload from Discord into a invite with metadata object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite_with_metadata"
>deserialize_invite_with_metadata</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_known_custom_emoji -- Parse a raw payload from Discord into a known custom emoji object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_known_custom_emoji"
>deserialize_known_custom_emoji</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_member -- Parse a raw payload from Discord into a member object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member"
>deserialize_member</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_member_presence -- Parse a raw payload from Discord into a member presence object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member_presence"
>deserialize_member_presence</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_message -- Parse a raw payload from Discord into a message object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_message"
>deserialize_message</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_my_user -- Parse a raw payload from Discord into a user object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_my_user"
>deserialize_my_user</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_own_connection -- Parse a raw payload from Discord into an own connection object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_connection"
>deserialize_own_connection</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_own_guild -- Parse a raw payload from Discord into an own guild object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_guild"
>deserialize_own_guild</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_partial_channel -- Parse a raw payload from Discord into a partial channel object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_channel"
>deserialize_partial_channel</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_partial_integration -- Parse a raw payload from Discord into a partial integration object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_integration"
>deserialize_partial_integration</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_partial_interaction -- Parse a raw payload from Discord into a partial interaction object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_interaction"
>deserialize_partial_interaction</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_partial_message -- Parse a raw payload from Discord into a partial message object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_message"
>deserialize_partial_message</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_partial_sticker -- Parse a raw payload from Discord into a partial sticker object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_sticker"
>deserialize_partial_sticker</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_partial_token -- Parse a raw payload from Discord into a partial OAuth2 token object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_token"
>deserialize_partial_token</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_permission_overwrite -- Parse a raw payload from Discord into a permission overwrite object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_permission_overwrite"
>deserialize_permission_overwrite</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_rest_guild -- Parse a raw payload from Discord into a guild object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_rest_guild"
>deserialize_rest_guild</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_role -- Parse a raw payload from Discord into a role object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_role"
>deserialize_role</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_select_menu -- Parse a raw payload from Discord into a select menu component object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_select_menu"
>deserialize_select_menu</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_standard_sticker -- Parse a raw payload from Discord into a standard sticker object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_standard_sticker"
>deserialize_standard_sticker</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_sticker_pack -- Parse a raw payload from Discord into a sticker pack object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_sticker_pack"
>deserialize_sticker_pack</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_template -- Parse a raw payload from Discord into a template object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_template"
>deserialize_template</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_unicode_emoji -- Parse a raw payload from Discord into a unicode emoji object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_unicode_emoji"
>deserialize_unicode_emoji</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_user -- Parse a raw payload from Discord into a user object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_user"
>deserialize_user</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_vanity_url -- Parse a raw payload from Discord into a vanity url object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_vanity_url"
>deserialize_vanity_url</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_voice_region -- Parse a raw payload from Discord into a voice region object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_region"
>deserialize_voice_region</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_voice_state -- Parse a raw payload from Discord into a voice state object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_state"
>deserialize_voice_state</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_webhook -- Parse a raw payload from Discord into a webhook object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_webhook"
>deserialize_webhook</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="deserialize_welcome_screen -- Parse a raw payload from Discord into a guild welcome screen object …" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_welcome_screen"
>deserialize_welcome_screen</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="serialize_command_option -- Serialize a command option object to a json serializable dict …" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_command_option"
>serialize_command_option</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="serialize_command_permission -- Serialize a command permission object to a json serializable dict …" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_command_permission"
>serialize_command_permission</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="serialize_embed -- Serialize an embed object to a json serializable dict …" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_embed"
>serialize_embed</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="serialize_permission_overwrite -- Serialize a permission overwrite object to a json serializable dict …" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_permission_overwrite"
>serialize_permission_overwrite</a>
</li>
<li class="text-truncate monospaced">
<small class='text-muted'><em><abbr title='A standard Python function.'>def</abbr></em></small> <a title="serialize_welcome_channel -- Serialize a welcome channel object to a json serializable dict …" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_welcome_channel"
>serialize_welcome_channel</a>
</li>
<br />
</ul>
</li>
</ul>
<!--</nav>-->
</div>
<div class="col-xs-12 col-lg-7 col-xl-8">
<div class="row">
<div class="col module-source">
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1-L2745" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-
# cython: language_level=3
# Copyright (c) 2020 Nekokatt
# Copyright (c) 2021 davfsa
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the &#34;Software&#34;), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED &#34;AS IS&#34;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.
&#34;&#34;&#34;Basic implementation of an entity factory for general bots and HTTP apps.&#34;&#34;&#34;

from __future__ import annotations

__all__: typing.List[str] = [&#34;EntityFactoryImpl&#34;]

import datetime
import logging
import typing

import attr

from hikari import applications as application_models
from hikari import audit_logs as audit_log_models
from hikari import channels as channel_models
from hikari import colors as color_models
from hikari import commands
from hikari import embeds as embed_models
from hikari import emojis as emoji_models
from hikari import errors
from hikari import files
from hikari import guilds as guild_models
from hikari import invites as invite_models
from hikari import messages as message_models
from hikari import permissions as permission_models
from hikari import presences as presence_models
from hikari import sessions as gateway_models
from hikari import snowflakes
from hikari import stickers as sticker_models
from hikari import templates as template_models
from hikari import traits
from hikari import undefined
from hikari import users as user_models
from hikari import voices as voice_models
from hikari import webhooks as webhook_models
from hikari.api import entity_factory
from hikari.interactions import base_interactions
from hikari.interactions import command_interactions
from hikari.interactions import component_interactions
from hikari.internal import attr_extensions
from hikari.internal import data_binding
from hikari.internal import time

_ValueT = typing.TypeVar(&#34;_ValueT&#34;)
_LOGGER: typing.Final[logging.Logger] = logging.getLogger(&#34;hikari.entity_factory&#34;)

_interaction_option_type_mapping: typing.Dict[int, typing.Callable[[typing.Any], typing.Any]] = {
    commands.OptionType.USER: snowflakes.Snowflake,
    commands.OptionType.CHANNEL: snowflakes.Snowflake,
    commands.OptionType.ROLE: snowflakes.Snowflake,
    commands.OptionType.MENTIONABLE: snowflakes.Snowflake,
}


def _with_int_cast(cast: typing.Callable[[int], _ValueT]) -&gt; typing.Callable[[typing.Any], _ValueT]:
    &#34;&#34;&#34;Wrap a cast to ensure the value passed to it will first be cast to int.&#34;&#34;&#34;
    return lambda value: cast(int(value))


def _deserialize_seconds_timedelta(seconds: typing.Union[str, int]) -&gt; datetime.timedelta:
    return datetime.timedelta(seconds=int(seconds))


def _deserialize_day_timedelta(days: typing.Union[str, int]) -&gt; datetime.timedelta:
    return datetime.timedelta(days=int(days))


def _deserialize_max_uses(age: int) -&gt; typing.Optional[int]:
    return age if age &gt; 0 else None


def _deserialize_max_age(seconds: int) -&gt; typing.Optional[datetime.timedelta]:
    return datetime.timedelta(seconds=seconds) if seconds &gt; 0 else None


@attr_extensions.with_copy
@attr.define(kw_only=True, repr=False, weakref_slot=False)
class _GuildChannelFields:
    id: snowflakes.Snowflake = attr.field()
    name: typing.Optional[str] = attr.field()
    type: typing.Union[channel_models.ChannelType, int] = attr.field()
    guild_id: snowflakes.Snowflake = attr.field()
    position: int = attr.field()
    permission_overwrites: typing.Dict[snowflakes.Snowflake, channel_models.PermissionOverwrite] = attr.field()
    is_nsfw: typing.Optional[bool] = attr.field()
    parent_id: typing.Optional[snowflakes.Snowflake] = attr.field()


@attr_extensions.with_copy
@attr.define(kw_only=True, repr=False, weakref_slot=False)
class _IntegrationFields:
    id: snowflakes.Snowflake = attr.field()
    name: str = attr.field()
    type: typing.Union[guild_models.IntegrationType, str] = attr.field()
    account: guild_models.IntegrationAccount = attr.field()


@attr_extensions.with_copy
@attr.define(kw_only=True, repr=False, weakref_slot=False)
class _GuildFields:
    id: snowflakes.Snowflake = attr.field()
    name: str = attr.field()
    icon_hash: str = attr.field()
    features: typing.List[typing.Union[guild_models.GuildFeature, str]] = attr.field()
    splash_hash: typing.Optional[str] = attr.field()
    discovery_splash_hash: typing.Optional[str] = attr.field()
    owner_id: snowflakes.Snowflake = attr.field()
    afk_channel_id: typing.Optional[snowflakes.Snowflake] = attr.field()
    afk_timeout: datetime.timedelta = attr.field()
    verification_level: typing.Union[guild_models.GuildVerificationLevel, int] = attr.field()
    default_message_notifications: typing.Union[guild_models.GuildMessageNotificationsLevel, int] = attr.field()
    explicit_content_filter: typing.Union[guild_models.GuildVerificationLevel, int] = attr.field()
    mfa_level: typing.Union[guild_models.GuildMFALevel, int] = attr.field()
    application_id: typing.Optional[snowflakes.Snowflake] = attr.field()
    widget_channel_id: typing.Optional[snowflakes.Snowflake] = attr.field()
    system_channel_id: typing.Optional[snowflakes.Snowflake] = attr.field()
    is_widget_enabled: typing.Optional[bool] = attr.field()
    system_channel_flags: guild_models.GuildSystemChannelFlag = attr.field()
    rules_channel_id: typing.Optional[snowflakes.Snowflake] = attr.field()
    max_video_channel_users: typing.Optional[int] = attr.field()
    vanity_url_code: typing.Optional[str] = attr.field()
    description: typing.Optional[str] = attr.field()
    banner_hash: typing.Optional[str] = attr.field()
    premium_tier: typing.Union[guild_models.GuildPremiumTier, int] = attr.field()
    premium_subscription_count: typing.Optional[int] = attr.field()
    preferred_locale: str = attr.field()
    public_updates_channel_id: typing.Optional[snowflakes.Snowflake] = attr.field()
    nsfw_level: guild_models.GuildNSFWLevel = attr.field()


@attr_extensions.with_copy
@attr.define(kw_only=True, repr=False, weakref_slot=False)
class _InviteFields:
    code: str = attr.field()
    guild: typing.Optional[invite_models.InviteGuild] = attr.field()
    guild_id: typing.Optional[snowflakes.Snowflake] = attr.field()
    channel: typing.Optional[channel_models.PartialChannel] = attr.field()
    channel_id: snowflakes.Snowflake = attr.field()
    inviter: typing.Optional[user_models.User] = attr.field()
    target_user: typing.Optional[user_models.User] = attr.field()
    target_application: typing.Optional[application_models.InviteApplication] = attr.field()
    target_type: typing.Union[invite_models.TargetType, int, None] = attr.field()
    approximate_active_member_count: typing.Optional[int] = attr.field()
    approximate_member_count: typing.Optional[int] = attr.field()


@attr_extensions.with_copy
@attr.define(kw_only=True, repr=False, weakref_slot=False)
class _UserFields:
    id: snowflakes.Snowflake = attr.field()
    discriminator: str = attr.field()
    username: str = attr.field()
    avatar_hash: str = attr.field()
    is_bot: bool = attr.field()
    is_system: bool = attr.field()


class EntityFactoryImpl(entity_factory.EntityFactory):
    &#34;&#34;&#34;Standard implementation for a serializer/deserializer.

    This will convert objects to/from JSON compatible representations.
    &#34;&#34;&#34;

    __slots__: typing.Sequence[str] = (
        &#34;_app&#34;,
        &#34;_audit_log_entry_converters&#34;,
        &#34;_audit_log_event_mapping&#34;,
        &#34;_component_type_mapping&#34;,
        &#34;_dm_channel_type_mapping&#34;,
        &#34;_guild_channel_type_mapping&#34;,
        &#34;_interaction_type_mapping&#34;,
        &#34;_webhook_type_mapping&#34;,
    )

    def __init__(self, app: traits.RESTAware) -&gt; None:
        self._app = app
        self._audit_log_entry_converters: typing.Dict[str, typing.Callable[[typing.Any], typing.Any]] = {
            audit_log_models.AuditLogChangeKey.OWNER_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.AFK_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.AFK_TIMEOUT: _deserialize_seconds_timedelta,
            audit_log_models.AuditLogChangeKey.RULES_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.PUBLIC_UPDATES_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.MFA_LEVEL: guild_models.GuildMFALevel,
            audit_log_models.AuditLogChangeKey.VERIFICATION_LEVEL: guild_models.GuildVerificationLevel,
            audit_log_models.AuditLogChangeKey.EXPLICIT_CONTENT_FILTER: guild_models.GuildExplicitContentFilterLevel,
            audit_log_models.AuditLogChangeKey.DEFAULT_MESSAGE_NOTIFICATIONS: guild_models.GuildMessageNotificationsLevel,
            # noqa: E501 - Line too long
            audit_log_models.AuditLogChangeKey.PRUNE_DELETE_DAYS: _deserialize_day_timedelta,
            audit_log_models.AuditLogChangeKey.WIDGET_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.POSITION: int,
            audit_log_models.AuditLogChangeKey.BITRATE: int,
            audit_log_models.AuditLogChangeKey.APPLICATION_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.PERMISSIONS: _with_int_cast(permission_models.Permissions),
            audit_log_models.AuditLogChangeKey.COLOR: color_models.Color,
            audit_log_models.AuditLogChangeKey.ALLOW: _with_int_cast(permission_models.Permissions),
            audit_log_models.AuditLogChangeKey.DENY: _with_int_cast(permission_models.Permissions),
            audit_log_models.AuditLogChangeKey.CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.INVITER_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.MAX_USES: _deserialize_max_uses,
            audit_log_models.AuditLogChangeKey.USES: int,
            audit_log_models.AuditLogChangeKey.MAX_AGE: _deserialize_max_age,
            audit_log_models.AuditLogChangeKey.ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.TYPE: str,
            audit_log_models.AuditLogChangeKey.ENABLE_EMOTICONS: bool,
            audit_log_models.AuditLogChangeKey.EXPIRE_BEHAVIOR: guild_models.IntegrationExpireBehaviour,
            audit_log_models.AuditLogChangeKey.EXPIRE_GRACE_PERIOD: _deserialize_day_timedelta,
            audit_log_models.AuditLogChangeKey.RATE_LIMIT_PER_USER: _deserialize_seconds_timedelta,
            audit_log_models.AuditLogChangeKey.SYSTEM_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.FORMAT_TYPE: sticker_models.StickerFormatType,
            audit_log_models.AuditLogChangeKey.GUILD_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.ADD_ROLE_TO_MEMBER: self._deserialize_audit_log_change_roles,
            audit_log_models.AuditLogChangeKey.REMOVE_ROLE_FROM_MEMBER: self._deserialize_audit_log_change_roles,
            audit_log_models.AuditLogChangeKey.PERMISSION_OVERWRITES: self._deserialize_audit_log_overwrites,
        }
        self._audit_log_event_mapping: typing.Dict[
            typing.Union[int, audit_log_models.AuditLogEventType],
            typing.Callable[[data_binding.JSONObject], audit_log_models.BaseAuditLogEntryInfo],
        ] = {
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_CREATE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_UPDATE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_DELETE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_PIN: self._deserialize_message_pin_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_UNPIN: self._deserialize_message_pin_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_PRUNE: self._deserialize_member_prune_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_BULK_DELETE: self._deserialize_message_bulk_delete_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_DELETE: self._deserialize_message_delete_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_DISCONNECT: self._deserialize_member_disconnect_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_MOVE: self._deserialize_member_move_entry_info,
        }
        self._component_type_mapping = {
            message_models.ComponentType.ACTION_ROW: self.deserialize_action_row,
            message_models.ComponentType.BUTTON: self.deserialize_button,
            message_models.ComponentType.SELECT_MENU: self.deserialize_select_menu,
        }
        self._dm_channel_type_mapping = {
            channel_models.ChannelType.DM: self.deserialize_dm,
            channel_models.ChannelType.GROUP_DM: self.deserialize_group_dm,
        }
        self._guild_channel_type_mapping = {
            channel_models.ChannelType.GUILD_CATEGORY: self.deserialize_guild_category,
            channel_models.ChannelType.GUILD_TEXT: self.deserialize_guild_text_channel,
            channel_models.ChannelType.GUILD_NEWS: self.deserialize_guild_news_channel,
            channel_models.ChannelType.GUILD_STORE: self.deserialize_guild_store_channel,
            channel_models.ChannelType.GUILD_VOICE: self.deserialize_guild_voice_channel,
            channel_models.ChannelType.GUILD_STAGE: self.deserialize_guild_stage_channel,
        }
        self._interaction_type_mapping: typing.Dict[
            int, typing.Callable[[data_binding.JSONObject], base_interactions.PartialInteraction]
        ] = {
            base_interactions.InteractionType.APPLICATION_COMMAND: self.deserialize_command_interaction,
            base_interactions.InteractionType.MESSAGE_COMPONENT: self.deserialize_component_interaction,
        }
        self._webhook_type_mapping = {
            webhook_models.WebhookType.INCOMING: self.deserialize_incoming_webhook,
            webhook_models.WebhookType.CHANNEL_FOLLOWER: self.deserialize_channel_follower_webhook,
            webhook_models.WebhookType.APPLICATION: self.deserialize_application_webhook,
        }

    ######################
    # APPLICATION MODELS #
    ######################

    def deserialize_own_connection(self, payload: data_binding.JSONObject) -&gt; application_models.OwnConnection:
        if (integration_payloads := payload.get(&#34;integrations&#34;)) is not None:
            integrations = [self.deserialize_partial_integration(integration) for integration in integration_payloads]
        else:
            integrations = []

        return application_models.OwnConnection(
            id=payload[&#34;id&#34;],
            name=payload[&#34;name&#34;],
            type=payload[&#34;type&#34;],
            is_revoked=payload[&#34;revoked&#34;],
            integrations=integrations,
            is_verified=payload[&#34;verified&#34;],
            is_friend_sync_enabled=payload[&#34;friend_sync&#34;],
            is_activity_visible=payload[&#34;show_activity&#34;],
            visibility=application_models.ConnectionVisibility(payload[&#34;visibility&#34;]),
        )

    def deserialize_own_guild(self, payload: data_binding.JSONObject) -&gt; application_models.OwnGuild:
        return application_models.OwnGuild(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            icon_hash=payload[&#34;icon&#34;],
            features=[guild_models.GuildFeature(feature) for feature in payload[&#34;features&#34;]],
            is_owner=bool(payload[&#34;owner&#34;]),
            my_permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
        )

    def deserialize_application(self, payload: data_binding.JSONObject) -&gt; application_models.Application:
        team: typing.Optional[application_models.Team] = None
        if (team_payload := payload.get(&#34;team&#34;)) is not None:
            members = {}
            for member_payload in team_payload[&#34;members&#34;]:
                team_member = application_models.TeamMember(
                    membership_state=application_models.TeamMembershipState(member_payload[&#34;membership_state&#34;]),
                    permissions=member_payload[&#34;permissions&#34;],
                    team_id=snowflakes.Snowflake(member_payload[&#34;team_id&#34;]),
                    user=self.deserialize_user(member_payload[&#34;user&#34;]),
                )
                members[team_member.user.id] = team_member

            team = application_models.Team(
                app=self._app,
                id=snowflakes.Snowflake(team_payload[&#34;id&#34;]),
                name=team_payload[&#34;name&#34;],
                icon_hash=team_payload[&#34;icon&#34;],
                members=members,
                owner_id=snowflakes.Snowflake(team_payload[&#34;owner_user_id&#34;]),
            )

        primary_sku_id = snowflakes.Snowflake(payload[&#34;primary_sku_id&#34;]) if &#34;primary_sku_id&#34; in payload else None
        return application_models.Application(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;] or None,
            is_bot_public=payload[&#34;bot_public&#34;],
            is_bot_code_grant_required=payload[&#34;bot_require_code_grant&#34;],
            owner=self.deserialize_user(payload[&#34;owner&#34;]),
            rpc_origins=payload.get(&#34;rpc_origins&#34;),
            summary=payload[&#34;summary&#34;] or None,
            public_key=bytes.fromhex(payload[&#34;verify_key&#34;]),
            icon_hash=payload.get(&#34;icon&#34;),
            team=team,
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None,
            primary_sku_id=primary_sku_id,
            slug=payload.get(&#34;slug&#34;),
            cover_image_hash=payload.get(&#34;cover_image&#34;),
            privacy_policy_url=payload.get(&#34;privacy_policy_url&#34;),
            terms_of_service_url=payload.get(&#34;terms_of_service_url&#34;),
        )

    def deserialize_authorization_information(
        self, payload: data_binding.JSONObject
    ) -&gt; application_models.AuthorizationInformation:
        application_payload = payload[&#34;application&#34;]
        application = application_models.AuthorizationApplication(
            id=snowflakes.Snowflake(application_payload[&#34;id&#34;]),
            name=application_payload[&#34;name&#34;],
            description=application_payload[&#34;description&#34;] or None,
            icon_hash=application_payload.get(&#34;icon&#34;),
            summary=application_payload[&#34;summary&#34;] or None,
            is_bot_public=application_payload.get(&#34;bot_public&#34;),
            is_bot_code_grant_required=application_payload.get(&#34;bot_require_code_grant&#34;),
            public_key=bytes.fromhex(application_payload[&#34;verify_key&#34;]),
            terms_of_service_url=application_payload.get(&#34;terms_of_service_url&#34;),
            privacy_policy_url=application_payload.get(&#34;privacy_policy_url&#34;),
        )

        return application_models.AuthorizationInformation(
            application=application,
            scopes=[application_models.OAuth2Scope(scope) for scope in payload[&#34;scopes&#34;]],
            expires_at=time.iso8601_datetime_string_to_datetime(payload[&#34;expires&#34;]),
            user=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
        )

    def deserialize_partial_token(self, payload: data_binding.JSONObject) -&gt; application_models.PartialOAuth2Token:
        return application_models.PartialOAuth2Token(
            access_token=payload[&#34;access_token&#34;],
            token_type=application_models.TokenType(payload[&#34;token_type&#34;]),
            expires_in=datetime.timedelta(seconds=int(payload[&#34;expires_in&#34;])),
            scopes=[application_models.OAuth2Scope(scope) for scope in payload[&#34;scope&#34;].split(&#34; &#34;)],
        )

    def deserialize_authorization_token(
        self, payload: data_binding.JSONObject
    ) -&gt; application_models.OAuth2AuthorizationToken:
        return application_models.OAuth2AuthorizationToken(
            access_token=payload[&#34;access_token&#34;],
            token_type=application_models.TokenType(payload[&#34;token_type&#34;]),
            expires_in=datetime.timedelta(seconds=int(payload[&#34;expires_in&#34;])),
            scopes=[application_models.OAuth2Scope(scope) for scope in payload[&#34;scope&#34;].split(&#34; &#34;)],
            refresh_token=payload[&#34;refresh_token&#34;],
            webhook=self.deserialize_incoming_webhook(payload[&#34;webhook&#34;]) if &#34;webhook&#34; in payload else None,
            guild=self.deserialize_rest_guild(payload[&#34;guild&#34;]) if &#34;guild&#34; in payload else None,
        )

    def deserialize_implicit_token(self, query: data_binding.Query) -&gt; application_models.OAuth2ImplicitToken:
        return application_models.OAuth2ImplicitToken(
            access_token=query[&#34;access_token&#34;],
            token_type=application_models.TokenType(query[&#34;token_type&#34;]),
            expires_in=datetime.timedelta(seconds=int(query[&#34;expires_in&#34;])),
            scopes=[application_models.OAuth2Scope(scope) for scope in query[&#34;scope&#34;].split(&#34; &#34;)],
            state=query.get(&#34;state&#34;),
        )

    #####################
    # AUDIT LOGS MODELS #
    #####################

    def _deserialize_audit_log_change_roles(
        self, payload: data_binding.JSONArray
    ) -&gt; typing.Mapping[snowflakes.Snowflake, guild_models.PartialRole]:
        roles = {}
        for role_payload in payload:
            role = guild_models.PartialRole(
                app=self._app, id=snowflakes.Snowflake(role_payload[&#34;id&#34;]), name=role_payload[&#34;name&#34;]
            )
            roles[role.id] = role

        return roles

    def _deserialize_audit_log_overwrites(
        self, payload: data_binding.JSONArray
    ) -&gt; typing.Mapping[snowflakes.Snowflake, channel_models.PermissionOverwrite]:
        return {
            snowflakes.Snowflake(overwrite[&#34;id&#34;]): self.deserialize_permission_overwrite(overwrite)
            for overwrite in payload
        }

    def _deserialize_channel_overwrite_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.ChannelOverwriteEntryInfo:
        return audit_log_models.ChannelOverwriteEntryInfo(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=channel_models.PermissionOverwriteType(payload[&#34;type&#34;]),
            role_name=payload.get(&#34;role_name&#34;),
        )

    def _deserialize_message_pin_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MessagePinEntryInfo:
        return audit_log_models.MessagePinEntryInfo(
            app=self._app,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            message_id=snowflakes.Snowflake(payload[&#34;message_id&#34;]),
        )

    def _deserialize_member_prune_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MemberPruneEntryInfo:
        return audit_log_models.MemberPruneEntryInfo(
            app=self._app,
            delete_member_days=datetime.timedelta(days=int(payload[&#34;delete_member_days&#34;])),
            members_removed=int(payload[&#34;members_removed&#34;]),
        )

    def _deserialize_message_bulk_delete_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MessageBulkDeleteEntryInfo:
        return audit_log_models.MessageBulkDeleteEntryInfo(app=self._app, count=int(payload[&#34;count&#34;]))

    def _deserialize_message_delete_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MessageDeleteEntryInfo:
        return audit_log_models.MessageDeleteEntryInfo(
            app=self._app, channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]), count=int(payload[&#34;count&#34;])
        )

    def _deserialize_member_disconnect_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MemberDisconnectEntryInfo:
        return audit_log_models.MemberDisconnectEntryInfo(app=self._app, count=int(payload[&#34;count&#34;]))

    def _deserialize_member_move_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MemberMoveEntryInfo:
        return audit_log_models.MemberMoveEntryInfo(
            app=self._app, channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]), count=int(payload[&#34;count&#34;])
        )

    def deserialize_audit_log(self, payload: data_binding.JSONObject) -&gt; audit_log_models.AuditLog:
        entries = {}
        for entry_payload in payload[&#34;audit_log_entries&#34;]:
            entry_id = snowflakes.Snowflake(entry_payload[&#34;id&#34;])

            changes = []
            if (change_payloads := entry_payload.get(&#34;changes&#34;)) is not None:
                for change_payload in change_payloads:
                    key: typing.Union[audit_log_models.AuditLogChangeKey, str] = audit_log_models.AuditLogChangeKey(
                        change_payload[&#34;key&#34;]
                    )

                    new_value = change_payload.get(&#34;new_value&#34;)
                    old_value = change_payload.get(&#34;old_value&#34;)
                    if value_converter := self._audit_log_entry_converters.get(key):
                        new_value = value_converter(new_value) if new_value is not None else None
                        old_value = value_converter(old_value) if old_value is not None else None

                    elif not isinstance(key, audit_log_models.AuditLogChangeKey):
                        _LOGGER.debug(&#34;Unknown audit log change key found %r&#34;, key)

                    changes.append(audit_log_models.AuditLogChange(key=key, new_value=new_value, old_value=old_value))

            target_id: typing.Optional[snowflakes.Snowflake] = None
            if (raw_target_id := entry_payload[&#34;target_id&#34;]) is not None:
                target_id = snowflakes.Snowflake(raw_target_id)

            user_id: typing.Optional[snowflakes.Snowflake] = None
            if (raw_user_id := entry_payload[&#34;user_id&#34;]) is not None:
                user_id = snowflakes.Snowflake(raw_user_id)

            action_type: typing.Union[audit_log_models.AuditLogEventType, int]
            action_type = audit_log_models.AuditLogEventType(entry_payload[&#34;action_type&#34;])

            options: typing.Optional[audit_log_models.BaseAuditLogEntryInfo] = None
            if (raw_option := entry_payload.get(&#34;options&#34;)) is not None:
                if option_converter := self._audit_log_event_mapping.get(action_type):
                    options = option_converter(raw_option)

                else:
                    _LOGGER.debug(&#34;Unknown audit log action type found %r&#34;, action_type)
                    continue

            entries[entry_id] = audit_log_models.AuditLogEntry(
                app=self._app,
                id=entry_id,
                target_id=target_id,
                changes=changes,
                user_id=user_id,
                action_type=action_type,
                options=options,
                reason=entry_payload.get(&#34;reason&#34;),
            )

        integrations = {
            snowflakes.Snowflake(integration[&#34;id&#34;]): self.deserialize_partial_integration(integration)
            for integration in payload[&#34;integrations&#34;]
        }
        users = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;users&#34;]}

        webhooks: typing.Dict[snowflakes.Snowflake, webhook_models.PartialWebhook] = {}
        for webhook_payload in payload[&#34;webhooks&#34;]:
            try:
                webhook = self.deserialize_webhook(webhook_payload)

            except errors.UnrecognisedEntityError:
                continue

            webhooks[webhook.id] = webhook

        return audit_log_models.AuditLog(entries=entries, integrations=integrations, users=users, webhooks=webhooks)

    ##################
    # CHANNEL MODELS #
    ##################

    def deserialize_channel_follow(self, payload: data_binding.JSONObject) -&gt; channel_models.ChannelFollow:
        return channel_models.ChannelFollow(
            app=self._app,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]),
        )

    def deserialize_permission_overwrite(self, payload: data_binding.JSONObject) -&gt; channel_models.PermissionOverwrite:
        return channel_models.PermissionOverwrite(
            # PermissionOverwrite&#39;s init has converters set for these fields which will handle casting
            id=payload[&#34;id&#34;],
            type=payload[&#34;type&#34;],
            # Permissions still have to be cast to int before they can be cast to Permission typing wise.
            allow=int(payload[&#34;allow&#34;]),
            deny=int(payload[&#34;deny&#34;]),
        )

    def serialize_permission_overwrite(self, overwrite: channel_models.PermissionOverwrite) -&gt; data_binding.JSONObject:
        # https://github.com/discord/discord-api-docs/pull/1843/commits/470677363ba88fbc1fe79228821146c6d6b488b9
        # allow and deny can be strings instead now.
        return {
            &#34;id&#34;: str(overwrite.id),
            &#34;type&#34;: overwrite.type,
            &#34;allow&#34;: str(int(overwrite.allow)),
            &#34;deny&#34;: str(int(overwrite.deny)),
        }

    def deserialize_partial_channel(self, payload: data_binding.JSONObject) -&gt; channel_models.PartialChannel:
        return channel_models.PartialChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
        )

    def deserialize_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.DMChannel:
        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        return channel_models.DMChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            last_message_id=last_message_id,
            recipient=self.deserialize_user(payload[&#34;recipients&#34;][0]),
        )

    def deserialize_group_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.GroupDMChannel:
        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        if (raw_nicks := payload.get(&#34;nicks&#34;)) is not None:
            nicknames = {snowflakes.Snowflake(entry[&#34;id&#34;]): entry[&#34;nick&#34;] for entry in raw_nicks}
        else:
            nicknames = {}

        recipients = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;recipients&#34;]}

        return channel_models.GroupDMChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            last_message_id=last_message_id,
            owner_id=snowflakes.Snowflake(payload[&#34;owner_id&#34;]),
            icon_hash=payload[&#34;icon&#34;],
            nicknames=nicknames,
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]) if &#34;application_id&#34; in payload else None,
            recipients=recipients,
        )

    def _set_guild_channel_attributes(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake],
    ) -&gt; _GuildChannelFields:
        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        permission_overwrites = {
            snowflakes.Snowflake(overwrite[&#34;id&#34;]): self.deserialize_permission_overwrite(overwrite)
            for overwrite in payload[&#34;permission_overwrites&#34;]
        }

        parent_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_parent_id := payload.get(&#34;parent_id&#34;)) is not None:
            parent_id = snowflakes.Snowflake(raw_parent_id)

        return _GuildChannelFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            guild_id=guild_id,
            position=int(payload[&#34;position&#34;]),
            permission_overwrites=permission_overwrites,
            is_nsfw=payload.get(&#34;nsfw&#34;),
            parent_id=parent_id,
        )

    def deserialize_guild_category(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildCategory:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildCategory(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
        )

    def deserialize_guild_text_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildTextChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        last_pin_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
            last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

        return channel_models.GuildTextChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            topic=payload[&#34;topic&#34;],
            last_message_id=last_message_id,
            # Usually this is 0 if unset, but some old channels made before the
            # rate_limit_per_user field was implemented will not have this field
            # at all if they have never had the rate limit changed...
            rate_limit_per_user=datetime.timedelta(seconds=payload.get(&#34;rate_limit_per_user&#34;, 0)),
            last_pin_timestamp=last_pin_timestamp,
        )

    def deserialize_guild_news_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildNewsChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        last_pin_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
            last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

        return channel_models.GuildNewsChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            topic=payload[&#34;topic&#34;],
            last_message_id=last_message_id,
            last_pin_timestamp=last_pin_timestamp,
        )

    def deserialize_guild_store_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildStoreChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildStoreChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
        )

    def deserialize_guild_voice_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildVoiceChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        # Discord seems to be only returning this after it&#39;s been initially PATCHed in for older channels.
        video_quality_mode = payload.get(&#34;video_quality_mode&#34;, channel_models.VideoQualityMode.AUTO)
        return channel_models.GuildVoiceChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            # There seems to be an edge case where rtc_region won&#39;t be included in gateway events (e.g. GUILD_CREATE)
            # for a voice channel that just hasn&#39;t been touched since this was introduced (e.g. has been archived).
            region=payload.get(&#34;rtc_region&#34;),
            bitrate=int(payload[&#34;bitrate&#34;]),
            user_limit=int(payload[&#34;user_limit&#34;]),
            video_quality_mode=channel_models.VideoQualityMode(int(video_quality_mode)),
        )

    def deserialize_guild_stage_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildStageChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildStageChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            region=payload[&#34;rtc_region&#34;],
            bitrate=int(payload[&#34;bitrate&#34;]),
            user_limit=int(payload[&#34;user_limit&#34;]),
        )

    def deserialize_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.PartialChannel:
        channel_type = channel_models.ChannelType(payload[&#34;type&#34;])
        if guild_channel_model := self._guild_channel_type_mapping.get(channel_type):
            return guild_channel_model(payload, guild_id=guild_id)

        if dm_channel_model := self._dm_channel_type_mapping.get(channel_type):
            return dm_channel_model(payload)

        _LOGGER.debug(f&#34;Unrecognised channel type {channel_type}&#34;)
        raise errors.UnrecognisedEntityError(f&#34;Unrecognised channel type {channel_type}&#34;)

    ################
    # EMBED MODELS #
    ################

    def deserialize_embed(self, payload: data_binding.JSONObject) -&gt; embed_models.Embed:
        # Keep these separate to aid debugging later.
        title = payload.get(&#34;title&#34;)
        description = payload.get(&#34;description&#34;)
        url = payload.get(&#34;url&#34;)
        color = color_models.Color(payload[&#34;color&#34;]) if &#34;color&#34; in payload else None
        timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]) if &#34;timestamp&#34; in payload else None
        fields: typing.Optional[typing.List[embed_models.EmbedField]] = None

        image: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
        if (image_payload := payload.get(&#34;image&#34;)) and &#34;url&#34; in image_payload:
            proxy = files.ensure_resource(image_payload[&#34;proxy_url&#34;]) if &#34;proxy_url&#34; in image_payload else None
            image = embed_models.EmbedImage(
                resource=files.ensure_resource(image_payload[&#34;url&#34;]),
                proxy_resource=proxy,
                height=image_payload.get(&#34;height&#34;),
                width=image_payload.get(&#34;width&#34;),
            )

        thumbnail: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
        if (thumbnail_payload := payload.get(&#34;thumbnail&#34;)) and &#34;url&#34; in thumbnail_payload:
            proxy = files.ensure_resource(thumbnail_payload[&#34;proxy_url&#34;]) if &#34;proxy_url&#34; in thumbnail_payload else None
            thumbnail = embed_models.EmbedImage(
                resource=files.ensure_resource(thumbnail_payload[&#34;url&#34;]),
                proxy_resource=proxy,
                height=thumbnail_payload.get(&#34;height&#34;),
                width=thumbnail_payload.get(&#34;width&#34;),
            )

        video: typing.Optional[embed_models.EmbedVideo[files.AsyncReader]] = None
        if (video_payload := payload.get(&#34;video&#34;)) and &#34;url&#34; in video_payload:
            raw_proxy_url = video_payload.get(&#34;proxy_url&#34;)
            video = embed_models.EmbedVideo(
                resource=files.ensure_resource(video_payload[&#34;url&#34;]),
                proxy_resource=files.ensure_resource(raw_proxy_url) if raw_proxy_url else None,
                height=video_payload.get(&#34;height&#34;),
                width=video_payload.get(&#34;width&#34;),
            )

        provider: typing.Optional[embed_models.EmbedProvider] = None
        if provider_payload := payload.get(&#34;provider&#34;):
            provider = embed_models.EmbedProvider(name=provider_payload.get(&#34;name&#34;), url=provider_payload.get(&#34;url&#34;))

        icon: typing.Optional[embed_models.EmbedResourceWithProxy[files.AsyncReader]]
        author: typing.Optional[embed_models.EmbedAuthor] = None
        if author_payload := payload.get(&#34;author&#34;):
            icon = None
            if &#34;icon_url&#34; in author_payload:
                raw_proxy_url = author_payload.get(&#34;proxy_icon_url&#34;)
                icon = embed_models.EmbedResourceWithProxy(
                    resource=files.ensure_resource(author_payload[&#34;icon_url&#34;]),
                    proxy_resource=files.ensure_resource(raw_proxy_url) if raw_proxy_url else None,
                )

            author = embed_models.EmbedAuthor(
                name=author_payload.get(&#34;name&#34;),
                url=author_payload.get(&#34;url&#34;),
                icon=icon,
            )

        footer: typing.Optional[embed_models.EmbedFooter] = None
        if footer_payload := payload.get(&#34;footer&#34;):
            icon = None
            if &#34;icon_url&#34; in footer_payload:
                raw_proxy_url = footer_payload.get(&#34;proxy_icon_url&#34;)
                icon = embed_models.EmbedResourceWithProxy(
                    resource=files.ensure_resource(footer_payload[&#34;icon_url&#34;]),
                    proxy_resource=files.ensure_resource(raw_proxy_url) if raw_proxy_url else None,
                )

            footer = embed_models.EmbedFooter(text=footer_payload.get(&#34;text&#34;), icon=icon)

        if fields_array := payload.get(&#34;fields&#34;):
            fields = []
            for field_payload in fields_array:
                field = embed_models.EmbedField(
                    name=field_payload[&#34;name&#34;],
                    value=field_payload[&#34;value&#34;],
                    inline=field_payload.get(&#34;inline&#34;, False),
                )
                fields.append(field)

        return embed_models.Embed.from_received_embed(
            title=title,
            description=description,
            url=url,
            color=color,
            timestamp=timestamp,
            image=image,
            thumbnail=thumbnail,
            video=video,
            provider=provider,
            author=author,
            footer=footer,
            fields=fields,
        )

    def serialize_embed(  # noqa: C901 - Function too complex
        self,
        embed: embed_models.Embed,
    ) -&gt; typing.Tuple[data_binding.JSONObject, typing.List[files.Resource[files.AsyncReader]]]:

        payload: data_binding.JSONObject = {}
        uploads: typing.List[files.Resource[files.AsyncReader]] = []

        if embed.title is not None:
            payload[&#34;title&#34;] = embed.title

        if embed.description is not None:
            payload[&#34;description&#34;] = embed.description

        if embed.url is not None:
            payload[&#34;url&#34;] = embed.url

        if embed.timestamp is not None:
            payload[&#34;timestamp&#34;] = embed.timestamp.isoformat()

        if embed.color is not None:
            payload[&#34;color&#34;] = int(embed.color)

        if embed.footer is not None:
            footer_payload: data_binding.JSONObject = {}

            if embed.footer.text is not None:
                footer_payload[&#34;text&#34;] = embed.footer.text

            if embed.footer.icon is not None:
                if not isinstance(embed.footer.icon.resource, files.WebResource):
                    uploads.append(embed.footer.icon.resource)

                footer_payload[&#34;icon_url&#34;] = embed.footer.icon.url

            payload[&#34;footer&#34;] = footer_payload

        if embed.image is not None:
            image_payload: data_binding.JSONObject = {}

            if not isinstance(embed.image.resource, files.WebResource):
                uploads.append(embed.image.resource)

            image_payload[&#34;url&#34;] = embed.image.url
            payload[&#34;image&#34;] = image_payload

        if embed.thumbnail is not None:
            thumbnail_payload: data_binding.JSONObject = {}

            if not isinstance(embed.thumbnail.resource, files.WebResource):
                uploads.append(embed.thumbnail.resource)

            thumbnail_payload[&#34;url&#34;] = embed.thumbnail.url
            payload[&#34;thumbnail&#34;] = thumbnail_payload

        if embed.author is not None:
            author_payload: data_binding.JSONObject = {}

            if embed.author.name is not None:
                author_payload[&#34;name&#34;] = embed.author.name

            if embed.author.url is not None:
                author_payload[&#34;url&#34;] = embed.author.url

            if embed.author.icon is not None:
                if not isinstance(embed.author.icon.resource, files.WebResource):
                    uploads.append(embed.author.icon.resource)
                author_payload[&#34;icon_url&#34;] = embed.author.icon.url

            payload[&#34;author&#34;] = author_payload

        if embed.fields:
            field_payloads: data_binding.JSONArray = []
            for i, field in enumerate(embed.fields):

                # Yep, these are technically two unreachable branches. However, this is an incredibly
                # common mistake to make when working with embeds and not using a static type
                # checker, so I have added these as additional safeguards for UX and ease
                # of debugging. The case that there are `None` should be detected immediately by
                # static type checkers, regardless.
                name = str(field.name) if field.name is not None else None
                value = str(field.value) if field.value is not None else None

                if name is None:
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have `None`&#34;)
                if not name:
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have empty string&#34;)
                if not name.strip():
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have only whitespace&#34;)

                if value is None:
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have `None`&#34;)
                if not value:
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have empty string&#34;)
                if not value.strip():
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have only whitespace&#34;)

                # Name and value always have to be specified; we can always
                # send a default `inline` value also just to keep this simpler.
                field_payloads.append({&#34;name&#34;: name, &#34;value&#34;: value, &#34;inline&#34;: field.is_inline})
            payload[&#34;fields&#34;] = field_payloads

        return payload, uploads

    ################
    # EMOJI MODELS #
    ################

    def deserialize_unicode_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.UnicodeEmoji:
        return emoji_models.UnicodeEmoji(payload[&#34;name&#34;])

    def deserialize_custom_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.CustomEmoji:
        return emoji_models.CustomEmoji(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            is_animated=payload.get(&#34;animated&#34;, False),
        )

    def deserialize_known_custom_emoji(
        self, payload: data_binding.JSONObject, *, guild_id: snowflakes.Snowflake
    ) -&gt; emoji_models.KnownCustomEmoji:
        role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]] if &#34;roles&#34; in payload else []

        user: typing.Optional[user_models.User] = None
        if (raw_user := payload.get(&#34;user&#34;)) is not None:
            user = self.deserialize_user(raw_user)

        return emoji_models.KnownCustomEmoji(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            is_animated=payload.get(&#34;animated&#34;, False),
            guild_id=guild_id,
            role_ids=role_ids,
            user=user,
            is_colons_required=payload[&#34;require_colons&#34;],
            is_managed=payload[&#34;managed&#34;],
            is_available=payload[&#34;available&#34;],
        )

    def deserialize_emoji(
        self, payload: data_binding.JSONObject
    ) -&gt; typing.Union[emoji_models.UnicodeEmoji, emoji_models.CustomEmoji]:
        if payload.get(&#34;id&#34;) is not None:
            return self.deserialize_custom_emoji(payload)

        return self.deserialize_unicode_emoji(payload)

    ##################
    # GATEWAY MODELS #
    ##################

    def deserialize_gateway_bot_info(self, payload: data_binding.JSONObject) -&gt; gateway_models.GatewayBotInfo:
        session_start_limit_payload = payload[&#34;session_start_limit&#34;]
        session_start_limit = gateway_models.SessionStartLimit(
            total=int(session_start_limit_payload[&#34;total&#34;]),
            remaining=int(session_start_limit_payload[&#34;remaining&#34;]),
            reset_after=datetime.timedelta(milliseconds=session_start_limit_payload[&#34;reset_after&#34;]),
            # I do not trust that this may never be zero for some unknown reason. If it was 0, it
            # would hang the application on start up, so I enforce it is at least 1.
            max_concurrency=max(session_start_limit_payload.get(&#34;max_concurrency&#34;, 0), 1),
        )
        return gateway_models.GatewayBotInfo(
            url=payload[&#34;url&#34;],
            shard_count=int(payload[&#34;shards&#34;]),
            session_start_limit=session_start_limit,
        )

    ################
    # GUILD MODELS #
    ################

    def deserialize_guild_widget(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildWidget:
        channel_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
            channel_id = snowflakes.Snowflake(raw_channel_id)

        return guild_models.GuildWidget(app=self._app, channel_id=channel_id, is_enabled=payload[&#34;enabled&#34;])

    def deserialize_welcome_screen(self, payload: data_binding.JSONObject) -&gt; guild_models.WelcomeScreen:
        channels: typing.List[guild_models.WelcomeChannel] = []

        for channel_payload in payload[&#34;welcome_channels&#34;]:
            raw_emoji_id = channel_payload[&#34;emoji_id&#34;]
            emoji_id = snowflakes.Snowflake(raw_emoji_id) if raw_emoji_id else None

            emoji_name: typing.Union[None, emoji_models.UnicodeEmoji, str]
            if (emoji_name := channel_payload[&#34;emoji_name&#34;]) and not emoji_id:
                emoji_name = emoji_models.UnicodeEmoji(emoji_name)

            channels.append(
                guild_models.WelcomeChannel(
                    channel_id=snowflakes.Snowflake(channel_payload[&#34;channel_id&#34;]),
                    description=channel_payload[&#34;description&#34;],
                    emoji_id=emoji_id,
                    emoji_name=emoji_name,
                )
            )

        return guild_models.WelcomeScreen(description=payload[&#34;description&#34;], channels=channels)

    def serialize_welcome_channel(self, welcome_channel: guild_models.WelcomeChannel) -&gt; data_binding.JSONObject:
        payload: data_binding.JSONObject = {
            &#34;channel_id&#34;: str(welcome_channel.channel_id),
            &#34;description&#34;: welcome_channel.description,
        }

        if welcome_channel.emoji_id is not None:
            payload[&#34;emoji_id&#34;] = str(welcome_channel.emoji_id)

        elif welcome_channel.emoji_name is not None:
            payload[&#34;emoji_name&#34;] = str(welcome_channel.emoji_name)

        return payload

    def deserialize_member(
        self,
        payload: data_binding.JSONObject,
        *,
        user: undefined.UndefinedOr[user_models.User] = undefined.UNDEFINED,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; guild_models.Member:
        if user is undefined.UNDEFINED:
            user = self.deserialize_user(payload[&#34;user&#34;])

        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]]
        # If Discord ever does start including this here without warning we don&#39;t want to duplicate the entry.
        if guild_id not in role_ids:
            role_ids.append(guild_id)

        joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;])

        raw_premium_since = payload.get(&#34;premium_since&#34;)
        premium_since = (
            time.iso8601_datetime_string_to_datetime(raw_premium_since) if raw_premium_since is not None else None
        )

        return guild_models.Member(
            user=user,
            guild_id=guild_id,
            role_ids=role_ids,
            joined_at=joined_at,
            nickname=payload.get(&#34;nick&#34;),
            premium_since=premium_since,
            is_deaf=payload.get(&#34;deaf&#34;, undefined.UNDEFINED),
            is_mute=payload.get(&#34;mute&#34;, undefined.UNDEFINED),
            is_pending=payload.get(&#34;pending&#34;, undefined.UNDEFINED),
        )

    def deserialize_role(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: snowflakes.Snowflake,
    ) -&gt; guild_models.Role:
        bot_id: typing.Optional[snowflakes.Snowflake] = None
        integration_id: typing.Optional[snowflakes.Snowflake] = None
        is_premium_subscriber_role: bool = False
        if &#34;tags&#34; in payload:
            tags_payload = payload[&#34;tags&#34;]
            if &#34;bot_id&#34; in tags_payload:
                bot_id = snowflakes.Snowflake(tags_payload[&#34;bot_id&#34;])
            if &#34;integration_id&#34; in tags_payload:
                integration_id = snowflakes.Snowflake(tags_payload[&#34;integration_id&#34;])
            if &#34;premium_subscriber&#34; in tags_payload:
                is_premium_subscriber_role = True

        return guild_models.Role(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            guild_id=guild_id,
            name=payload[&#34;name&#34;],
            color=color_models.Color(payload[&#34;color&#34;]),
            is_hoisted=payload[&#34;hoist&#34;],
            position=int(payload[&#34;position&#34;]),
            permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
            is_managed=payload[&#34;managed&#34;],
            is_mentionable=payload[&#34;mentionable&#34;],
            bot_id=bot_id,
            integration_id=integration_id,
            is_premium_subscriber_role=is_premium_subscriber_role,
        )

    @staticmethod
    def _set_partial_integration_attributes(payload: data_binding.JSONObject) -&gt; _IntegrationFields:
        account_payload = payload[&#34;account&#34;]
        account = guild_models.IntegrationAccount(id=account_payload[&#34;id&#34;], name=account_payload[&#34;name&#34;])
        return _IntegrationFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            type=guild_models.IntegrationType(payload[&#34;type&#34;]),
            account=account,
        )

    def deserialize_partial_integration(self, payload: data_binding.JSONObject) -&gt; guild_models.PartialIntegration:
        integration_fields = self._set_partial_integration_attributes(payload)
        return guild_models.PartialIntegration(
            id=integration_fields.id,
            name=integration_fields.name,
            type=integration_fields.type,
            account=integration_fields.account,
        )

    def deserialize_integration(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; guild_models.Integration:
        integration_fields = self._set_partial_integration_attributes(payload)

        role_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_role_id := payload.get(&#34;role_id&#34;)) is not None:
            role_id = snowflakes.Snowflake(raw_role_id)

        last_synced_at: typing.Optional[datetime.datetime] = None
        if (raw_last_synced_at := payload.get(&#34;synced_at&#34;)) is not None:
            last_synced_at = time.iso8601_datetime_string_to_datetime(raw_last_synced_at)

        expire_grace_period: typing.Optional[datetime.timedelta] = None
        if (raw_expire_grace_period := payload.get(&#34;expire_grace_period&#34;)) is not None:
            expire_grace_period = datetime.timedelta(days=raw_expire_grace_period)

        expire_behavior: typing.Union[guild_models.IntegrationExpireBehaviour, int, None] = None
        if (raw_expire_behavior := payload.get(&#34;expire_behavior&#34;)) is not None:
            expire_behavior = guild_models.IntegrationExpireBehaviour(raw_expire_behavior)

        user: typing.Optional[user_models.User] = None
        if (raw_user := payload.get(&#34;user&#34;)) is not None:
            user = self.deserialize_user(raw_user)

        application: typing.Optional[guild_models.IntegrationApplication] = None
        if (raw_application := payload.get(&#34;application&#34;)) is not None:
            bot: typing.Optional[user_models.User] = None
            if (raw_application_bot := raw_application.get(&#34;bot&#34;)) is not None:
                bot = self.deserialize_user(raw_application_bot)

            application = guild_models.IntegrationApplication(
                id=snowflakes.Snowflake(raw_application[&#34;id&#34;]),
                name=raw_application[&#34;name&#34;],
                icon_hash=raw_application[&#34;icon&#34;],
                summary=raw_application[&#34;summary&#34;] or None,
                description=raw_application[&#34;description&#34;] or None,
                bot=bot,
            )

        return guild_models.Integration(
            id=integration_fields.id,
            guild_id=guild_id if guild_id is not undefined.UNDEFINED else snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            name=integration_fields.name,
            type=integration_fields.type,
            account=integration_fields.account,
            is_enabled=payload[&#34;enabled&#34;],
            is_syncing=payload.get(&#34;syncing&#34;),
            is_revoked=payload.get(&#34;revoked&#34;),
            role_id=role_id,
            is_emojis_enabled=payload.get(&#34;enable_emoticons&#34;),
            expire_behavior=expire_behavior,
            expire_grace_period=expire_grace_period,
            user=user,
            last_synced_at=last_synced_at,
            subscriber_count=payload.get(&#34;subscriber_count&#34;),
            application=application,
        )

    def deserialize_guild_member_ban(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildBan:
        return guild_models.GuildBan(reason=payload[&#34;reason&#34;], user=self.deserialize_user(payload[&#34;user&#34;]))

    def deserialize_guild_preview(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildPreview:
        guild_id = snowflakes.Snowflake(payload[&#34;id&#34;])
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_id)
            for emoji in payload[&#34;emojis&#34;]
        }
        return guild_models.GuildPreview(
            app=self._app,
            id=guild_id,
            name=payload[&#34;name&#34;],
            icon_hash=payload[&#34;icon&#34;],
            features=[guild_models.GuildFeature(feature) for feature in payload[&#34;features&#34;]],
            splash_hash=payload[&#34;splash&#34;],
            discovery_splash_hash=payload[&#34;discovery_splash&#34;],
            emojis=emojis,
            approximate_active_member_count=int(payload[&#34;approximate_presence_count&#34;]),
            approximate_member_count=int(payload[&#34;approximate_member_count&#34;]),
            description=payload[&#34;description&#34;],
        )

    def _set_guild_attributes(self, payload: data_binding.JSONObject) -&gt; _GuildFields:
        afk_channel_id = payload[&#34;afk_channel_id&#34;]
        default_message_notifications = guild_models.GuildMessageNotificationsLevel(
            payload[&#34;default_message_notifications&#34;]
        )
        application_id = payload[&#34;application_id&#34;]
        widget_channel_id = payload.get(&#34;widget_channel_id&#34;)
        system_channel_id = payload[&#34;system_channel_id&#34;]
        rules_channel_id = payload[&#34;rules_channel_id&#34;]
        max_video_channel_users = (
            int(payload[&#34;max_video_channel_users&#34;]) if &#34;max_video_channel_users&#34; in payload else None
        )
        public_updates_channel_id = payload[&#34;public_updates_channel_id&#34;]
        public_updates_channel_id = (
            snowflakes.Snowflake(public_updates_channel_id) if public_updates_channel_id is not None else None
        )
        return _GuildFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            icon_hash=payload[&#34;icon&#34;],
            features=[guild_models.GuildFeature(feature) for feature in payload[&#34;features&#34;]],
            splash_hash=payload[&#34;splash&#34;],
            # This is documented as always being present, but we have found old guilds where this is
            # not present. Quicker to just assume the documentation is wrong at this point than try
            # to contest whether this is right or not with Discord.
            discovery_splash_hash=payload.get(&#34;discovery_splash&#34;),
            owner_id=snowflakes.Snowflake(payload[&#34;owner_id&#34;]),
            afk_channel_id=snowflakes.Snowflake(afk_channel_id) if afk_channel_id is not None else None,
            afk_timeout=datetime.timedelta(seconds=payload[&#34;afk_timeout&#34;]),
            verification_level=guild_models.GuildVerificationLevel(payload[&#34;verification_level&#34;]),
            default_message_notifications=default_message_notifications,
            explicit_content_filter=guild_models.GuildExplicitContentFilterLevel(payload[&#34;explicit_content_filter&#34;]),
            mfa_level=guild_models.GuildMFALevel(payload[&#34;mfa_level&#34;]),
            application_id=snowflakes.Snowflake(application_id) if application_id is not None else None,
            widget_channel_id=snowflakes.Snowflake(widget_channel_id) if widget_channel_id is not None else None,
            system_channel_id=snowflakes.Snowflake(system_channel_id) if system_channel_id is not None else None,
            is_widget_enabled=payload.get(&#34;widget_enabled&#34;),
            system_channel_flags=guild_models.GuildSystemChannelFlag(payload[&#34;system_channel_flags&#34;]),
            rules_channel_id=snowflakes.Snowflake(rules_channel_id) if rules_channel_id is not None else None,
            max_video_channel_users=max_video_channel_users,
            vanity_url_code=payload[&#34;vanity_url_code&#34;],
            description=payload[&#34;description&#34;],
            banner_hash=payload[&#34;banner&#34;],
            premium_tier=guild_models.GuildPremiumTier(payload[&#34;premium_tier&#34;]),
            premium_subscription_count=payload.get(&#34;premium_subscription_count&#34;),
            preferred_locale=payload[&#34;preferred_locale&#34;],
            public_updates_channel_id=public_updates_channel_id,
            nsfw_level=guild_models.GuildNSFWLevel(payload[&#34;nsfw_level&#34;]),
        )

    def deserialize_rest_guild(self, payload: data_binding.JSONObject) -&gt; guild_models.RESTGuild:
        guild_fields = self._set_guild_attributes(payload)

        approximate_member_count: typing.Optional[int] = None
        if &#34;approximate_member_count&#34; in payload:
            approximate_member_count = int(payload[&#34;approximate_member_count&#34;])

        approximate_active_member_count: typing.Optional[int] = None
        if &#34;approximate_presence_count&#34; in payload:
            approximate_active_member_count = int(payload[&#34;approximate_presence_count&#34;])

        max_members = int(payload[&#34;max_members&#34;])

        raw_max_presences = payload[&#34;max_presences&#34;]
        max_presences = int(raw_max_presences) if raw_max_presences is not None else None

        roles = {
            snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild_fields.id)
            for role in payload[&#34;roles&#34;]
        }
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_fields.id)
            for emoji in payload[&#34;emojis&#34;]
        }
        return guild_models.RESTGuild(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=guild_fields.splash_hash,
            discovery_splash_hash=guild_fields.discovery_splash_hash,
            owner_id=guild_fields.owner_id,
            afk_channel_id=guild_fields.afk_channel_id,
            afk_timeout=guild_fields.afk_timeout,
            verification_level=guild_fields.verification_level,
            default_message_notifications=guild_fields.default_message_notifications,
            explicit_content_filter=guild_fields.explicit_content_filter,
            mfa_level=guild_fields.mfa_level,
            application_id=guild_fields.application_id,
            widget_channel_id=guild_fields.widget_channel_id,
            system_channel_id=guild_fields.system_channel_id,
            is_widget_enabled=guild_fields.is_widget_enabled,
            system_channel_flags=guild_fields.system_channel_flags,
            rules_channel_id=guild_fields.rules_channel_id,
            max_presences=max_presences,
            max_members=max_members,
            max_video_channel_users=guild_fields.max_video_channel_users,
            vanity_url_code=guild_fields.vanity_url_code,
            description=guild_fields.description,
            banner_hash=guild_fields.banner_hash,
            premium_tier=guild_fields.premium_tier,
            nsfw_level=guild_fields.nsfw_level,
            premium_subscription_count=guild_fields.premium_subscription_count,
            preferred_locale=guild_fields.preferred_locale,
            public_updates_channel_id=guild_fields.public_updates_channel_id,
            approximate_member_count=approximate_member_count,
            approximate_active_member_count=approximate_active_member_count,
            roles=roles,
            emojis=emojis,
        )

    def deserialize_gateway_guild(self, payload: data_binding.JSONObject) -&gt; entity_factory.GatewayGuildDefinition:
        guild_fields = self._set_guild_attributes(payload)
        is_large = payload.get(&#34;large&#34;)
        joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;]) if &#34;joined_at&#34; in payload else None
        member_count = int(payload[&#34;member_count&#34;]) if &#34;member_count&#34; in payload else None

        guild = guild_models.GatewayGuild(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=guild_fields.splash_hash,
            discovery_splash_hash=guild_fields.discovery_splash_hash,
            owner_id=guild_fields.owner_id,
            afk_channel_id=guild_fields.afk_channel_id,
            afk_timeout=guild_fields.afk_timeout,
            verification_level=guild_fields.verification_level,
            default_message_notifications=guild_fields.default_message_notifications,
            explicit_content_filter=guild_fields.explicit_content_filter,
            mfa_level=guild_fields.mfa_level,
            application_id=guild_fields.application_id,
            widget_channel_id=guild_fields.widget_channel_id,
            system_channel_id=guild_fields.system_channel_id,
            is_widget_enabled=guild_fields.is_widget_enabled,
            system_channel_flags=guild_fields.system_channel_flags,
            rules_channel_id=guild_fields.rules_channel_id,
            max_video_channel_users=guild_fields.max_video_channel_users,
            vanity_url_code=guild_fields.vanity_url_code,
            description=guild_fields.description,
            banner_hash=guild_fields.banner_hash,
            premium_tier=guild_fields.premium_tier,
            premium_subscription_count=guild_fields.premium_subscription_count,
            preferred_locale=guild_fields.preferred_locale,
            public_updates_channel_id=guild_fields.public_updates_channel_id,
            nsfw_level=guild_fields.nsfw_level,
            is_large=is_large,
            joined_at=joined_at,
            member_count=member_count,
        )

        members: typing.Optional[typing.Dict[snowflakes.Snowflake, guild_models.Member]] = None
        if &#34;members&#34; in payload:
            members = {}

            for member_payload in payload[&#34;members&#34;]:
                member = self.deserialize_member(member_payload, guild_id=guild.id)
                members[member.user.id] = member

        channels: typing.Optional[typing.Dict[snowflakes.Snowflake, channel_models.GuildChannel]] = None
        if &#34;channels&#34; in payload:
            channels = {}

            for channel_payload in payload[&#34;channels&#34;]:
                try:
                    channel = self.deserialize_channel(channel_payload, guild_id=guild.id)
                except errors.UnrecognisedEntityError:
                    # Ignore the channel, this has already been logged
                    continue

                assert isinstance(channel, channel_models.GuildChannel)
                channels[channel.id] = channel

        presences: typing.Optional[typing.Dict[snowflakes.Snowflake, presence_models.MemberPresence]] = None
        if &#34;presences&#34; in payload:
            presences = {}

            for presence_payload in payload[&#34;presences&#34;]:
                presence = self.deserialize_member_presence(presence_payload, guild_id=guild.id)
                presences[presence.user_id] = presence

        voice_states: typing.Optional[typing.Dict[snowflakes.Snowflake, voice_models.VoiceState]] = None
        if &#34;voice_states&#34; in payload:
            voice_states = {}
            assert members is not None

            for voice_state_payload in payload[&#34;voice_states&#34;]:
                member = members[snowflakes.Snowflake(voice_state_payload[&#34;user_id&#34;])]
                voice_state = self.deserialize_voice_state(voice_state_payload, guild_id=guild.id, member=member)
                voice_states[voice_state.user_id] = voice_state

        roles = {
            snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild.id)
            for role in payload[&#34;roles&#34;]
        }
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild.id)
            for emoji in payload[&#34;emojis&#34;]
        }

        return entity_factory.GatewayGuildDefinition(guild, channels, members, presences, roles, emojis, voice_states)

    #################
    # INVITE MODELS #
    #################

    def deserialize_vanity_url(self, payload: data_binding.JSONObject) -&gt; invite_models.VanityURL:
        return invite_models.VanityURL(app=self._app, code=payload[&#34;code&#34;], uses=int(payload[&#34;uses&#34;]))

    def _set_invite_attributes(self, payload: data_binding.JSONObject) -&gt; _InviteFields:
        guild: typing.Optional[invite_models.InviteGuild] = None
        guild_id: typing.Optional[snowflakes.Snowflake] = None
        if &#34;guild&#34; in payload:
            guild_payload = payload[&#34;guild&#34;]
            raw_welcome_screen = guild_payload.get(&#34;welcome_screen&#34;)

            guild = invite_models.InviteGuild(
                app=self._app,
                id=snowflakes.Snowflake(guild_payload[&#34;id&#34;]),
                name=guild_payload[&#34;name&#34;],
                features=[guild_models.GuildFeature(feature) for feature in guild_payload[&#34;features&#34;]],
                icon_hash=guild_payload[&#34;icon&#34;],
                splash_hash=guild_payload[&#34;splash&#34;],
                banner_hash=guild_payload[&#34;banner&#34;],
                description=guild_payload[&#34;description&#34;],
                verification_level=guild_models.GuildVerificationLevel(guild_payload[&#34;verification_level&#34;]),
                vanity_url_code=guild_payload[&#34;vanity_url_code&#34;],
                welcome_screen=self.deserialize_welcome_screen(raw_welcome_screen) if raw_welcome_screen else None,
                nsfw_level=guild_models.GuildNSFWLevel(guild_payload[&#34;nsfw_level&#34;]),
            )
            guild_id = guild.id
        elif &#34;guild_id&#34; in payload:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        channel: typing.Optional[channel_models.PartialChannel] = None
        if (raw_channel := payload.get(&#34;channel&#34;)) is not None:
            channel = self.deserialize_partial_channel(raw_channel)
            channel_id = channel.id
        else:
            channel_id = snowflakes.Snowflake(payload[&#34;channel_id&#34;])

        target_application: typing.Optional[application_models.InviteApplication] = None
        if (invite_payload := payload.get(&#34;target_application&#34;)) is not None:
            target_application = application_models.InviteApplication(
                app=self._app,
                id=snowflakes.Snowflake(invite_payload[&#34;id&#34;]),
                name=invite_payload[&#34;name&#34;],
                description=invite_payload[&#34;description&#34;] or None,
                summary=invite_payload[&#34;summary&#34;] or None,
                public_key=bytes.fromhex(invite_payload[&#34;verify_key&#34;]),
                icon_hash=invite_payload.get(&#34;icon&#34;),
                cover_image_hash=invite_payload.get(&#34;cover_image&#34;),
            )

        approximate_active_member_count = (
            int(payload[&#34;approximate_presence_count&#34;]) if &#34;approximate_presence_count&#34; in payload else None
        )
        approximate_member_count = (
            int(payload[&#34;approximate_member_count&#34;]) if &#34;approximate_member_count&#34; in payload else None
        )
        return _InviteFields(
            code=payload[&#34;code&#34;],
            guild=guild,
            guild_id=guild_id,
            channel=channel,
            channel_id=channel_id,
            inviter=self.deserialize_user(payload[&#34;inviter&#34;]) if &#34;inviter&#34; in payload else None,
            target_type=invite_models.TargetType(payload[&#34;target_type&#34;]) if &#34;target_type&#34; in payload else None,
            target_user=self.deserialize_user(payload[&#34;target_user&#34;]) if &#34;target_user&#34; in payload else None,
            target_application=target_application,
            approximate_active_member_count=approximate_active_member_count,
            approximate_member_count=approximate_member_count,
        )

    def deserialize_invite(self, payload: data_binding.JSONObject) -&gt; invite_models.Invite:
        invite_fields = self._set_invite_attributes(payload)

        expires_at: typing.Optional[datetime.datetime] = None
        if raw_expires_at := payload.get(&#34;expires_at&#34;):
            expires_at = time.iso8601_datetime_string_to_datetime(raw_expires_at)

        return invite_models.Invite(
            app=self._app,
            code=invite_fields.code,
            guild=invite_fields.guild,
            guild_id=invite_fields.guild_id,
            channel=invite_fields.channel,
            channel_id=invite_fields.channel_id,
            inviter=invite_fields.inviter,
            target_type=invite_fields.target_type,
            target_user=invite_fields.target_user,
            target_application=invite_fields.target_application,
            approximate_member_count=invite_fields.approximate_member_count,
            approximate_active_member_count=invite_fields.approximate_active_member_count,
            expires_at=expires_at,
        )

    def deserialize_invite_with_metadata(self, payload: data_binding.JSONObject) -&gt; invite_models.InviteWithMetadata:
        invite_fields = self._set_invite_attributes(payload)
        created_at = time.iso8601_datetime_string_to_datetime(payload[&#34;created_at&#34;])
        max_uses = int(payload[&#34;max_uses&#34;])

        expires_at: typing.Optional[datetime.datetime] = None
        max_age: typing.Optional[datetime.timedelta] = None
        if (raw_max_age := payload[&#34;max_age&#34;]) &gt; 0:
            max_age = datetime.timedelta(seconds=raw_max_age)
            expires_at = created_at + max_age

        return invite_models.InviteWithMetadata(
            app=self._app,
            code=invite_fields.code,
            guild=invite_fields.guild,
            guild_id=invite_fields.guild_id,
            channel=invite_fields.channel,
            channel_id=invite_fields.channel_id,
            inviter=invite_fields.inviter,
            target_type=invite_fields.target_type,
            target_user=invite_fields.target_user,
            target_application=invite_fields.target_application,
            approximate_member_count=invite_fields.approximate_member_count,
            approximate_active_member_count=invite_fields.approximate_active_member_count,
            uses=int(payload[&#34;uses&#34;]),
            max_uses=max_uses if max_uses &gt; 0 else None,
            max_age=max_age,
            is_temporary=payload[&#34;temporary&#34;],
            created_at=created_at,
            expires_at=expires_at,
        )

    ######################
    # INTERACTION MODELS #
    ######################

    def _deserialize_command_option(self, payload: data_binding.JSONObject) -&gt; commands.CommandOption:
        choices: typing.Optional[typing.List[commands.CommandChoice]] = None
        if raw_choices := payload.get(&#34;choices&#34;):
            choices = [commands.CommandChoice(name=choice[&#34;name&#34;], value=choice[&#34;value&#34;]) for choice in raw_choices]

        suboptions: typing.Optional[typing.List[commands.CommandOption]] = None
        if raw_options := payload.get(&#34;options&#34;):
            suboptions = [self._deserialize_command_option(option) for option in raw_options]

        return commands.CommandOption(
            type=commands.OptionType(payload[&#34;type&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            is_required=payload.get(&#34;required&#34;, False),
            choices=choices,
            options=suboptions,
        )

    def deserialize_command(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedNoneOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; commands.Command:
        if guild_id is undefined.UNDEFINED:
            raw_guild_id = payload[&#34;guild_id&#34;]
            guild_id = snowflakes.Snowflake(raw_guild_id) if raw_guild_id is not None else None

        options: typing.Optional[typing.List[commands.CommandOption]] = None
        if raw_options := payload.get(&#34;options&#34;):
            options = [self._deserialize_command_option(option) for option in raw_options]

        return commands.Command(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            options=options,
            default_permission=payload.get(&#34;default_permission&#34;, True),
            guild_id=guild_id,
            version=snowflakes.Snowflake(payload[&#34;version&#34;]),
        )

    def deserialize_guild_command_permissions(
        self, payload: data_binding.JSONObject
    ) -&gt; commands.GuildCommandPermissions:
        permissions = [
            commands.CommandPermission(
                id=snowflakes.Snowflake(perm[&#34;id&#34;]),
                type=commands.CommandPermissionType(perm[&#34;type&#34;]),
                has_access=perm[&#34;permission&#34;],
            )
            for perm in payload[&#34;permissions&#34;]
        ]
        return commands.GuildCommandPermissions(
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
            command_id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            permissions=permissions,
        )

    def serialize_command_permission(self, permission: commands.CommandPermission) -&gt; data_binding.JSONObject:
        return {&#34;id&#34;: str(permission.id), &#34;type&#34;: permission.type, &#34;permission&#34;: permission.has_access}

    def deserialize_partial_interaction(self, payload: data_binding.JSONObject) -&gt; base_interactions.PartialInteraction:
        return base_interactions.PartialInteraction(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=base_interactions.InteractionType(payload[&#34;type&#34;]),
            token=payload[&#34;token&#34;],
            version=payload[&#34;version&#34;],
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
        )

    def _deserialize_interaction_command_option(
        self, payload: data_binding.JSONObject
    ) -&gt; command_interactions.CommandInteractionOption:
        suboptions: typing.Optional[typing.List[command_interactions.CommandInteractionOption]] = None
        if raw_suboptions := payload.get(&#34;options&#34;):
            suboptions = [self._deserialize_interaction_command_option(suboption) for suboption in raw_suboptions]

        option_type = commands.OptionType(payload[&#34;type&#34;])
        value = payload.get(&#34;value&#34;)
        if modifier := _interaction_option_type_mapping.get(option_type):
            value = modifier(value)

        return command_interactions.CommandInteractionOption(
            name=payload[&#34;name&#34;],
            type=option_type,
            value=value,
            options=suboptions,
        )

    def _deserialize_interaction_member(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: snowflakes.Snowflake,
        user: typing.Optional[user_models.User] = None,
    ) -&gt; base_interactions.InteractionMember:
        if not user:
            user = self.deserialize_user(payload[&#34;user&#34;])

        role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]]
        # If Discord ever does start including this here without warning we don&#39;t want to duplicate the entry.
        if guild_id not in role_ids:
            role_ids.append(guild_id)

        premium_since: typing.Optional[datetime.datetime] = None
        if (raw_premium_since := payload.get(&#34;premium_since&#34;)) is not None:
            premium_since = time.iso8601_datetime_string_to_datetime(raw_premium_since)

        # TODO: deduplicate member unmarshalling logic
        return base_interactions.InteractionMember(
            user=user,
            guild_id=guild_id,
            role_ids=role_ids,
            joined_at=time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;]),
            premium_since=premium_since,
            nickname=payload.get(&#34;nick&#34;),
            is_deaf=payload.get(&#34;deaf&#34;, undefined.UNDEFINED),
            is_mute=payload.get(&#34;mute&#34;, undefined.UNDEFINED),
            is_pending=payload.get(&#34;pending&#34;, undefined.UNDEFINED),
            permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
        )

    def deserialize_command_interaction(
        self, payload: data_binding.JSONObject
    ) -&gt; command_interactions.CommandInteraction:
        data_payload = payload[&#34;data&#34;]

        guild_id: typing.Optional[snowflakes.Snowflake] = None
        if raw_guild_id := payload.get(&#34;guild_id&#34;):
            guild_id = snowflakes.Snowflake(raw_guild_id)

        options: typing.Optional[typing.List[command_interactions.CommandInteractionOption]] = None
        if raw_options := data_payload.get(&#34;options&#34;):
            options = [self._deserialize_interaction_command_option(option) for option in raw_options]

        member: typing.Optional[base_interactions.InteractionMember]
        if member_payload := payload.get(&#34;member&#34;):
            assert guild_id is not None
            member = self._deserialize_interaction_member(member_payload, guild_id=guild_id)
            # See https://github.com/discord/discord-api-docs/pull/2568
            user = member.user

        else:
            member = None
            user = self.deserialize_user(payload[&#34;user&#34;])

        resolved: typing.Optional[command_interactions.ResolvedOptionData] = None
        if resolved_payload := data_payload.get(&#34;resolved&#34;):
            channels: typing.Dict[snowflakes.Snowflake, command_interactions.InteractionChannel] = {}
            if raw_channels := resolved_payload.get(&#34;channels&#34;):
                for channel_payload in raw_channels.values():
                    channel_id = snowflakes.Snowflake(channel_payload[&#34;id&#34;])
                    channels[channel_id] = command_interactions.InteractionChannel(
                        app=self._app,
                        id=channel_id,
                        type=channel_models.ChannelType(channel_payload[&#34;type&#34;]),
                        name=channel_payload[&#34;name&#34;],
                        permissions=permission_models.Permissions(int(channel_payload[&#34;permissions&#34;])),
                    )

            if raw_users := resolved_payload.get(&#34;users&#34;):
                users = {u.id: u for u in map(self.deserialize_user, raw_users.values())}

            else:
                users = {}

            members: typing.Dict[snowflakes.Snowflake, base_interactions.InteractionMember] = {}
            if raw_members := resolved_payload.get(&#34;members&#34;):
                for user_id, member_payload in raw_members.items():
                    assert guild_id is not None
                    user_id = snowflakes.Snowflake(user_id)
                    members[user_id] = self._deserialize_interaction_member(
                        member_payload, user=users[user_id], guild_id=guild_id
                    )

            if raw_roles := resolved_payload.get(&#34;roles&#34;):
                assert guild_id is not None
                roles_iter = (self.deserialize_role(role, guild_id=guild_id) for role in raw_roles.values())
                roles = {r.id: r for r in roles_iter}

            else:
                roles = {}

            resolved = command_interactions.ResolvedOptionData(
                channels=channels,
                members=members,
                users=users,
                roles=roles,
            )

        return command_interactions.CommandInteraction(
            app=self._app,
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=base_interactions.InteractionType(payload[&#34;type&#34;]),
            guild_id=guild_id,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            member=member,
            user=user,
            token=payload[&#34;token&#34;],
            version=payload[&#34;version&#34;],
            command_id=snowflakes.Snowflake(data_payload[&#34;id&#34;]),
            command_name=data_payload[&#34;name&#34;],
            options=options,
            resolved=resolved,
        )

    def deserialize_interaction(self, payload: data_binding.JSONObject) -&gt; base_interactions.PartialInteraction:
        interaction_type = base_interactions.InteractionType(payload[&#34;type&#34;])

        if deserialize := self._interaction_type_mapping.get(interaction_type):
            return deserialize(payload)

        _LOGGER.debug(&#34;Unknown interaction type %s&#34;, interaction_type)
        raise errors.UnrecognisedEntityError(f&#34;Unrecognised interaction type {interaction_type}&#34;)

    def serialize_command_option(self, option: commands.CommandOption) -&gt; data_binding.JSONObject:
        payload: data_binding.JSONObject = {
            &#34;type&#34;: option.type,
            &#34;name&#34;: option.name,
            &#34;description&#34;: option.description,
            &#34;required&#34;: option.is_required,
        }

        if option.choices is not None:
            payload[&#34;choices&#34;] = [{&#34;name&#34;: choice.name, &#34;value&#34;: choice.value} for choice in option.choices]

        if option.options is not None:
            payload[&#34;options&#34;] = [self.serialize_command_option(suboption) for suboption in option.options]

        return payload

    def deserialize_component_interaction(
        self, payload: data_binding.JSONObject
    ) -&gt; component_interactions.ComponentInteraction:
        data_payload = payload[&#34;data&#34;]

        guild_id = None
        if raw_guild_id := payload.get(&#34;guild_id&#34;):
            guild_id = snowflakes.Snowflake(raw_guild_id)

        member: typing.Optional[base_interactions.InteractionMember]
        if member_payload := payload.get(&#34;member&#34;):
            assert guild_id is not None
            member = self._deserialize_interaction_member(member_payload, guild_id=guild_id)
            # See https://github.com/discord/discord-api-docs/pull/2568
            user = member.user

        else:
            member = None
            user = self.deserialize_user(payload[&#34;user&#34;])

        return component_interactions.ComponentInteraction(
            app=self._app,
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=base_interactions.InteractionType(payload[&#34;type&#34;]),
            guild_id=guild_id,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            member=member,
            user=user,
            token=payload[&#34;token&#34;],
            values=data_payload.get(&#34;values&#34;) or (),
            version=payload[&#34;version&#34;],
            custom_id=data_payload[&#34;custom_id&#34;],
            component_type=message_models.ComponentType(data_payload[&#34;component_type&#34;]),
            message=self.deserialize_message(payload[&#34;message&#34;]),
        )

    ##################
    # STICKER MODELS #
    ##################

    def deserialize_sticker_pack(self, payload: data_binding.JSONObject) -&gt; sticker_models.StickerPack:
        pack_stickers: typing.List[sticker_models.StandardSticker] = []
        for sticker_payload in payload[&#34;stickers&#34;]:
            pack_stickers.append(self.deserialize_standard_sticker(sticker_payload))

        return sticker_models.StickerPack(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            cover_sticker_id=snowflakes.Snowflake(payload[&#34;cover_sticker_id&#34;]),
            stickers=pack_stickers,
            sku_id=snowflakes.Snowflake(payload[&#34;sku_id&#34;]),
            banner_hash=payload[&#34;banner_asset_id&#34;],
        )

    def deserialize_partial_sticker(self, payload: data_binding.JSONObject) -&gt; sticker_models.PartialSticker:
        return sticker_models.PartialSticker(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            format_type=sticker_models.StickerFormatType(payload[&#34;format_type&#34;]),
        )

    def deserialize_standard_sticker(self, payload: data_binding.JSONObject) -&gt; sticker_models.StandardSticker:
        return sticker_models.StandardSticker(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            format_type=sticker_models.StickerFormatType(payload[&#34;format_type&#34;]),
            pack_id=snowflakes.Snowflake(payload[&#34;pack_id&#34;]),
            sort_value=payload[&#34;sort_value&#34;],
            tags=[tag.strip() for tag in payload[&#34;tags&#34;].split(&#34;,&#34;)],
        )

    def deserialize_guild_sticker(self, payload: data_binding.JSONObject) -&gt; sticker_models.GuildSticker:
        return sticker_models.GuildSticker(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            format_type=sticker_models.StickerFormatType(payload[&#34;format_type&#34;]),
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            is_available=payload[&#34;available&#34;],
            tag=payload[&#34;tags&#34;],
            user=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
        )

    ##################
    # MESSAGE MODELS #
    ##################

    def deserialize_action_row(self, payload: data_binding.JSONObject) -&gt; message_models.ActionRowComponent:
        components: typing.List[message_models.PartialComponent] = []

        for component_payload in payload[&#34;components&#34;]:
            try:
                components.append(self.deserialize_component(component_payload))

            except errors.UnrecognisedEntityError:
                pass

        return message_models.ActionRowComponent(
            type=message_models.ComponentType(payload[&#34;type&#34;]), components=components
        )

    def deserialize_button(self, payload: data_binding.JSONObject) -&gt; message_models.ButtonComponent:
        emoji_payload = payload.get(&#34;emoji&#34;)
        return message_models.ButtonComponent(
            type=message_models.ComponentType(payload[&#34;type&#34;]),
            style=message_models.ButtonStyle(payload[&#34;style&#34;]),
            label=payload.get(&#34;label&#34;),
            emoji=self.deserialize_emoji(emoji_payload) if emoji_payload else None,
            custom_id=payload.get(&#34;custom_id&#34;),
            url=payload.get(&#34;url&#34;),
            is_disabled=payload.get(&#34;disabled&#34;, False),
        )

    def deserialize_select_menu(self, payload: data_binding.JSONObject) -&gt; message_models.SelectMenuComponent:
        options: typing.List[message_models.SelectMenuOption] = []
        for option_payload in payload[&#34;options&#34;]:
            emoji = None
            if emoji_payload := option_payload.get(&#34;emoji&#34;):
                emoji = self.deserialize_emoji(emoji_payload)

            options.append(
                message_models.SelectMenuOption(
                    label=option_payload[&#34;label&#34;],
                    value=option_payload[&#34;value&#34;],
                    description=option_payload.get(&#34;description&#34;),
                    emoji=emoji,
                    is_default=option_payload.get(&#34;default&#34;, False),
                )
            )

        return message_models.SelectMenuComponent(
            type=message_models.ComponentType(payload[&#34;type&#34;]),
            custom_id=payload[&#34;custom_id&#34;],
            options=options,
            placeholder=payload.get(&#34;placeholder&#34;),
            min_values=payload.get(&#34;min_values&#34;, 1),
            max_values=payload.get(&#34;max_values&#34;, 1),
            is_disabled=payload.get(&#34;disabled&#34;, False),
        )

    def deserialize_component(self, payload: data_binding.JSONObject) -&gt; message_models.PartialComponent:
        component_type = message_models.ComponentType(payload[&#34;type&#34;])

        if deserialize := self._component_type_mapping.get(component_type):
            return deserialize(payload)

        _LOGGER.debug(&#34;Unknown component type %s&#34;, component_type)
        raise errors.UnrecognisedEntityError(f&#34;Unrecognised component type {component_type}&#34;)

    def _deserialize_message_activity(self, payload: data_binding.JSONObject) -&gt; message_models.MessageActivity:
        return message_models.MessageActivity(
            type=message_models.MessageActivityType(payload[&#34;type&#34;]), party_id=payload.get(&#34;party_id&#34;)
        )

    def _deserialize_message_application(self, payload: data_binding.JSONObject) -&gt; message_models.MessageApplication:
        primary_sku_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_primary_sku_id := payload.get(&#34;primary_sku_id&#34;)) is not None:
            primary_sku_id = snowflakes.Snowflake(raw_primary_sku_id)

        return message_models.MessageApplication(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;] or None,
            icon_hash=payload[&#34;icon&#34;],
            summary=payload[&#34;summary&#34;] or None,
            cover_image_hash=payload.get(&#34;cover_image&#34;),
            primary_sku_id=primary_sku_id,
        )

    def _deserialize_message_attachment(self, payload: data_binding.JSONObject) -&gt; message_models.Attachment:
        return message_models.Attachment(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            filename=payload[&#34;filename&#34;],
            media_type=payload.get(&#34;content_type&#34;),
            size=int(payload[&#34;size&#34;]),
            url=payload[&#34;url&#34;],
            proxy_url=payload[&#34;proxy_url&#34;],
            height=payload.get(&#34;height&#34;),
            width=payload.get(&#34;width&#34;),
        )

    def _deserialize_message_reaction(self, payload: data_binding.JSONObject) -&gt; message_models.Reaction:
        return message_models.Reaction(
            count=int(payload[&#34;count&#34;]), emoji=self.deserialize_emoji(payload[&#34;emoji&#34;]), is_me=payload[&#34;me&#34;]
        )

    def _deserialize_message_reference(self, payload: data_binding.JSONObject) -&gt; message_models.MessageReference:
        message_reference_message_id: typing.Optional[snowflakes.Snowflake] = None
        if &#34;message_id&#34; in payload:
            message_reference_message_id = snowflakes.Snowflake(payload[&#34;message_id&#34;])

        message_reference_guild_id: typing.Optional[snowflakes.Snowflake] = None
        if &#34;guild_id&#34; in payload:
            message_reference_guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        return message_models.MessageReference(
            app=self._app,
            id=message_reference_message_id,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            guild_id=message_reference_guild_id,
        )

    def _deserialize_message_interaction(self, payload: data_binding.JSONObject) -&gt; message_models.MessageInteraction:
        return message_models.MessageInteraction(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=base_interactions.InteractionType(payload[&#34;type&#34;]),
            name=payload[&#34;name&#34;],
            user=self.deserialize_user(payload[&#34;user&#34;]),
        )

    def deserialize_partial_message(  # noqa CFQ001 - Function too long
        self, payload: data_binding.JSONObject
    ) -&gt; message_models.PartialMessage:
        author: undefined.UndefinedOr[user_models.User] = undefined.UNDEFINED
        if author_pl := payload.get(&#34;author&#34;):
            author = self.deserialize_user(author_pl)

        guild_id: typing.Optional[snowflakes.Snowflake] = None
        member: undefined.UndefinedNoneOr[guild_models.Member] = None
        if &#34;guild_id&#34; in payload:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

            if member_pl := payload.get(&#34;member&#34;):
                assert author is not None, &#34;received message with a member object without a user object&#34;
                member = self.deserialize_member(member_pl, user=author, guild_id=guild_id)
            else:
                member = undefined.UNDEFINED

        timestamp: undefined.UndefinedOr[datetime.datetime] = undefined.UNDEFINED
        if &#34;timestamp&#34; in payload:
            timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;])

        edited_timestamp: undefined.UndefinedNoneOr[datetime.datetime] = undefined.UNDEFINED
        if &#34;edited_timestamp&#34; in payload:
            if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
                edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)
            else:
                edited_timestamp = None

        attachments: undefined.UndefinedOr[typing.List[message_models.Attachment]] = undefined.UNDEFINED
        if &#34;attachments&#34; in payload:
            attachments = [self._deserialize_message_attachment(attachment) for attachment in payload[&#34;attachments&#34;]]

        embeds: undefined.UndefinedOr[typing.List[embed_models.Embed]] = undefined.UNDEFINED
        if &#34;embeds&#34; in payload:
            embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

        reactions: undefined.UndefinedOr[typing.List[message_models.Reaction]] = undefined.UNDEFINED
        if &#34;reactions&#34; in payload:
            reactions = [self._deserialize_message_reaction(reaction) for reaction in payload[&#34;reactions&#34;]]

        activity: undefined.UndefinedOr[message_models.MessageActivity] = undefined.UNDEFINED
        if &#34;activity&#34; in payload:
            activity = self._deserialize_message_activity(payload[&#34;activity&#34;])

        application: undefined.UndefinedOr[message_models.MessageApplication] = undefined.UNDEFINED
        if &#34;application&#34; in payload:
            application = self._deserialize_message_application(payload[&#34;application&#34;])

        message_reference: undefined.UndefinedOr[message_models.MessageReference] = undefined.UNDEFINED
        if &#34;message_reference&#34; in payload:
            message_reference = self._deserialize_message_reference(payload[&#34;message_reference&#34;])

        referenced_message: undefined.UndefinedNoneOr[message_models.Message] = undefined.UNDEFINED
        if &#34;referenced_message&#34; in payload:
            if (referenced_message_payload := payload[&#34;referenced_message&#34;]) is not None:
                referenced_message = self.deserialize_message(referenced_message_payload)
            else:
                referenced_message = None

        stickers: undefined.UndefinedOr[typing.Sequence[sticker_models.PartialSticker]] = undefined.UNDEFINED
        if &#34;sticker_items&#34; in payload:
            stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;sticker_items&#34;]]
        # This is only here for backwards compatibility as old messages still return this field
        elif &#34;stickers&#34; in payload:
            stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;stickers&#34;]]

        content = payload.get(&#34;content&#34;, undefined.UNDEFINED)
        if content is not undefined.UNDEFINED:
            content = content or None  # Default to None if content is an empty string

        application_id: undefined.UndefinedNoneOr[snowflakes.Snowflake] = undefined.UNDEFINED
        if raw_application_id := payload.get(&#34;application_id&#34;):
            application_id = snowflakes.Snowflake(raw_application_id)

        interaction: undefined.UndefinedNoneOr[message_models.MessageInteraction] = undefined.UNDEFINED
        if interaction_payload := payload.get(&#34;interaction&#34;):
            interaction = self._deserialize_message_interaction(interaction_payload)

        components: undefined.UndefinedOr[typing.List[message_models.PartialComponent]] = undefined.UNDEFINED
        if component_payloads := payload.get(&#34;components&#34;):
            components = []
            for component_payload in component_payloads:
                try:
                    components.append(self.deserialize_component(component_payload))

                except errors.UnrecognisedEntityError:
                    pass

        message = message_models.PartialMessage(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            guild_id=guild_id,
            author=author,
            member=member,
            content=content,
            timestamp=timestamp,
            edited_timestamp=edited_timestamp,
            is_tts=payload.get(&#34;tts&#34;, undefined.UNDEFINED),
            attachments=attachments,
            embeds=embeds,
            reactions=reactions,
            is_pinned=payload.get(&#34;pinned&#34;, undefined.UNDEFINED),
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else undefined.UNDEFINED,
            type=message_models.MessageType(payload[&#34;type&#34;]) if &#34;type&#34; in payload else undefined.UNDEFINED,
            activity=activity,
            application=application,
            message_reference=message_reference,
            referenced_message=referenced_message,
            flags=message_models.MessageFlag(payload[&#34;flags&#34;]) if &#34;flags&#34; in payload else undefined.UNDEFINED,
            stickers=stickers,
            nonce=payload.get(&#34;nonce&#34;, undefined.UNDEFINED),
            application_id=application_id,
            interaction=interaction,
            components=components,
            # We initialize these next.
            mentions=NotImplemented,
        )

        channels: undefined.UndefinedOr[typing.Dict[snowflakes.Snowflake, channel_models.PartialChannel]]
        channels = undefined.UNDEFINED
        if raw_channels := payload.get(&#34;mention_channels&#34;):
            channels = {c.id: c for c in map(self.deserialize_partial_channel, raw_channels)}

        users: undefined.UndefinedOr[typing.Dict[snowflakes.Snowflake, user_models.User]]
        users = undefined.UNDEFINED
        if raw_users := payload.get(&#34;mentions&#34;):
            users = {u.id: u for u in map(self.deserialize_user, raw_users)}

        role_ids: undefined.UndefinedOr[typing.List[snowflakes.Snowflake]] = undefined.UNDEFINED
        if raw_role_ids := payload.get(&#34;mention_roles&#34;):
            role_ids = [snowflakes.Snowflake(i) for i in raw_role_ids]

        everyone = payload.get(&#34;mention_everyone&#34;, undefined.UNDEFINED)

        message.mentions = message_models.Mentions(
            message=message,
            users=users,
            role_ids=role_ids,
            channels=channels,
            everyone=everyone,
        )

        return message

    def deserialize_message(  # noqa CFQ001 - Function too long
        self, payload: data_binding.JSONObject
    ) -&gt; message_models.Message:
        author = self.deserialize_user(payload[&#34;author&#34;])

        guild_id: typing.Optional[snowflakes.Snowflake] = None
        member: undefined.UndefinedNoneOr[guild_models.Member] = None
        if &#34;guild_id&#34; in payload:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

            if member_pl := payload.get(&#34;member&#34;):
                member = self.deserialize_member(member_pl, user=author, guild_id=guild_id)
            else:
                member = undefined.UNDEFINED

        edited_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
            edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)

        attachments = [self._deserialize_message_attachment(attachment) for attachment in payload[&#34;attachments&#34;]]

        embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

        if &#34;reactions&#34; in payload:
            reactions = [self._deserialize_message_reaction(reaction) for reaction in payload[&#34;reactions&#34;]]
        else:
            reactions = []

        activity: typing.Optional[message_models.MessageActivity] = None
        if &#34;activity&#34; in payload:
            activity = self._deserialize_message_activity(payload[&#34;activity&#34;])

        message_reference: typing.Optional[message_models.MessageReference] = None
        if &#34;message_reference&#34; in payload:
            message_reference = self._deserialize_message_reference(payload[&#34;message_reference&#34;])

        referenced_message: undefined.UndefinedNoneOr[message_models.Message] = undefined.UNDEFINED
        if &#34;referenced_message&#34; in payload:
            if (referenced_message_payload := payload[&#34;referenced_message&#34;]) is not None:
                referenced_message = self.deserialize_message(referenced_message_payload)
            else:
                referenced_message = None

        application: typing.Optional[message_models.MessageApplication] = None
        if &#34;application&#34; in payload:
            application = self._deserialize_message_application(payload[&#34;application&#34;])

        if &#34;sticker_items&#34; in payload:
            stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;sticker_items&#34;]]
        elif &#34;stickers&#34; in payload:
            stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;stickers&#34;]]
        else:
            stickers = []

        interaction: typing.Optional[message_models.MessageInteraction] = None
        if interaction_payload := payload.get(&#34;interaction&#34;):
            interaction = self._deserialize_message_interaction(interaction_payload)

        components: typing.List[message_models.PartialComponent] = []
        if component_payloads := payload.get(&#34;components&#34;):
            for component_payload in component_payloads:
                try:
                    components.append(self.deserialize_component(component_payload))

                except errors.UnrecognisedEntityError:
                    pass

        message = message_models.Message(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            guild_id=guild_id,
            author=author,
            member=member,
            content=payload[&#34;content&#34;] or None,
            timestamp=time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]),
            edited_timestamp=edited_timestamp,
            is_tts=payload[&#34;tts&#34;],
            attachments=attachments,
            embeds=embeds,
            reactions=reactions,
            is_pinned=payload[&#34;pinned&#34;],
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else None,
            type=message_models.MessageType(payload[&#34;type&#34;]),
            activity=activity,
            application=application,
            message_reference=message_reference,
            referenced_message=referenced_message,
            flags=message_models.MessageFlag(payload[&#34;flags&#34;]),
            stickers=stickers,
            nonce=payload.get(&#34;nonce&#34;),
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]) if &#34;application_id&#34; in payload else None,
            interaction=interaction,
            components=components,
            # We initialize these next.
            mentions=NotImplemented,
        )

        if raw_channels := payload.get(&#34;mention_channels&#34;):
            channels = {c.id: c for c in map(self.deserialize_partial_channel, raw_channels)}

        else:
            channels = {}

        if raw_users := payload.get(&#34;mentions&#34;):
            users = {u.id: u for u in map(self.deserialize_user, raw_users)}

        else:
            users = {}

        if raw_role_ids := payload.get(&#34;mention_roles&#34;):
            role_ids = [snowflakes.Snowflake(i) for i in raw_role_ids]

        else:
            role_ids = []

        everyone = payload.get(&#34;mention_everyone&#34;, False)

        message.mentions = message_models.Mentions(
            message=message,
            users=users,
            role_ids=role_ids,
            channels=channels,
            everyone=everyone,
        )

        return message

    ###################
    # PRESENCE MODELS #
    ###################

    def deserialize_member_presence(  # noqa: CFQ001 - Max function length
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; presence_models.MemberPresence:
        activities = []
        for activity_payload in payload[&#34;activities&#34;]:
            timestamps: typing.Optional[presence_models.ActivityTimestamps] = None
            if &#34;timestamps&#34; in activity_payload:
                timestamps_payload = activity_payload[&#34;timestamps&#34;]
                start = (
                    time.unix_epoch_to_datetime(timestamps_payload[&#34;start&#34;]) if &#34;start&#34; in timestamps_payload else None
                )
                end = time.unix_epoch_to_datetime(timestamps_payload[&#34;end&#34;]) if &#34;end&#34; in timestamps_payload else None
                timestamps = presence_models.ActivityTimestamps(start=start, end=end)

            application_id = (
                snowflakes.Snowflake(activity_payload[&#34;application_id&#34;])
                if &#34;application_id&#34; in activity_payload
                else None
            )

            party: typing.Optional[presence_models.ActivityParty] = None
            if &#34;party&#34; in activity_payload:
                party_payload = activity_payload[&#34;party&#34;]

                current_size: typing.Optional[int]
                max_size: typing.Optional[int]
                if &#34;size&#34; in party_payload:
                    raw_current_size, raw_max_size = party_payload[&#34;size&#34;]
                    current_size = int(raw_current_size)
                    max_size = int(raw_max_size)
                else:
                    current_size = max_size = None

                party = presence_models.ActivityParty(
                    id=party_payload.get(&#34;id&#34;), current_size=current_size, max_size=max_size
                )

            assets: typing.Optional[presence_models.ActivityAssets] = None
            if &#34;assets&#34; in activity_payload:
                assets_payload = activity_payload[&#34;assets&#34;]
                assets = presence_models.ActivityAssets(
                    large_image=assets_payload.get(&#34;large_image&#34;),
                    large_text=assets_payload.get(&#34;large_text&#34;),
                    small_image=assets_payload.get(&#34;small_image&#34;),
                    small_text=assets_payload.get(&#34;small_text&#34;),
                )

            secrets: typing.Optional[presence_models.ActivitySecret] = None
            if &#34;secrets&#34; in activity_payload:
                secrets_payload = activity_payload[&#34;secrets&#34;]
                secrets = presence_models.ActivitySecret(
                    join=secrets_payload.get(&#34;join&#34;),
                    spectate=secrets_payload.get(&#34;spectate&#34;),
                    match=secrets_payload.get(&#34;match&#34;),
                )

            emoji: typing.Optional[emoji_models.Emoji] = None
            raw_emoji = activity_payload.get(&#34;emoji&#34;)
            if raw_emoji is not None:
                emoji = self.deserialize_emoji(raw_emoji)

            activity = presence_models.RichActivity(
                name=activity_payload[&#34;name&#34;],
                # RichActivity&#39;s generated init already declares a converter for the &#34;type&#34; field
                type=activity_payload[&#34;type&#34;],
                url=activity_payload.get(&#34;url&#34;),
                created_at=time.unix_epoch_to_datetime(activity_payload[&#34;created_at&#34;]),
                timestamps=timestamps,
                application_id=application_id,
                details=activity_payload.get(&#34;details&#34;),
                state=activity_payload.get(&#34;state&#34;),
                emoji=emoji,
                party=party,
                assets=assets,
                secrets=secrets,
                is_instance=activity_payload.get(&#34;instance&#34;),  # TODO: can we safely default this to False?
                flags=presence_models.ActivityFlag(activity_payload[&#34;flags&#34;]) if &#34;flags&#34; in activity_payload else None,
                buttons=activity_payload.get(&#34;buttons&#34;) or [],
            )
            activities.append(activity)

        client_status_payload = payload[&#34;client_status&#34;]
        desktop = (
            presence_models.Status(client_status_payload[&#34;desktop&#34;])
            if &#34;desktop&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        mobile = (
            presence_models.Status(client_status_payload[&#34;mobile&#34;])
            if &#34;mobile&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        web = (
            presence_models.Status(client_status_payload[&#34;web&#34;])
            if &#34;web&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        client_status = presence_models.ClientStatus(desktop=desktop, mobile=mobile, web=web)

        return presence_models.MemberPresence(
            app=self._app,
            user_id=snowflakes.Snowflake(payload[&#34;user&#34;][&#34;id&#34;]),
            guild_id=guild_id if guild_id is not undefined.UNDEFINED else snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            visible_status=presence_models.Status(payload[&#34;status&#34;]),
            activities=activities,
            client_status=client_status,
        )

    ###################
    # TEMPLATE MODELS #
    ###################

    def deserialize_template(self, payload: data_binding.JSONObject) -&gt; template_models.Template:
        source_guild_payload = payload[&#34;serialized_source_guild&#34;]
        # For some reason the guild ID isn&#39;t on the actual guild object in this special case.
        guild_id = snowflakes.Snowflake(payload[&#34;source_guild_id&#34;])
        default_message_notifications = guild_models.GuildMessageNotificationsLevel(
            source_guild_payload[&#34;default_message_notifications&#34;]
        )
        explicit_content_filter = guild_models.GuildExplicitContentFilterLevel(
            source_guild_payload[&#34;explicit_content_filter&#34;]
        )

        roles: typing.Dict[snowflakes.Snowflake, template_models.TemplateRole] = {}
        for role_payload in source_guild_payload[&#34;roles&#34;]:
            role = template_models.TemplateRole(
                app=self._app,
                id=snowflakes.Snowflake(role_payload[&#34;id&#34;]),
                name=role_payload[&#34;name&#34;],
                permissions=permission_models.Permissions(int(role_payload[&#34;permissions&#34;])),
                color=color_models.Color(role_payload[&#34;color&#34;]),
                is_hoisted=role_payload[&#34;hoist&#34;],
                is_mentionable=role_payload[&#34;mentionable&#34;],
            )
            roles[role.id] = role

        channels = {}
        for channel_payload in source_guild_payload[&#34;channels&#34;]:
            channel = self.deserialize_channel(channel_payload, guild_id=guild_id)
            assert isinstance(channel, channel_models.GuildChannel)
            channels[channel.id] = channel

        afk_channel_id = source_guild_payload[&#34;afk_channel_id&#34;]
        system_channel_id = source_guild_payload[&#34;system_channel_id&#34;]

        source_guild = template_models.TemplateGuild(
            app=self._app,
            id=guild_id,
            # For some reason in this case they use the key &#34;icon_hash&#34; rather than &#34;icon&#34;.
            # Cause Discord:TM:
            icon_hash=source_guild_payload[&#34;icon_hash&#34;],
            name=source_guild_payload[&#34;name&#34;],
            description=source_guild_payload[&#34;description&#34;],
            verification_level=guild_models.GuildVerificationLevel(source_guild_payload[&#34;verification_level&#34;]),
            default_message_notifications=default_message_notifications,
            explicit_content_filter=explicit_content_filter,
            preferred_locale=source_guild_payload[&#34;preferred_locale&#34;],
            afk_timeout=datetime.timedelta(seconds=source_guild_payload[&#34;afk_timeout&#34;]),
            roles=roles,
            channels=channels,
            afk_channel_id=snowflakes.Snowflake(afk_channel_id) if afk_channel_id is not None else None,
            system_channel_id=snowflakes.Snowflake(system_channel_id) if system_channel_id is not None else None,
            system_channel_flags=guild_models.GuildSystemChannelFlag(source_guild_payload[&#34;system_channel_flags&#34;]),
        )

        return template_models.Template(
            code=payload[&#34;code&#34;],
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            usage_count=payload[&#34;usage_count&#34;],
            creator=self.deserialize_user(payload[&#34;creator&#34;]),
            created_at=time.iso8601_datetime_string_to_datetime(payload[&#34;created_at&#34;]),
            updated_at=time.iso8601_datetime_string_to_datetime(payload[&#34;updated_at&#34;]),
            source_guild=source_guild,
            is_unsynced=bool(payload[&#34;is_dirty&#34;]),
        )

    ###############
    # USER MODELS #
    ###############

    @staticmethod
    def _set_user_attributes(payload: data_binding.JSONObject) -&gt; _UserFields:
        return _UserFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            discriminator=payload[&#34;discriminator&#34;],
            username=payload[&#34;username&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            is_bot=payload.get(&#34;bot&#34;, False),
            is_system=payload.get(&#34;system&#34;, False),
        )

    def deserialize_user(self, payload: data_binding.JSONObject) -&gt; user_models.User:
        user_fields = self._set_user_attributes(payload)
        flags = (
            user_models.UserFlag(payload[&#34;public_flags&#34;]) if &#34;public_flags&#34; in payload else user_models.UserFlag.NONE
        )
        return user_models.UserImpl(
            app=self._app,
            id=user_fields.id,
            discriminator=user_fields.discriminator,
            username=user_fields.username,
            avatar_hash=user_fields.avatar_hash,
            is_bot=user_fields.is_bot,
            is_system=user_fields.is_system,
            flags=flags,
        )

    def deserialize_my_user(self, payload: data_binding.JSONObject) -&gt; user_models.OwnUser:
        user_fields = self._set_user_attributes(payload)
        return user_models.OwnUser(
            app=self._app,
            id=user_fields.id,
            discriminator=user_fields.discriminator,
            username=user_fields.username,
            avatar_hash=user_fields.avatar_hash,
            is_bot=user_fields.is_bot,
            is_system=user_fields.is_system,
            is_mfa_enabled=payload[&#34;mfa_enabled&#34;],
            locale=payload.get(&#34;locale&#34;),
            is_verified=payload.get(&#34;verified&#34;),
            email=payload.get(&#34;email&#34;),
            flags=user_models.UserFlag(payload[&#34;flags&#34;]),
            premium_type=user_models.PremiumType(payload[&#34;premium_type&#34;]) if &#34;premium_type&#34; in payload else None,
        )

    ################
    # VOICE MODELS #
    ################

    def deserialize_voice_state(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
        member: undefined.UndefinedOr[guild_models.Member] = undefined.UNDEFINED,
    ) -&gt; voice_models.VoiceState:
        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        channel_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
            channel_id = snowflakes.Snowflake(raw_channel_id)

        if member is undefined.UNDEFINED:
            member = self.deserialize_member(payload[&#34;member&#34;], guild_id=guild_id)

        requested_to_speak_at: typing.Optional[datetime.datetime] = None
        if raw_requested_to_speak_at := payload.get(&#34;request_to_speak_timestamp&#34;):
            requested_to_speak_at = time.iso8601_datetime_string_to_datetime(raw_requested_to_speak_at)

        return voice_models.VoiceState(
            app=self._app,
            guild_id=guild_id,
            channel_id=channel_id,
            user_id=snowflakes.Snowflake(payload[&#34;user_id&#34;]),
            member=member,
            session_id=payload[&#34;session_id&#34;],
            is_guild_deafened=payload[&#34;deaf&#34;],
            is_guild_muted=payload[&#34;mute&#34;],
            is_self_deafened=payload[&#34;self_deaf&#34;],
            is_self_muted=payload[&#34;self_mute&#34;],
            is_streaming=payload.get(&#34;self_stream&#34;, False),
            is_video_enabled=payload[&#34;self_video&#34;],
            is_suppressed=payload[&#34;suppress&#34;],
            requested_to_speak_at=requested_to_speak_at,
        )

    def deserialize_voice_region(self, payload: data_binding.JSONObject) -&gt; voice_models.VoiceRegion:
        return voice_models.VoiceRegion(
            id=payload[&#34;id&#34;],
            name=payload[&#34;name&#34;],
            is_vip=payload[&#34;vip&#34;],
            is_optimal_location=payload[&#34;optimal&#34;],
            is_deprecated=payload[&#34;deprecated&#34;],
            is_custom=payload[&#34;custom&#34;],
        )

    ##################
    # WEBHOOK MODELS #
    ##################

    def deserialize_incoming_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.IncomingWebhook:
        application_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_application_id := payload.get(&#34;application_id&#34;)) is not None:
            application_id = snowflakes.Snowflake(raw_application_id)

        return webhook_models.IncomingWebhook(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=webhook_models.WebhookType(payload[&#34;type&#34;]),
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            author=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
            name=payload[&#34;name&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            token=payload.get(&#34;token&#34;),
            application_id=application_id,
        )

    def deserialize_channel_follower_webhook(
        self, payload: data_binding.JSONObject
    ) -&gt; webhook_models.ChannelFollowerWebhook:
        application_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_application_id := payload.get(&#34;application_id&#34;)) is not None:
            application_id = snowflakes.Snowflake(raw_application_id)

        raw_source_channel = payload[&#34;source_channel&#34;]
        # In this case the channel type isn&#39;t provided as we can safely
        # assume it&#39;s a news channel.
        raw_source_channel[&#34;type&#34;] = channel_models.ChannelType.GUILD_NEWS
        source_channel = self.deserialize_partial_channel(raw_source_channel)
        source_guild_payload = payload[&#34;source_guild&#34;]
        source_guild = guild_models.PartialGuild(
            app=self._app,
            id=snowflakes.Snowflake(source_guild_payload[&#34;id&#34;]),
            name=source_guild_payload[&#34;name&#34;],
            icon_hash=source_guild_payload.get(&#34;icon&#34;),
        )

        return webhook_models.ChannelFollowerWebhook(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=webhook_models.WebhookType(payload[&#34;type&#34;]),
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            author=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
            name=payload[&#34;name&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            application_id=application_id,
            source_channel=source_channel,
            source_guild=source_guild,
        )

    def deserialize_application_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.ApplicationWebhook:
        return webhook_models.ApplicationWebhook(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=webhook_models.WebhookType(payload[&#34;type&#34;]),
            name=payload[&#34;name&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
        )

    def deserialize_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.PartialWebhook:
        webhook_type = webhook_models.WebhookType(payload[&#34;type&#34;])

        if converter := self._webhook_type_mapping.get(webhook_type):
            return converter(payload)

        _LOGGER.debug(f&#34;Unrecognised webhook type {webhook_type}&#34;)
        raise errors.UnrecognisedEntityError(f&#34;Unrecognised webhook type {webhook_type}&#34;)</code></pre>
</details>
</div>
</div>
<h2 id="class-heading">Classes</h2>
<section class="definition">
<dl class="no-nest root">
<div id="hikari.impl.entity_factory.EntityFactoryImpl" class="anchor">
<dt>
<h4><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="EntityFactoryImpl -- Standard implementation for a serializer/deserializer …" href="#hikari.impl.entity_factory.EntityFactoryImpl"
>EntityFactoryImpl</a></h4>
</dt>
<dd>
<pre><code id="hikari.impl.entity_factory.EntityFactoryImpl" class="hljs python"><abbr title='A standard Python type.'>class</abbr> EntityFactoryImpl (
    app: <a href='../traits.html#hikari.traits.RESTAware'>traits.RESTAware</a>,
): ...</code></pre>
<p>Standard implementation for a serializer/deserializer.</p>
<p>This will convert objects to/from JSON compatible representations.</p>
<div class="sep"></div>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L180-L2745" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">class EntityFactoryImpl(entity_factory.EntityFactory):
    &#34;&#34;&#34;Standard implementation for a serializer/deserializer.

    This will convert objects to/from JSON compatible representations.
    &#34;&#34;&#34;

    __slots__: typing.Sequence[str] = (
        &#34;_app&#34;,
        &#34;_audit_log_entry_converters&#34;,
        &#34;_audit_log_event_mapping&#34;,
        &#34;_component_type_mapping&#34;,
        &#34;_dm_channel_type_mapping&#34;,
        &#34;_guild_channel_type_mapping&#34;,
        &#34;_interaction_type_mapping&#34;,
        &#34;_webhook_type_mapping&#34;,
    )

    def __init__(self, app: traits.RESTAware) -&gt; None:
        self._app = app
        self._audit_log_entry_converters: typing.Dict[str, typing.Callable[[typing.Any], typing.Any]] = {
            audit_log_models.AuditLogChangeKey.OWNER_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.AFK_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.AFK_TIMEOUT: _deserialize_seconds_timedelta,
            audit_log_models.AuditLogChangeKey.RULES_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.PUBLIC_UPDATES_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.MFA_LEVEL: guild_models.GuildMFALevel,
            audit_log_models.AuditLogChangeKey.VERIFICATION_LEVEL: guild_models.GuildVerificationLevel,
            audit_log_models.AuditLogChangeKey.EXPLICIT_CONTENT_FILTER: guild_models.GuildExplicitContentFilterLevel,
            audit_log_models.AuditLogChangeKey.DEFAULT_MESSAGE_NOTIFICATIONS: guild_models.GuildMessageNotificationsLevel,
            # noqa: E501 - Line too long
            audit_log_models.AuditLogChangeKey.PRUNE_DELETE_DAYS: _deserialize_day_timedelta,
            audit_log_models.AuditLogChangeKey.WIDGET_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.POSITION: int,
            audit_log_models.AuditLogChangeKey.BITRATE: int,
            audit_log_models.AuditLogChangeKey.APPLICATION_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.PERMISSIONS: _with_int_cast(permission_models.Permissions),
            audit_log_models.AuditLogChangeKey.COLOR: color_models.Color,
            audit_log_models.AuditLogChangeKey.ALLOW: _with_int_cast(permission_models.Permissions),
            audit_log_models.AuditLogChangeKey.DENY: _with_int_cast(permission_models.Permissions),
            audit_log_models.AuditLogChangeKey.CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.INVITER_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.MAX_USES: _deserialize_max_uses,
            audit_log_models.AuditLogChangeKey.USES: int,
            audit_log_models.AuditLogChangeKey.MAX_AGE: _deserialize_max_age,
            audit_log_models.AuditLogChangeKey.ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.TYPE: str,
            audit_log_models.AuditLogChangeKey.ENABLE_EMOTICONS: bool,
            audit_log_models.AuditLogChangeKey.EXPIRE_BEHAVIOR: guild_models.IntegrationExpireBehaviour,
            audit_log_models.AuditLogChangeKey.EXPIRE_GRACE_PERIOD: _deserialize_day_timedelta,
            audit_log_models.AuditLogChangeKey.RATE_LIMIT_PER_USER: _deserialize_seconds_timedelta,
            audit_log_models.AuditLogChangeKey.SYSTEM_CHANNEL_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.FORMAT_TYPE: sticker_models.StickerFormatType,
            audit_log_models.AuditLogChangeKey.GUILD_ID: snowflakes.Snowflake,
            audit_log_models.AuditLogChangeKey.ADD_ROLE_TO_MEMBER: self._deserialize_audit_log_change_roles,
            audit_log_models.AuditLogChangeKey.REMOVE_ROLE_FROM_MEMBER: self._deserialize_audit_log_change_roles,
            audit_log_models.AuditLogChangeKey.PERMISSION_OVERWRITES: self._deserialize_audit_log_overwrites,
        }
        self._audit_log_event_mapping: typing.Dict[
            typing.Union[int, audit_log_models.AuditLogEventType],
            typing.Callable[[data_binding.JSONObject], audit_log_models.BaseAuditLogEntryInfo],
        ] = {
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_CREATE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_UPDATE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.CHANNEL_OVERWRITE_DELETE: self._deserialize_channel_overwrite_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_PIN: self._deserialize_message_pin_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_UNPIN: self._deserialize_message_pin_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_PRUNE: self._deserialize_member_prune_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_BULK_DELETE: self._deserialize_message_bulk_delete_entry_info,
            audit_log_models.AuditLogEventType.MESSAGE_DELETE: self._deserialize_message_delete_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_DISCONNECT: self._deserialize_member_disconnect_entry_info,
            audit_log_models.AuditLogEventType.MEMBER_MOVE: self._deserialize_member_move_entry_info,
        }
        self._component_type_mapping = {
            message_models.ComponentType.ACTION_ROW: self.deserialize_action_row,
            message_models.ComponentType.BUTTON: self.deserialize_button,
            message_models.ComponentType.SELECT_MENU: self.deserialize_select_menu,
        }
        self._dm_channel_type_mapping = {
            channel_models.ChannelType.DM: self.deserialize_dm,
            channel_models.ChannelType.GROUP_DM: self.deserialize_group_dm,
        }
        self._guild_channel_type_mapping = {
            channel_models.ChannelType.GUILD_CATEGORY: self.deserialize_guild_category,
            channel_models.ChannelType.GUILD_TEXT: self.deserialize_guild_text_channel,
            channel_models.ChannelType.GUILD_NEWS: self.deserialize_guild_news_channel,
            channel_models.ChannelType.GUILD_STORE: self.deserialize_guild_store_channel,
            channel_models.ChannelType.GUILD_VOICE: self.deserialize_guild_voice_channel,
            channel_models.ChannelType.GUILD_STAGE: self.deserialize_guild_stage_channel,
        }
        self._interaction_type_mapping: typing.Dict[
            int, typing.Callable[[data_binding.JSONObject], base_interactions.PartialInteraction]
        ] = {
            base_interactions.InteractionType.APPLICATION_COMMAND: self.deserialize_command_interaction,
            base_interactions.InteractionType.MESSAGE_COMPONENT: self.deserialize_component_interaction,
        }
        self._webhook_type_mapping = {
            webhook_models.WebhookType.INCOMING: self.deserialize_incoming_webhook,
            webhook_models.WebhookType.CHANNEL_FOLLOWER: self.deserialize_channel_follower_webhook,
            webhook_models.WebhookType.APPLICATION: self.deserialize_application_webhook,
        }

    ######################
    # APPLICATION MODELS #
    ######################

    def deserialize_own_connection(self, payload: data_binding.JSONObject) -&gt; application_models.OwnConnection:
        if (integration_payloads := payload.get(&#34;integrations&#34;)) is not None:
            integrations = [self.deserialize_partial_integration(integration) for integration in integration_payloads]
        else:
            integrations = []

        return application_models.OwnConnection(
            id=payload[&#34;id&#34;],
            name=payload[&#34;name&#34;],
            type=payload[&#34;type&#34;],
            is_revoked=payload[&#34;revoked&#34;],
            integrations=integrations,
            is_verified=payload[&#34;verified&#34;],
            is_friend_sync_enabled=payload[&#34;friend_sync&#34;],
            is_activity_visible=payload[&#34;show_activity&#34;],
            visibility=application_models.ConnectionVisibility(payload[&#34;visibility&#34;]),
        )

    def deserialize_own_guild(self, payload: data_binding.JSONObject) -&gt; application_models.OwnGuild:
        return application_models.OwnGuild(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            icon_hash=payload[&#34;icon&#34;],
            features=[guild_models.GuildFeature(feature) for feature in payload[&#34;features&#34;]],
            is_owner=bool(payload[&#34;owner&#34;]),
            my_permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
        )

    def deserialize_application(self, payload: data_binding.JSONObject) -&gt; application_models.Application:
        team: typing.Optional[application_models.Team] = None
        if (team_payload := payload.get(&#34;team&#34;)) is not None:
            members = {}
            for member_payload in team_payload[&#34;members&#34;]:
                team_member = application_models.TeamMember(
                    membership_state=application_models.TeamMembershipState(member_payload[&#34;membership_state&#34;]),
                    permissions=member_payload[&#34;permissions&#34;],
                    team_id=snowflakes.Snowflake(member_payload[&#34;team_id&#34;]),
                    user=self.deserialize_user(member_payload[&#34;user&#34;]),
                )
                members[team_member.user.id] = team_member

            team = application_models.Team(
                app=self._app,
                id=snowflakes.Snowflake(team_payload[&#34;id&#34;]),
                name=team_payload[&#34;name&#34;],
                icon_hash=team_payload[&#34;icon&#34;],
                members=members,
                owner_id=snowflakes.Snowflake(team_payload[&#34;owner_user_id&#34;]),
            )

        primary_sku_id = snowflakes.Snowflake(payload[&#34;primary_sku_id&#34;]) if &#34;primary_sku_id&#34; in payload else None
        return application_models.Application(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;] or None,
            is_bot_public=payload[&#34;bot_public&#34;],
            is_bot_code_grant_required=payload[&#34;bot_require_code_grant&#34;],
            owner=self.deserialize_user(payload[&#34;owner&#34;]),
            rpc_origins=payload.get(&#34;rpc_origins&#34;),
            summary=payload[&#34;summary&#34;] or None,
            public_key=bytes.fromhex(payload[&#34;verify_key&#34;]),
            icon_hash=payload.get(&#34;icon&#34;),
            team=team,
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None,
            primary_sku_id=primary_sku_id,
            slug=payload.get(&#34;slug&#34;),
            cover_image_hash=payload.get(&#34;cover_image&#34;),
            privacy_policy_url=payload.get(&#34;privacy_policy_url&#34;),
            terms_of_service_url=payload.get(&#34;terms_of_service_url&#34;),
        )

    def deserialize_authorization_information(
        self, payload: data_binding.JSONObject
    ) -&gt; application_models.AuthorizationInformation:
        application_payload = payload[&#34;application&#34;]
        application = application_models.AuthorizationApplication(
            id=snowflakes.Snowflake(application_payload[&#34;id&#34;]),
            name=application_payload[&#34;name&#34;],
            description=application_payload[&#34;description&#34;] or None,
            icon_hash=application_payload.get(&#34;icon&#34;),
            summary=application_payload[&#34;summary&#34;] or None,
            is_bot_public=application_payload.get(&#34;bot_public&#34;),
            is_bot_code_grant_required=application_payload.get(&#34;bot_require_code_grant&#34;),
            public_key=bytes.fromhex(application_payload[&#34;verify_key&#34;]),
            terms_of_service_url=application_payload.get(&#34;terms_of_service_url&#34;),
            privacy_policy_url=application_payload.get(&#34;privacy_policy_url&#34;),
        )

        return application_models.AuthorizationInformation(
            application=application,
            scopes=[application_models.OAuth2Scope(scope) for scope in payload[&#34;scopes&#34;]],
            expires_at=time.iso8601_datetime_string_to_datetime(payload[&#34;expires&#34;]),
            user=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
        )

    def deserialize_partial_token(self, payload: data_binding.JSONObject) -&gt; application_models.PartialOAuth2Token:
        return application_models.PartialOAuth2Token(
            access_token=payload[&#34;access_token&#34;],
            token_type=application_models.TokenType(payload[&#34;token_type&#34;]),
            expires_in=datetime.timedelta(seconds=int(payload[&#34;expires_in&#34;])),
            scopes=[application_models.OAuth2Scope(scope) for scope in payload[&#34;scope&#34;].split(&#34; &#34;)],
        )

    def deserialize_authorization_token(
        self, payload: data_binding.JSONObject
    ) -&gt; application_models.OAuth2AuthorizationToken:
        return application_models.OAuth2AuthorizationToken(
            access_token=payload[&#34;access_token&#34;],
            token_type=application_models.TokenType(payload[&#34;token_type&#34;]),
            expires_in=datetime.timedelta(seconds=int(payload[&#34;expires_in&#34;])),
            scopes=[application_models.OAuth2Scope(scope) for scope in payload[&#34;scope&#34;].split(&#34; &#34;)],
            refresh_token=payload[&#34;refresh_token&#34;],
            webhook=self.deserialize_incoming_webhook(payload[&#34;webhook&#34;]) if &#34;webhook&#34; in payload else None,
            guild=self.deserialize_rest_guild(payload[&#34;guild&#34;]) if &#34;guild&#34; in payload else None,
        )

    def deserialize_implicit_token(self, query: data_binding.Query) -&gt; application_models.OAuth2ImplicitToken:
        return application_models.OAuth2ImplicitToken(
            access_token=query[&#34;access_token&#34;],
            token_type=application_models.TokenType(query[&#34;token_type&#34;]),
            expires_in=datetime.timedelta(seconds=int(query[&#34;expires_in&#34;])),
            scopes=[application_models.OAuth2Scope(scope) for scope in query[&#34;scope&#34;].split(&#34; &#34;)],
            state=query.get(&#34;state&#34;),
        )

    #####################
    # AUDIT LOGS MODELS #
    #####################

    def _deserialize_audit_log_change_roles(
        self, payload: data_binding.JSONArray
    ) -&gt; typing.Mapping[snowflakes.Snowflake, guild_models.PartialRole]:
        roles = {}
        for role_payload in payload:
            role = guild_models.PartialRole(
                app=self._app, id=snowflakes.Snowflake(role_payload[&#34;id&#34;]), name=role_payload[&#34;name&#34;]
            )
            roles[role.id] = role

        return roles

    def _deserialize_audit_log_overwrites(
        self, payload: data_binding.JSONArray
    ) -&gt; typing.Mapping[snowflakes.Snowflake, channel_models.PermissionOverwrite]:
        return {
            snowflakes.Snowflake(overwrite[&#34;id&#34;]): self.deserialize_permission_overwrite(overwrite)
            for overwrite in payload
        }

    def _deserialize_channel_overwrite_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.ChannelOverwriteEntryInfo:
        return audit_log_models.ChannelOverwriteEntryInfo(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=channel_models.PermissionOverwriteType(payload[&#34;type&#34;]),
            role_name=payload.get(&#34;role_name&#34;),
        )

    def _deserialize_message_pin_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MessagePinEntryInfo:
        return audit_log_models.MessagePinEntryInfo(
            app=self._app,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            message_id=snowflakes.Snowflake(payload[&#34;message_id&#34;]),
        )

    def _deserialize_member_prune_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MemberPruneEntryInfo:
        return audit_log_models.MemberPruneEntryInfo(
            app=self._app,
            delete_member_days=datetime.timedelta(days=int(payload[&#34;delete_member_days&#34;])),
            members_removed=int(payload[&#34;members_removed&#34;]),
        )

    def _deserialize_message_bulk_delete_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MessageBulkDeleteEntryInfo:
        return audit_log_models.MessageBulkDeleteEntryInfo(app=self._app, count=int(payload[&#34;count&#34;]))

    def _deserialize_message_delete_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MessageDeleteEntryInfo:
        return audit_log_models.MessageDeleteEntryInfo(
            app=self._app, channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]), count=int(payload[&#34;count&#34;])
        )

    def _deserialize_member_disconnect_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MemberDisconnectEntryInfo:
        return audit_log_models.MemberDisconnectEntryInfo(app=self._app, count=int(payload[&#34;count&#34;]))

    def _deserialize_member_move_entry_info(
        self, payload: data_binding.JSONObject
    ) -&gt; audit_log_models.MemberMoveEntryInfo:
        return audit_log_models.MemberMoveEntryInfo(
            app=self._app, channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]), count=int(payload[&#34;count&#34;])
        )

    def deserialize_audit_log(self, payload: data_binding.JSONObject) -&gt; audit_log_models.AuditLog:
        entries = {}
        for entry_payload in payload[&#34;audit_log_entries&#34;]:
            entry_id = snowflakes.Snowflake(entry_payload[&#34;id&#34;])

            changes = []
            if (change_payloads := entry_payload.get(&#34;changes&#34;)) is not None:
                for change_payload in change_payloads:
                    key: typing.Union[audit_log_models.AuditLogChangeKey, str] = audit_log_models.AuditLogChangeKey(
                        change_payload[&#34;key&#34;]
                    )

                    new_value = change_payload.get(&#34;new_value&#34;)
                    old_value = change_payload.get(&#34;old_value&#34;)
                    if value_converter := self._audit_log_entry_converters.get(key):
                        new_value = value_converter(new_value) if new_value is not None else None
                        old_value = value_converter(old_value) if old_value is not None else None

                    elif not isinstance(key, audit_log_models.AuditLogChangeKey):
                        _LOGGER.debug(&#34;Unknown audit log change key found %r&#34;, key)

                    changes.append(audit_log_models.AuditLogChange(key=key, new_value=new_value, old_value=old_value))

            target_id: typing.Optional[snowflakes.Snowflake] = None
            if (raw_target_id := entry_payload[&#34;target_id&#34;]) is not None:
                target_id = snowflakes.Snowflake(raw_target_id)

            user_id: typing.Optional[snowflakes.Snowflake] = None
            if (raw_user_id := entry_payload[&#34;user_id&#34;]) is not None:
                user_id = snowflakes.Snowflake(raw_user_id)

            action_type: typing.Union[audit_log_models.AuditLogEventType, int]
            action_type = audit_log_models.AuditLogEventType(entry_payload[&#34;action_type&#34;])

            options: typing.Optional[audit_log_models.BaseAuditLogEntryInfo] = None
            if (raw_option := entry_payload.get(&#34;options&#34;)) is not None:
                if option_converter := self._audit_log_event_mapping.get(action_type):
                    options = option_converter(raw_option)

                else:
                    _LOGGER.debug(&#34;Unknown audit log action type found %r&#34;, action_type)
                    continue

            entries[entry_id] = audit_log_models.AuditLogEntry(
                app=self._app,
                id=entry_id,
                target_id=target_id,
                changes=changes,
                user_id=user_id,
                action_type=action_type,
                options=options,
                reason=entry_payload.get(&#34;reason&#34;),
            )

        integrations = {
            snowflakes.Snowflake(integration[&#34;id&#34;]): self.deserialize_partial_integration(integration)
            for integration in payload[&#34;integrations&#34;]
        }
        users = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;users&#34;]}

        webhooks: typing.Dict[snowflakes.Snowflake, webhook_models.PartialWebhook] = {}
        for webhook_payload in payload[&#34;webhooks&#34;]:
            try:
                webhook = self.deserialize_webhook(webhook_payload)

            except errors.UnrecognisedEntityError:
                continue

            webhooks[webhook.id] = webhook

        return audit_log_models.AuditLog(entries=entries, integrations=integrations, users=users, webhooks=webhooks)

    ##################
    # CHANNEL MODELS #
    ##################

    def deserialize_channel_follow(self, payload: data_binding.JSONObject) -&gt; channel_models.ChannelFollow:
        return channel_models.ChannelFollow(
            app=self._app,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]),
        )

    def deserialize_permission_overwrite(self, payload: data_binding.JSONObject) -&gt; channel_models.PermissionOverwrite:
        return channel_models.PermissionOverwrite(
            # PermissionOverwrite&#39;s init has converters set for these fields which will handle casting
            id=payload[&#34;id&#34;],
            type=payload[&#34;type&#34;],
            # Permissions still have to be cast to int before they can be cast to Permission typing wise.
            allow=int(payload[&#34;allow&#34;]),
            deny=int(payload[&#34;deny&#34;]),
        )

    def serialize_permission_overwrite(self, overwrite: channel_models.PermissionOverwrite) -&gt; data_binding.JSONObject:
        # https://github.com/discord/discord-api-docs/pull/1843/commits/470677363ba88fbc1fe79228821146c6d6b488b9
        # allow and deny can be strings instead now.
        return {
            &#34;id&#34;: str(overwrite.id),
            &#34;type&#34;: overwrite.type,
            &#34;allow&#34;: str(int(overwrite.allow)),
            &#34;deny&#34;: str(int(overwrite.deny)),
        }

    def deserialize_partial_channel(self, payload: data_binding.JSONObject) -&gt; channel_models.PartialChannel:
        return channel_models.PartialChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
        )

    def deserialize_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.DMChannel:
        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        return channel_models.DMChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            last_message_id=last_message_id,
            recipient=self.deserialize_user(payload[&#34;recipients&#34;][0]),
        )

    def deserialize_group_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.GroupDMChannel:
        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        if (raw_nicks := payload.get(&#34;nicks&#34;)) is not None:
            nicknames = {snowflakes.Snowflake(entry[&#34;id&#34;]): entry[&#34;nick&#34;] for entry in raw_nicks}
        else:
            nicknames = {}

        recipients = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;recipients&#34;]}

        return channel_models.GroupDMChannel(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            last_message_id=last_message_id,
            owner_id=snowflakes.Snowflake(payload[&#34;owner_id&#34;]),
            icon_hash=payload[&#34;icon&#34;],
            nicknames=nicknames,
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]) if &#34;application_id&#34; in payload else None,
            recipients=recipients,
        )

    def _set_guild_channel_attributes(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake],
    ) -&gt; _GuildChannelFields:
        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        permission_overwrites = {
            snowflakes.Snowflake(overwrite[&#34;id&#34;]): self.deserialize_permission_overwrite(overwrite)
            for overwrite in payload[&#34;permission_overwrites&#34;]
        }

        parent_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_parent_id := payload.get(&#34;parent_id&#34;)) is not None:
            parent_id = snowflakes.Snowflake(raw_parent_id)

        return _GuildChannelFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload.get(&#34;name&#34;),
            type=channel_models.ChannelType(payload[&#34;type&#34;]),
            guild_id=guild_id,
            position=int(payload[&#34;position&#34;]),
            permission_overwrites=permission_overwrites,
            is_nsfw=payload.get(&#34;nsfw&#34;),
            parent_id=parent_id,
        )

    def deserialize_guild_category(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildCategory:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildCategory(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
        )

    def deserialize_guild_text_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildTextChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        last_pin_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
            last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

        return channel_models.GuildTextChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            topic=payload[&#34;topic&#34;],
            last_message_id=last_message_id,
            # Usually this is 0 if unset, but some old channels made before the
            # rate_limit_per_user field was implemented will not have this field
            # at all if they have never had the rate limit changed...
            rate_limit_per_user=datetime.timedelta(seconds=payload.get(&#34;rate_limit_per_user&#34;, 0)),
            last_pin_timestamp=last_pin_timestamp,
        )

    def deserialize_guild_news_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildNewsChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

        last_message_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
            last_message_id = snowflakes.Snowflake(raw_last_message_id)

        last_pin_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
            last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

        return channel_models.GuildNewsChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            topic=payload[&#34;topic&#34;],
            last_message_id=last_message_id,
            last_pin_timestamp=last_pin_timestamp,
        )

    def deserialize_guild_store_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildStoreChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildStoreChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
        )

    def deserialize_guild_voice_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildVoiceChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        # Discord seems to be only returning this after it&#39;s been initially PATCHed in for older channels.
        video_quality_mode = payload.get(&#34;video_quality_mode&#34;, channel_models.VideoQualityMode.AUTO)
        return channel_models.GuildVoiceChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            # There seems to be an edge case where rtc_region won&#39;t be included in gateway events (e.g. GUILD_CREATE)
            # for a voice channel that just hasn&#39;t been touched since this was introduced (e.g. has been archived).
            region=payload.get(&#34;rtc_region&#34;),
            bitrate=int(payload[&#34;bitrate&#34;]),
            user_limit=int(payload[&#34;user_limit&#34;]),
            video_quality_mode=channel_models.VideoQualityMode(int(video_quality_mode)),
        )

    def deserialize_guild_stage_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.GuildStageChannel:
        channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
        return channel_models.GuildStageChannel(
            app=self._app,
            id=channel_fields.id,
            name=channel_fields.name,
            type=channel_fields.type,
            guild_id=channel_fields.guild_id,
            position=channel_fields.position,
            permission_overwrites=channel_fields.permission_overwrites,
            is_nsfw=channel_fields.is_nsfw,
            parent_id=channel_fields.parent_id,
            region=payload[&#34;rtc_region&#34;],
            bitrate=int(payload[&#34;bitrate&#34;]),
            user_limit=int(payload[&#34;user_limit&#34;]),
        )

    def deserialize_channel(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; channel_models.PartialChannel:
        channel_type = channel_models.ChannelType(payload[&#34;type&#34;])
        if guild_channel_model := self._guild_channel_type_mapping.get(channel_type):
            return guild_channel_model(payload, guild_id=guild_id)

        if dm_channel_model := self._dm_channel_type_mapping.get(channel_type):
            return dm_channel_model(payload)

        _LOGGER.debug(f&#34;Unrecognised channel type {channel_type}&#34;)
        raise errors.UnrecognisedEntityError(f&#34;Unrecognised channel type {channel_type}&#34;)

    ################
    # EMBED MODELS #
    ################

    def deserialize_embed(self, payload: data_binding.JSONObject) -&gt; embed_models.Embed:
        # Keep these separate to aid debugging later.
        title = payload.get(&#34;title&#34;)
        description = payload.get(&#34;description&#34;)
        url = payload.get(&#34;url&#34;)
        color = color_models.Color(payload[&#34;color&#34;]) if &#34;color&#34; in payload else None
        timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]) if &#34;timestamp&#34; in payload else None
        fields: typing.Optional[typing.List[embed_models.EmbedField]] = None

        image: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
        if (image_payload := payload.get(&#34;image&#34;)) and &#34;url&#34; in image_payload:
            proxy = files.ensure_resource(image_payload[&#34;proxy_url&#34;]) if &#34;proxy_url&#34; in image_payload else None
            image = embed_models.EmbedImage(
                resource=files.ensure_resource(image_payload[&#34;url&#34;]),
                proxy_resource=proxy,
                height=image_payload.get(&#34;height&#34;),
                width=image_payload.get(&#34;width&#34;),
            )

        thumbnail: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
        if (thumbnail_payload := payload.get(&#34;thumbnail&#34;)) and &#34;url&#34; in thumbnail_payload:
            proxy = files.ensure_resource(thumbnail_payload[&#34;proxy_url&#34;]) if &#34;proxy_url&#34; in thumbnail_payload else None
            thumbnail = embed_models.EmbedImage(
                resource=files.ensure_resource(thumbnail_payload[&#34;url&#34;]),
                proxy_resource=proxy,
                height=thumbnail_payload.get(&#34;height&#34;),
                width=thumbnail_payload.get(&#34;width&#34;),
            )

        video: typing.Optional[embed_models.EmbedVideo[files.AsyncReader]] = None
        if (video_payload := payload.get(&#34;video&#34;)) and &#34;url&#34; in video_payload:
            raw_proxy_url = video_payload.get(&#34;proxy_url&#34;)
            video = embed_models.EmbedVideo(
                resource=files.ensure_resource(video_payload[&#34;url&#34;]),
                proxy_resource=files.ensure_resource(raw_proxy_url) if raw_proxy_url else None,
                height=video_payload.get(&#34;height&#34;),
                width=video_payload.get(&#34;width&#34;),
            )

        provider: typing.Optional[embed_models.EmbedProvider] = None
        if provider_payload := payload.get(&#34;provider&#34;):
            provider = embed_models.EmbedProvider(name=provider_payload.get(&#34;name&#34;), url=provider_payload.get(&#34;url&#34;))

        icon: typing.Optional[embed_models.EmbedResourceWithProxy[files.AsyncReader]]
        author: typing.Optional[embed_models.EmbedAuthor] = None
        if author_payload := payload.get(&#34;author&#34;):
            icon = None
            if &#34;icon_url&#34; in author_payload:
                raw_proxy_url = author_payload.get(&#34;proxy_icon_url&#34;)
                icon = embed_models.EmbedResourceWithProxy(
                    resource=files.ensure_resource(author_payload[&#34;icon_url&#34;]),
                    proxy_resource=files.ensure_resource(raw_proxy_url) if raw_proxy_url else None,
                )

            author = embed_models.EmbedAuthor(
                name=author_payload.get(&#34;name&#34;),
                url=author_payload.get(&#34;url&#34;),
                icon=icon,
            )

        footer: typing.Optional[embed_models.EmbedFooter] = None
        if footer_payload := payload.get(&#34;footer&#34;):
            icon = None
            if &#34;icon_url&#34; in footer_payload:
                raw_proxy_url = footer_payload.get(&#34;proxy_icon_url&#34;)
                icon = embed_models.EmbedResourceWithProxy(
                    resource=files.ensure_resource(footer_payload[&#34;icon_url&#34;]),
                    proxy_resource=files.ensure_resource(raw_proxy_url) if raw_proxy_url else None,
                )

            footer = embed_models.EmbedFooter(text=footer_payload.get(&#34;text&#34;), icon=icon)

        if fields_array := payload.get(&#34;fields&#34;):
            fields = []
            for field_payload in fields_array:
                field = embed_models.EmbedField(
                    name=field_payload[&#34;name&#34;],
                    value=field_payload[&#34;value&#34;],
                    inline=field_payload.get(&#34;inline&#34;, False),
                )
                fields.append(field)

        return embed_models.Embed.from_received_embed(
            title=title,
            description=description,
            url=url,
            color=color,
            timestamp=timestamp,
            image=image,
            thumbnail=thumbnail,
            video=video,
            provider=provider,
            author=author,
            footer=footer,
            fields=fields,
        )

    def serialize_embed(  # noqa: C901 - Function too complex
        self,
        embed: embed_models.Embed,
    ) -&gt; typing.Tuple[data_binding.JSONObject, typing.List[files.Resource[files.AsyncReader]]]:

        payload: data_binding.JSONObject = {}
        uploads: typing.List[files.Resource[files.AsyncReader]] = []

        if embed.title is not None:
            payload[&#34;title&#34;] = embed.title

        if embed.description is not None:
            payload[&#34;description&#34;] = embed.description

        if embed.url is not None:
            payload[&#34;url&#34;] = embed.url

        if embed.timestamp is not None:
            payload[&#34;timestamp&#34;] = embed.timestamp.isoformat()

        if embed.color is not None:
            payload[&#34;color&#34;] = int(embed.color)

        if embed.footer is not None:
            footer_payload: data_binding.JSONObject = {}

            if embed.footer.text is not None:
                footer_payload[&#34;text&#34;] = embed.footer.text

            if embed.footer.icon is not None:
                if not isinstance(embed.footer.icon.resource, files.WebResource):
                    uploads.append(embed.footer.icon.resource)

                footer_payload[&#34;icon_url&#34;] = embed.footer.icon.url

            payload[&#34;footer&#34;] = footer_payload

        if embed.image is not None:
            image_payload: data_binding.JSONObject = {}

            if not isinstance(embed.image.resource, files.WebResource):
                uploads.append(embed.image.resource)

            image_payload[&#34;url&#34;] = embed.image.url
            payload[&#34;image&#34;] = image_payload

        if embed.thumbnail is not None:
            thumbnail_payload: data_binding.JSONObject = {}

            if not isinstance(embed.thumbnail.resource, files.WebResource):
                uploads.append(embed.thumbnail.resource)

            thumbnail_payload[&#34;url&#34;] = embed.thumbnail.url
            payload[&#34;thumbnail&#34;] = thumbnail_payload

        if embed.author is not None:
            author_payload: data_binding.JSONObject = {}

            if embed.author.name is not None:
                author_payload[&#34;name&#34;] = embed.author.name

            if embed.author.url is not None:
                author_payload[&#34;url&#34;] = embed.author.url

            if embed.author.icon is not None:
                if not isinstance(embed.author.icon.resource, files.WebResource):
                    uploads.append(embed.author.icon.resource)
                author_payload[&#34;icon_url&#34;] = embed.author.icon.url

            payload[&#34;author&#34;] = author_payload

        if embed.fields:
            field_payloads: data_binding.JSONArray = []
            for i, field in enumerate(embed.fields):

                # Yep, these are technically two unreachable branches. However, this is an incredibly
                # common mistake to make when working with embeds and not using a static type
                # checker, so I have added these as additional safeguards for UX and ease
                # of debugging. The case that there are `None` should be detected immediately by
                # static type checkers, regardless.
                name = str(field.name) if field.name is not None else None
                value = str(field.value) if field.value is not None else None

                if name is None:
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have `None`&#34;)
                if not name:
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have empty string&#34;)
                if not name.strip():
                    raise TypeError(f&#34;in embed.fields[{i}].name - cannot have only whitespace&#34;)

                if value is None:
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have `None`&#34;)
                if not value:
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have empty string&#34;)
                if not value.strip():
                    raise TypeError(f&#34;in embed.fields[{i}].value - cannot have only whitespace&#34;)

                # Name and value always have to be specified; we can always
                # send a default `inline` value also just to keep this simpler.
                field_payloads.append({&#34;name&#34;: name, &#34;value&#34;: value, &#34;inline&#34;: field.is_inline})
            payload[&#34;fields&#34;] = field_payloads

        return payload, uploads

    ################
    # EMOJI MODELS #
    ################

    def deserialize_unicode_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.UnicodeEmoji:
        return emoji_models.UnicodeEmoji(payload[&#34;name&#34;])

    def deserialize_custom_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.CustomEmoji:
        return emoji_models.CustomEmoji(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            is_animated=payload.get(&#34;animated&#34;, False),
        )

    def deserialize_known_custom_emoji(
        self, payload: data_binding.JSONObject, *, guild_id: snowflakes.Snowflake
    ) -&gt; emoji_models.KnownCustomEmoji:
        role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]] if &#34;roles&#34; in payload else []

        user: typing.Optional[user_models.User] = None
        if (raw_user := payload.get(&#34;user&#34;)) is not None:
            user = self.deserialize_user(raw_user)

        return emoji_models.KnownCustomEmoji(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            is_animated=payload.get(&#34;animated&#34;, False),
            guild_id=guild_id,
            role_ids=role_ids,
            user=user,
            is_colons_required=payload[&#34;require_colons&#34;],
            is_managed=payload[&#34;managed&#34;],
            is_available=payload[&#34;available&#34;],
        )

    def deserialize_emoji(
        self, payload: data_binding.JSONObject
    ) -&gt; typing.Union[emoji_models.UnicodeEmoji, emoji_models.CustomEmoji]:
        if payload.get(&#34;id&#34;) is not None:
            return self.deserialize_custom_emoji(payload)

        return self.deserialize_unicode_emoji(payload)

    ##################
    # GATEWAY MODELS #
    ##################

    def deserialize_gateway_bot_info(self, payload: data_binding.JSONObject) -&gt; gateway_models.GatewayBotInfo:
        session_start_limit_payload = payload[&#34;session_start_limit&#34;]
        session_start_limit = gateway_models.SessionStartLimit(
            total=int(session_start_limit_payload[&#34;total&#34;]),
            remaining=int(session_start_limit_payload[&#34;remaining&#34;]),
            reset_after=datetime.timedelta(milliseconds=session_start_limit_payload[&#34;reset_after&#34;]),
            # I do not trust that this may never be zero for some unknown reason. If it was 0, it
            # would hang the application on start up, so I enforce it is at least 1.
            max_concurrency=max(session_start_limit_payload.get(&#34;max_concurrency&#34;, 0), 1),
        )
        return gateway_models.GatewayBotInfo(
            url=payload[&#34;url&#34;],
            shard_count=int(payload[&#34;shards&#34;]),
            session_start_limit=session_start_limit,
        )

    ################
    # GUILD MODELS #
    ################

    def deserialize_guild_widget(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildWidget:
        channel_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
            channel_id = snowflakes.Snowflake(raw_channel_id)

        return guild_models.GuildWidget(app=self._app, channel_id=channel_id, is_enabled=payload[&#34;enabled&#34;])

    def deserialize_welcome_screen(self, payload: data_binding.JSONObject) -&gt; guild_models.WelcomeScreen:
        channels: typing.List[guild_models.WelcomeChannel] = []

        for channel_payload in payload[&#34;welcome_channels&#34;]:
            raw_emoji_id = channel_payload[&#34;emoji_id&#34;]
            emoji_id = snowflakes.Snowflake(raw_emoji_id) if raw_emoji_id else None

            emoji_name: typing.Union[None, emoji_models.UnicodeEmoji, str]
            if (emoji_name := channel_payload[&#34;emoji_name&#34;]) and not emoji_id:
                emoji_name = emoji_models.UnicodeEmoji(emoji_name)

            channels.append(
                guild_models.WelcomeChannel(
                    channel_id=snowflakes.Snowflake(channel_payload[&#34;channel_id&#34;]),
                    description=channel_payload[&#34;description&#34;],
                    emoji_id=emoji_id,
                    emoji_name=emoji_name,
                )
            )

        return guild_models.WelcomeScreen(description=payload[&#34;description&#34;], channels=channels)

    def serialize_welcome_channel(self, welcome_channel: guild_models.WelcomeChannel) -&gt; data_binding.JSONObject:
        payload: data_binding.JSONObject = {
            &#34;channel_id&#34;: str(welcome_channel.channel_id),
            &#34;description&#34;: welcome_channel.description,
        }

        if welcome_channel.emoji_id is not None:
            payload[&#34;emoji_id&#34;] = str(welcome_channel.emoji_id)

        elif welcome_channel.emoji_name is not None:
            payload[&#34;emoji_name&#34;] = str(welcome_channel.emoji_name)

        return payload

    def deserialize_member(
        self,
        payload: data_binding.JSONObject,
        *,
        user: undefined.UndefinedOr[user_models.User] = undefined.UNDEFINED,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; guild_models.Member:
        if user is undefined.UNDEFINED:
            user = self.deserialize_user(payload[&#34;user&#34;])

        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]]
        # If Discord ever does start including this here without warning we don&#39;t want to duplicate the entry.
        if guild_id not in role_ids:
            role_ids.append(guild_id)

        joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;])

        raw_premium_since = payload.get(&#34;premium_since&#34;)
        premium_since = (
            time.iso8601_datetime_string_to_datetime(raw_premium_since) if raw_premium_since is not None else None
        )

        return guild_models.Member(
            user=user,
            guild_id=guild_id,
            role_ids=role_ids,
            joined_at=joined_at,
            nickname=payload.get(&#34;nick&#34;),
            premium_since=premium_since,
            is_deaf=payload.get(&#34;deaf&#34;, undefined.UNDEFINED),
            is_mute=payload.get(&#34;mute&#34;, undefined.UNDEFINED),
            is_pending=payload.get(&#34;pending&#34;, undefined.UNDEFINED),
        )

    def deserialize_role(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: snowflakes.Snowflake,
    ) -&gt; guild_models.Role:
        bot_id: typing.Optional[snowflakes.Snowflake] = None
        integration_id: typing.Optional[snowflakes.Snowflake] = None
        is_premium_subscriber_role: bool = False
        if &#34;tags&#34; in payload:
            tags_payload = payload[&#34;tags&#34;]
            if &#34;bot_id&#34; in tags_payload:
                bot_id = snowflakes.Snowflake(tags_payload[&#34;bot_id&#34;])
            if &#34;integration_id&#34; in tags_payload:
                integration_id = snowflakes.Snowflake(tags_payload[&#34;integration_id&#34;])
            if &#34;premium_subscriber&#34; in tags_payload:
                is_premium_subscriber_role = True

        return guild_models.Role(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            guild_id=guild_id,
            name=payload[&#34;name&#34;],
            color=color_models.Color(payload[&#34;color&#34;]),
            is_hoisted=payload[&#34;hoist&#34;],
            position=int(payload[&#34;position&#34;]),
            permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
            is_managed=payload[&#34;managed&#34;],
            is_mentionable=payload[&#34;mentionable&#34;],
            bot_id=bot_id,
            integration_id=integration_id,
            is_premium_subscriber_role=is_premium_subscriber_role,
        )

    @staticmethod
    def _set_partial_integration_attributes(payload: data_binding.JSONObject) -&gt; _IntegrationFields:
        account_payload = payload[&#34;account&#34;]
        account = guild_models.IntegrationAccount(id=account_payload[&#34;id&#34;], name=account_payload[&#34;name&#34;])
        return _IntegrationFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            type=guild_models.IntegrationType(payload[&#34;type&#34;]),
            account=account,
        )

    def deserialize_partial_integration(self, payload: data_binding.JSONObject) -&gt; guild_models.PartialIntegration:
        integration_fields = self._set_partial_integration_attributes(payload)
        return guild_models.PartialIntegration(
            id=integration_fields.id,
            name=integration_fields.name,
            type=integration_fields.type,
            account=integration_fields.account,
        )

    def deserialize_integration(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; guild_models.Integration:
        integration_fields = self._set_partial_integration_attributes(payload)

        role_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_role_id := payload.get(&#34;role_id&#34;)) is not None:
            role_id = snowflakes.Snowflake(raw_role_id)

        last_synced_at: typing.Optional[datetime.datetime] = None
        if (raw_last_synced_at := payload.get(&#34;synced_at&#34;)) is not None:
            last_synced_at = time.iso8601_datetime_string_to_datetime(raw_last_synced_at)

        expire_grace_period: typing.Optional[datetime.timedelta] = None
        if (raw_expire_grace_period := payload.get(&#34;expire_grace_period&#34;)) is not None:
            expire_grace_period = datetime.timedelta(days=raw_expire_grace_period)

        expire_behavior: typing.Union[guild_models.IntegrationExpireBehaviour, int, None] = None
        if (raw_expire_behavior := payload.get(&#34;expire_behavior&#34;)) is not None:
            expire_behavior = guild_models.IntegrationExpireBehaviour(raw_expire_behavior)

        user: typing.Optional[user_models.User] = None
        if (raw_user := payload.get(&#34;user&#34;)) is not None:
            user = self.deserialize_user(raw_user)

        application: typing.Optional[guild_models.IntegrationApplication] = None
        if (raw_application := payload.get(&#34;application&#34;)) is not None:
            bot: typing.Optional[user_models.User] = None
            if (raw_application_bot := raw_application.get(&#34;bot&#34;)) is not None:
                bot = self.deserialize_user(raw_application_bot)

            application = guild_models.IntegrationApplication(
                id=snowflakes.Snowflake(raw_application[&#34;id&#34;]),
                name=raw_application[&#34;name&#34;],
                icon_hash=raw_application[&#34;icon&#34;],
                summary=raw_application[&#34;summary&#34;] or None,
                description=raw_application[&#34;description&#34;] or None,
                bot=bot,
            )

        return guild_models.Integration(
            id=integration_fields.id,
            guild_id=guild_id if guild_id is not undefined.UNDEFINED else snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            name=integration_fields.name,
            type=integration_fields.type,
            account=integration_fields.account,
            is_enabled=payload[&#34;enabled&#34;],
            is_syncing=payload.get(&#34;syncing&#34;),
            is_revoked=payload.get(&#34;revoked&#34;),
            role_id=role_id,
            is_emojis_enabled=payload.get(&#34;enable_emoticons&#34;),
            expire_behavior=expire_behavior,
            expire_grace_period=expire_grace_period,
            user=user,
            last_synced_at=last_synced_at,
            subscriber_count=payload.get(&#34;subscriber_count&#34;),
            application=application,
        )

    def deserialize_guild_member_ban(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildBan:
        return guild_models.GuildBan(reason=payload[&#34;reason&#34;], user=self.deserialize_user(payload[&#34;user&#34;]))

    def deserialize_guild_preview(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildPreview:
        guild_id = snowflakes.Snowflake(payload[&#34;id&#34;])
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_id)
            for emoji in payload[&#34;emojis&#34;]
        }
        return guild_models.GuildPreview(
            app=self._app,
            id=guild_id,
            name=payload[&#34;name&#34;],
            icon_hash=payload[&#34;icon&#34;],
            features=[guild_models.GuildFeature(feature) for feature in payload[&#34;features&#34;]],
            splash_hash=payload[&#34;splash&#34;],
            discovery_splash_hash=payload[&#34;discovery_splash&#34;],
            emojis=emojis,
            approximate_active_member_count=int(payload[&#34;approximate_presence_count&#34;]),
            approximate_member_count=int(payload[&#34;approximate_member_count&#34;]),
            description=payload[&#34;description&#34;],
        )

    def _set_guild_attributes(self, payload: data_binding.JSONObject) -&gt; _GuildFields:
        afk_channel_id = payload[&#34;afk_channel_id&#34;]
        default_message_notifications = guild_models.GuildMessageNotificationsLevel(
            payload[&#34;default_message_notifications&#34;]
        )
        application_id = payload[&#34;application_id&#34;]
        widget_channel_id = payload.get(&#34;widget_channel_id&#34;)
        system_channel_id = payload[&#34;system_channel_id&#34;]
        rules_channel_id = payload[&#34;rules_channel_id&#34;]
        max_video_channel_users = (
            int(payload[&#34;max_video_channel_users&#34;]) if &#34;max_video_channel_users&#34; in payload else None
        )
        public_updates_channel_id = payload[&#34;public_updates_channel_id&#34;]
        public_updates_channel_id = (
            snowflakes.Snowflake(public_updates_channel_id) if public_updates_channel_id is not None else None
        )
        return _GuildFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            icon_hash=payload[&#34;icon&#34;],
            features=[guild_models.GuildFeature(feature) for feature in payload[&#34;features&#34;]],
            splash_hash=payload[&#34;splash&#34;],
            # This is documented as always being present, but we have found old guilds where this is
            # not present. Quicker to just assume the documentation is wrong at this point than try
            # to contest whether this is right or not with Discord.
            discovery_splash_hash=payload.get(&#34;discovery_splash&#34;),
            owner_id=snowflakes.Snowflake(payload[&#34;owner_id&#34;]),
            afk_channel_id=snowflakes.Snowflake(afk_channel_id) if afk_channel_id is not None else None,
            afk_timeout=datetime.timedelta(seconds=payload[&#34;afk_timeout&#34;]),
            verification_level=guild_models.GuildVerificationLevel(payload[&#34;verification_level&#34;]),
            default_message_notifications=default_message_notifications,
            explicit_content_filter=guild_models.GuildExplicitContentFilterLevel(payload[&#34;explicit_content_filter&#34;]),
            mfa_level=guild_models.GuildMFALevel(payload[&#34;mfa_level&#34;]),
            application_id=snowflakes.Snowflake(application_id) if application_id is not None else None,
            widget_channel_id=snowflakes.Snowflake(widget_channel_id) if widget_channel_id is not None else None,
            system_channel_id=snowflakes.Snowflake(system_channel_id) if system_channel_id is not None else None,
            is_widget_enabled=payload.get(&#34;widget_enabled&#34;),
            system_channel_flags=guild_models.GuildSystemChannelFlag(payload[&#34;system_channel_flags&#34;]),
            rules_channel_id=snowflakes.Snowflake(rules_channel_id) if rules_channel_id is not None else None,
            max_video_channel_users=max_video_channel_users,
            vanity_url_code=payload[&#34;vanity_url_code&#34;],
            description=payload[&#34;description&#34;],
            banner_hash=payload[&#34;banner&#34;],
            premium_tier=guild_models.GuildPremiumTier(payload[&#34;premium_tier&#34;]),
            premium_subscription_count=payload.get(&#34;premium_subscription_count&#34;),
            preferred_locale=payload[&#34;preferred_locale&#34;],
            public_updates_channel_id=public_updates_channel_id,
            nsfw_level=guild_models.GuildNSFWLevel(payload[&#34;nsfw_level&#34;]),
        )

    def deserialize_rest_guild(self, payload: data_binding.JSONObject) -&gt; guild_models.RESTGuild:
        guild_fields = self._set_guild_attributes(payload)

        approximate_member_count: typing.Optional[int] = None
        if &#34;approximate_member_count&#34; in payload:
            approximate_member_count = int(payload[&#34;approximate_member_count&#34;])

        approximate_active_member_count: typing.Optional[int] = None
        if &#34;approximate_presence_count&#34; in payload:
            approximate_active_member_count = int(payload[&#34;approximate_presence_count&#34;])

        max_members = int(payload[&#34;max_members&#34;])

        raw_max_presences = payload[&#34;max_presences&#34;]
        max_presences = int(raw_max_presences) if raw_max_presences is not None else None

        roles = {
            snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild_fields.id)
            for role in payload[&#34;roles&#34;]
        }
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_fields.id)
            for emoji in payload[&#34;emojis&#34;]
        }
        return guild_models.RESTGuild(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=guild_fields.splash_hash,
            discovery_splash_hash=guild_fields.discovery_splash_hash,
            owner_id=guild_fields.owner_id,
            afk_channel_id=guild_fields.afk_channel_id,
            afk_timeout=guild_fields.afk_timeout,
            verification_level=guild_fields.verification_level,
            default_message_notifications=guild_fields.default_message_notifications,
            explicit_content_filter=guild_fields.explicit_content_filter,
            mfa_level=guild_fields.mfa_level,
            application_id=guild_fields.application_id,
            widget_channel_id=guild_fields.widget_channel_id,
            system_channel_id=guild_fields.system_channel_id,
            is_widget_enabled=guild_fields.is_widget_enabled,
            system_channel_flags=guild_fields.system_channel_flags,
            rules_channel_id=guild_fields.rules_channel_id,
            max_presences=max_presences,
            max_members=max_members,
            max_video_channel_users=guild_fields.max_video_channel_users,
            vanity_url_code=guild_fields.vanity_url_code,
            description=guild_fields.description,
            banner_hash=guild_fields.banner_hash,
            premium_tier=guild_fields.premium_tier,
            nsfw_level=guild_fields.nsfw_level,
            premium_subscription_count=guild_fields.premium_subscription_count,
            preferred_locale=guild_fields.preferred_locale,
            public_updates_channel_id=guild_fields.public_updates_channel_id,
            approximate_member_count=approximate_member_count,
            approximate_active_member_count=approximate_active_member_count,
            roles=roles,
            emojis=emojis,
        )

    def deserialize_gateway_guild(self, payload: data_binding.JSONObject) -&gt; entity_factory.GatewayGuildDefinition:
        guild_fields = self._set_guild_attributes(payload)
        is_large = payload.get(&#34;large&#34;)
        joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;]) if &#34;joined_at&#34; in payload else None
        member_count = int(payload[&#34;member_count&#34;]) if &#34;member_count&#34; in payload else None

        guild = guild_models.GatewayGuild(
            app=self._app,
            id=guild_fields.id,
            name=guild_fields.name,
            icon_hash=guild_fields.icon_hash,
            features=guild_fields.features,
            splash_hash=guild_fields.splash_hash,
            discovery_splash_hash=guild_fields.discovery_splash_hash,
            owner_id=guild_fields.owner_id,
            afk_channel_id=guild_fields.afk_channel_id,
            afk_timeout=guild_fields.afk_timeout,
            verification_level=guild_fields.verification_level,
            default_message_notifications=guild_fields.default_message_notifications,
            explicit_content_filter=guild_fields.explicit_content_filter,
            mfa_level=guild_fields.mfa_level,
            application_id=guild_fields.application_id,
            widget_channel_id=guild_fields.widget_channel_id,
            system_channel_id=guild_fields.system_channel_id,
            is_widget_enabled=guild_fields.is_widget_enabled,
            system_channel_flags=guild_fields.system_channel_flags,
            rules_channel_id=guild_fields.rules_channel_id,
            max_video_channel_users=guild_fields.max_video_channel_users,
            vanity_url_code=guild_fields.vanity_url_code,
            description=guild_fields.description,
            banner_hash=guild_fields.banner_hash,
            premium_tier=guild_fields.premium_tier,
            premium_subscription_count=guild_fields.premium_subscription_count,
            preferred_locale=guild_fields.preferred_locale,
            public_updates_channel_id=guild_fields.public_updates_channel_id,
            nsfw_level=guild_fields.nsfw_level,
            is_large=is_large,
            joined_at=joined_at,
            member_count=member_count,
        )

        members: typing.Optional[typing.Dict[snowflakes.Snowflake, guild_models.Member]] = None
        if &#34;members&#34; in payload:
            members = {}

            for member_payload in payload[&#34;members&#34;]:
                member = self.deserialize_member(member_payload, guild_id=guild.id)
                members[member.user.id] = member

        channels: typing.Optional[typing.Dict[snowflakes.Snowflake, channel_models.GuildChannel]] = None
        if &#34;channels&#34; in payload:
            channels = {}

            for channel_payload in payload[&#34;channels&#34;]:
                try:
                    channel = self.deserialize_channel(channel_payload, guild_id=guild.id)
                except errors.UnrecognisedEntityError:
                    # Ignore the channel, this has already been logged
                    continue

                assert isinstance(channel, channel_models.GuildChannel)
                channels[channel.id] = channel

        presences: typing.Optional[typing.Dict[snowflakes.Snowflake, presence_models.MemberPresence]] = None
        if &#34;presences&#34; in payload:
            presences = {}

            for presence_payload in payload[&#34;presences&#34;]:
                presence = self.deserialize_member_presence(presence_payload, guild_id=guild.id)
                presences[presence.user_id] = presence

        voice_states: typing.Optional[typing.Dict[snowflakes.Snowflake, voice_models.VoiceState]] = None
        if &#34;voice_states&#34; in payload:
            voice_states = {}
            assert members is not None

            for voice_state_payload in payload[&#34;voice_states&#34;]:
                member = members[snowflakes.Snowflake(voice_state_payload[&#34;user_id&#34;])]
                voice_state = self.deserialize_voice_state(voice_state_payload, guild_id=guild.id, member=member)
                voice_states[voice_state.user_id] = voice_state

        roles = {
            snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild.id)
            for role in payload[&#34;roles&#34;]
        }
        emojis = {
            snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild.id)
            for emoji in payload[&#34;emojis&#34;]
        }

        return entity_factory.GatewayGuildDefinition(guild, channels, members, presences, roles, emojis, voice_states)

    #################
    # INVITE MODELS #
    #################

    def deserialize_vanity_url(self, payload: data_binding.JSONObject) -&gt; invite_models.VanityURL:
        return invite_models.VanityURL(app=self._app, code=payload[&#34;code&#34;], uses=int(payload[&#34;uses&#34;]))

    def _set_invite_attributes(self, payload: data_binding.JSONObject) -&gt; _InviteFields:
        guild: typing.Optional[invite_models.InviteGuild] = None
        guild_id: typing.Optional[snowflakes.Snowflake] = None
        if &#34;guild&#34; in payload:
            guild_payload = payload[&#34;guild&#34;]
            raw_welcome_screen = guild_payload.get(&#34;welcome_screen&#34;)

            guild = invite_models.InviteGuild(
                app=self._app,
                id=snowflakes.Snowflake(guild_payload[&#34;id&#34;]),
                name=guild_payload[&#34;name&#34;],
                features=[guild_models.GuildFeature(feature) for feature in guild_payload[&#34;features&#34;]],
                icon_hash=guild_payload[&#34;icon&#34;],
                splash_hash=guild_payload[&#34;splash&#34;],
                banner_hash=guild_payload[&#34;banner&#34;],
                description=guild_payload[&#34;description&#34;],
                verification_level=guild_models.GuildVerificationLevel(guild_payload[&#34;verification_level&#34;]),
                vanity_url_code=guild_payload[&#34;vanity_url_code&#34;],
                welcome_screen=self.deserialize_welcome_screen(raw_welcome_screen) if raw_welcome_screen else None,
                nsfw_level=guild_models.GuildNSFWLevel(guild_payload[&#34;nsfw_level&#34;]),
            )
            guild_id = guild.id
        elif &#34;guild_id&#34; in payload:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        channel: typing.Optional[channel_models.PartialChannel] = None
        if (raw_channel := payload.get(&#34;channel&#34;)) is not None:
            channel = self.deserialize_partial_channel(raw_channel)
            channel_id = channel.id
        else:
            channel_id = snowflakes.Snowflake(payload[&#34;channel_id&#34;])

        target_application: typing.Optional[application_models.InviteApplication] = None
        if (invite_payload := payload.get(&#34;target_application&#34;)) is not None:
            target_application = application_models.InviteApplication(
                app=self._app,
                id=snowflakes.Snowflake(invite_payload[&#34;id&#34;]),
                name=invite_payload[&#34;name&#34;],
                description=invite_payload[&#34;description&#34;] or None,
                summary=invite_payload[&#34;summary&#34;] or None,
                public_key=bytes.fromhex(invite_payload[&#34;verify_key&#34;]),
                icon_hash=invite_payload.get(&#34;icon&#34;),
                cover_image_hash=invite_payload.get(&#34;cover_image&#34;),
            )

        approximate_active_member_count = (
            int(payload[&#34;approximate_presence_count&#34;]) if &#34;approximate_presence_count&#34; in payload else None
        )
        approximate_member_count = (
            int(payload[&#34;approximate_member_count&#34;]) if &#34;approximate_member_count&#34; in payload else None
        )
        return _InviteFields(
            code=payload[&#34;code&#34;],
            guild=guild,
            guild_id=guild_id,
            channel=channel,
            channel_id=channel_id,
            inviter=self.deserialize_user(payload[&#34;inviter&#34;]) if &#34;inviter&#34; in payload else None,
            target_type=invite_models.TargetType(payload[&#34;target_type&#34;]) if &#34;target_type&#34; in payload else None,
            target_user=self.deserialize_user(payload[&#34;target_user&#34;]) if &#34;target_user&#34; in payload else None,
            target_application=target_application,
            approximate_active_member_count=approximate_active_member_count,
            approximate_member_count=approximate_member_count,
        )

    def deserialize_invite(self, payload: data_binding.JSONObject) -&gt; invite_models.Invite:
        invite_fields = self._set_invite_attributes(payload)

        expires_at: typing.Optional[datetime.datetime] = None
        if raw_expires_at := payload.get(&#34;expires_at&#34;):
            expires_at = time.iso8601_datetime_string_to_datetime(raw_expires_at)

        return invite_models.Invite(
            app=self._app,
            code=invite_fields.code,
            guild=invite_fields.guild,
            guild_id=invite_fields.guild_id,
            channel=invite_fields.channel,
            channel_id=invite_fields.channel_id,
            inviter=invite_fields.inviter,
            target_type=invite_fields.target_type,
            target_user=invite_fields.target_user,
            target_application=invite_fields.target_application,
            approximate_member_count=invite_fields.approximate_member_count,
            approximate_active_member_count=invite_fields.approximate_active_member_count,
            expires_at=expires_at,
        )

    def deserialize_invite_with_metadata(self, payload: data_binding.JSONObject) -&gt; invite_models.InviteWithMetadata:
        invite_fields = self._set_invite_attributes(payload)
        created_at = time.iso8601_datetime_string_to_datetime(payload[&#34;created_at&#34;])
        max_uses = int(payload[&#34;max_uses&#34;])

        expires_at: typing.Optional[datetime.datetime] = None
        max_age: typing.Optional[datetime.timedelta] = None
        if (raw_max_age := payload[&#34;max_age&#34;]) &gt; 0:
            max_age = datetime.timedelta(seconds=raw_max_age)
            expires_at = created_at + max_age

        return invite_models.InviteWithMetadata(
            app=self._app,
            code=invite_fields.code,
            guild=invite_fields.guild,
            guild_id=invite_fields.guild_id,
            channel=invite_fields.channel,
            channel_id=invite_fields.channel_id,
            inviter=invite_fields.inviter,
            target_type=invite_fields.target_type,
            target_user=invite_fields.target_user,
            target_application=invite_fields.target_application,
            approximate_member_count=invite_fields.approximate_member_count,
            approximate_active_member_count=invite_fields.approximate_active_member_count,
            uses=int(payload[&#34;uses&#34;]),
            max_uses=max_uses if max_uses &gt; 0 else None,
            max_age=max_age,
            is_temporary=payload[&#34;temporary&#34;],
            created_at=created_at,
            expires_at=expires_at,
        )

    ######################
    # INTERACTION MODELS #
    ######################

    def _deserialize_command_option(self, payload: data_binding.JSONObject) -&gt; commands.CommandOption:
        choices: typing.Optional[typing.List[commands.CommandChoice]] = None
        if raw_choices := payload.get(&#34;choices&#34;):
            choices = [commands.CommandChoice(name=choice[&#34;name&#34;], value=choice[&#34;value&#34;]) for choice in raw_choices]

        suboptions: typing.Optional[typing.List[commands.CommandOption]] = None
        if raw_options := payload.get(&#34;options&#34;):
            suboptions = [self._deserialize_command_option(option) for option in raw_options]

        return commands.CommandOption(
            type=commands.OptionType(payload[&#34;type&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            is_required=payload.get(&#34;required&#34;, False),
            choices=choices,
            options=suboptions,
        )

    def deserialize_command(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedNoneOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; commands.Command:
        if guild_id is undefined.UNDEFINED:
            raw_guild_id = payload[&#34;guild_id&#34;]
            guild_id = snowflakes.Snowflake(raw_guild_id) if raw_guild_id is not None else None

        options: typing.Optional[typing.List[commands.CommandOption]] = None
        if raw_options := payload.get(&#34;options&#34;):
            options = [self._deserialize_command_option(option) for option in raw_options]

        return commands.Command(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            options=options,
            default_permission=payload.get(&#34;default_permission&#34;, True),
            guild_id=guild_id,
            version=snowflakes.Snowflake(payload[&#34;version&#34;]),
        )

    def deserialize_guild_command_permissions(
        self, payload: data_binding.JSONObject
    ) -&gt; commands.GuildCommandPermissions:
        permissions = [
            commands.CommandPermission(
                id=snowflakes.Snowflake(perm[&#34;id&#34;]),
                type=commands.CommandPermissionType(perm[&#34;type&#34;]),
                has_access=perm[&#34;permission&#34;],
            )
            for perm in payload[&#34;permissions&#34;]
        ]
        return commands.GuildCommandPermissions(
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
            command_id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            permissions=permissions,
        )

    def serialize_command_permission(self, permission: commands.CommandPermission) -&gt; data_binding.JSONObject:
        return {&#34;id&#34;: str(permission.id), &#34;type&#34;: permission.type, &#34;permission&#34;: permission.has_access}

    def deserialize_partial_interaction(self, payload: data_binding.JSONObject) -&gt; base_interactions.PartialInteraction:
        return base_interactions.PartialInteraction(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=base_interactions.InteractionType(payload[&#34;type&#34;]),
            token=payload[&#34;token&#34;],
            version=payload[&#34;version&#34;],
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
        )

    def _deserialize_interaction_command_option(
        self, payload: data_binding.JSONObject
    ) -&gt; command_interactions.CommandInteractionOption:
        suboptions: typing.Optional[typing.List[command_interactions.CommandInteractionOption]] = None
        if raw_suboptions := payload.get(&#34;options&#34;):
            suboptions = [self._deserialize_interaction_command_option(suboption) for suboption in raw_suboptions]

        option_type = commands.OptionType(payload[&#34;type&#34;])
        value = payload.get(&#34;value&#34;)
        if modifier := _interaction_option_type_mapping.get(option_type):
            value = modifier(value)

        return command_interactions.CommandInteractionOption(
            name=payload[&#34;name&#34;],
            type=option_type,
            value=value,
            options=suboptions,
        )

    def _deserialize_interaction_member(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: snowflakes.Snowflake,
        user: typing.Optional[user_models.User] = None,
    ) -&gt; base_interactions.InteractionMember:
        if not user:
            user = self.deserialize_user(payload[&#34;user&#34;])

        role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]]
        # If Discord ever does start including this here without warning we don&#39;t want to duplicate the entry.
        if guild_id not in role_ids:
            role_ids.append(guild_id)

        premium_since: typing.Optional[datetime.datetime] = None
        if (raw_premium_since := payload.get(&#34;premium_since&#34;)) is not None:
            premium_since = time.iso8601_datetime_string_to_datetime(raw_premium_since)

        # TODO: deduplicate member unmarshalling logic
        return base_interactions.InteractionMember(
            user=user,
            guild_id=guild_id,
            role_ids=role_ids,
            joined_at=time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;]),
            premium_since=premium_since,
            nickname=payload.get(&#34;nick&#34;),
            is_deaf=payload.get(&#34;deaf&#34;, undefined.UNDEFINED),
            is_mute=payload.get(&#34;mute&#34;, undefined.UNDEFINED),
            is_pending=payload.get(&#34;pending&#34;, undefined.UNDEFINED),
            permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
        )

    def deserialize_command_interaction(
        self, payload: data_binding.JSONObject
    ) -&gt; command_interactions.CommandInteraction:
        data_payload = payload[&#34;data&#34;]

        guild_id: typing.Optional[snowflakes.Snowflake] = None
        if raw_guild_id := payload.get(&#34;guild_id&#34;):
            guild_id = snowflakes.Snowflake(raw_guild_id)

        options: typing.Optional[typing.List[command_interactions.CommandInteractionOption]] = None
        if raw_options := data_payload.get(&#34;options&#34;):
            options = [self._deserialize_interaction_command_option(option) for option in raw_options]

        member: typing.Optional[base_interactions.InteractionMember]
        if member_payload := payload.get(&#34;member&#34;):
            assert guild_id is not None
            member = self._deserialize_interaction_member(member_payload, guild_id=guild_id)
            # See https://github.com/discord/discord-api-docs/pull/2568
            user = member.user

        else:
            member = None
            user = self.deserialize_user(payload[&#34;user&#34;])

        resolved: typing.Optional[command_interactions.ResolvedOptionData] = None
        if resolved_payload := data_payload.get(&#34;resolved&#34;):
            channels: typing.Dict[snowflakes.Snowflake, command_interactions.InteractionChannel] = {}
            if raw_channels := resolved_payload.get(&#34;channels&#34;):
                for channel_payload in raw_channels.values():
                    channel_id = snowflakes.Snowflake(channel_payload[&#34;id&#34;])
                    channels[channel_id] = command_interactions.InteractionChannel(
                        app=self._app,
                        id=channel_id,
                        type=channel_models.ChannelType(channel_payload[&#34;type&#34;]),
                        name=channel_payload[&#34;name&#34;],
                        permissions=permission_models.Permissions(int(channel_payload[&#34;permissions&#34;])),
                    )

            if raw_users := resolved_payload.get(&#34;users&#34;):
                users = {u.id: u for u in map(self.deserialize_user, raw_users.values())}

            else:
                users = {}

            members: typing.Dict[snowflakes.Snowflake, base_interactions.InteractionMember] = {}
            if raw_members := resolved_payload.get(&#34;members&#34;):
                for user_id, member_payload in raw_members.items():
                    assert guild_id is not None
                    user_id = snowflakes.Snowflake(user_id)
                    members[user_id] = self._deserialize_interaction_member(
                        member_payload, user=users[user_id], guild_id=guild_id
                    )

            if raw_roles := resolved_payload.get(&#34;roles&#34;):
                assert guild_id is not None
                roles_iter = (self.deserialize_role(role, guild_id=guild_id) for role in raw_roles.values())
                roles = {r.id: r for r in roles_iter}

            else:
                roles = {}

            resolved = command_interactions.ResolvedOptionData(
                channels=channels,
                members=members,
                users=users,
                roles=roles,
            )

        return command_interactions.CommandInteraction(
            app=self._app,
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=base_interactions.InteractionType(payload[&#34;type&#34;]),
            guild_id=guild_id,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            member=member,
            user=user,
            token=payload[&#34;token&#34;],
            version=payload[&#34;version&#34;],
            command_id=snowflakes.Snowflake(data_payload[&#34;id&#34;]),
            command_name=data_payload[&#34;name&#34;],
            options=options,
            resolved=resolved,
        )

    def deserialize_interaction(self, payload: data_binding.JSONObject) -&gt; base_interactions.PartialInteraction:
        interaction_type = base_interactions.InteractionType(payload[&#34;type&#34;])

        if deserialize := self._interaction_type_mapping.get(interaction_type):
            return deserialize(payload)

        _LOGGER.debug(&#34;Unknown interaction type %s&#34;, interaction_type)
        raise errors.UnrecognisedEntityError(f&#34;Unrecognised interaction type {interaction_type}&#34;)

    def serialize_command_option(self, option: commands.CommandOption) -&gt; data_binding.JSONObject:
        payload: data_binding.JSONObject = {
            &#34;type&#34;: option.type,
            &#34;name&#34;: option.name,
            &#34;description&#34;: option.description,
            &#34;required&#34;: option.is_required,
        }

        if option.choices is not None:
            payload[&#34;choices&#34;] = [{&#34;name&#34;: choice.name, &#34;value&#34;: choice.value} for choice in option.choices]

        if option.options is not None:
            payload[&#34;options&#34;] = [self.serialize_command_option(suboption) for suboption in option.options]

        return payload

    def deserialize_component_interaction(
        self, payload: data_binding.JSONObject
    ) -&gt; component_interactions.ComponentInteraction:
        data_payload = payload[&#34;data&#34;]

        guild_id = None
        if raw_guild_id := payload.get(&#34;guild_id&#34;):
            guild_id = snowflakes.Snowflake(raw_guild_id)

        member: typing.Optional[base_interactions.InteractionMember]
        if member_payload := payload.get(&#34;member&#34;):
            assert guild_id is not None
            member = self._deserialize_interaction_member(member_payload, guild_id=guild_id)
            # See https://github.com/discord/discord-api-docs/pull/2568
            user = member.user

        else:
            member = None
            user = self.deserialize_user(payload[&#34;user&#34;])

        return component_interactions.ComponentInteraction(
            app=self._app,
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=base_interactions.InteractionType(payload[&#34;type&#34;]),
            guild_id=guild_id,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            member=member,
            user=user,
            token=payload[&#34;token&#34;],
            values=data_payload.get(&#34;values&#34;) or (),
            version=payload[&#34;version&#34;],
            custom_id=data_payload[&#34;custom_id&#34;],
            component_type=message_models.ComponentType(data_payload[&#34;component_type&#34;]),
            message=self.deserialize_message(payload[&#34;message&#34;]),
        )

    ##################
    # STICKER MODELS #
    ##################

    def deserialize_sticker_pack(self, payload: data_binding.JSONObject) -&gt; sticker_models.StickerPack:
        pack_stickers: typing.List[sticker_models.StandardSticker] = []
        for sticker_payload in payload[&#34;stickers&#34;]:
            pack_stickers.append(self.deserialize_standard_sticker(sticker_payload))

        return sticker_models.StickerPack(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            cover_sticker_id=snowflakes.Snowflake(payload[&#34;cover_sticker_id&#34;]),
            stickers=pack_stickers,
            sku_id=snowflakes.Snowflake(payload[&#34;sku_id&#34;]),
            banner_hash=payload[&#34;banner_asset_id&#34;],
        )

    def deserialize_partial_sticker(self, payload: data_binding.JSONObject) -&gt; sticker_models.PartialSticker:
        return sticker_models.PartialSticker(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            format_type=sticker_models.StickerFormatType(payload[&#34;format_type&#34;]),
        )

    def deserialize_standard_sticker(self, payload: data_binding.JSONObject) -&gt; sticker_models.StandardSticker:
        return sticker_models.StandardSticker(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            format_type=sticker_models.StickerFormatType(payload[&#34;format_type&#34;]),
            pack_id=snowflakes.Snowflake(payload[&#34;pack_id&#34;]),
            sort_value=payload[&#34;sort_value&#34;],
            tags=[tag.strip() for tag in payload[&#34;tags&#34;].split(&#34;,&#34;)],
        )

    def deserialize_guild_sticker(self, payload: data_binding.JSONObject) -&gt; sticker_models.GuildSticker:
        return sticker_models.GuildSticker(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            format_type=sticker_models.StickerFormatType(payload[&#34;format_type&#34;]),
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            is_available=payload[&#34;available&#34;],
            tag=payload[&#34;tags&#34;],
            user=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
        )

    ##################
    # MESSAGE MODELS #
    ##################

    def deserialize_action_row(self, payload: data_binding.JSONObject) -&gt; message_models.ActionRowComponent:
        components: typing.List[message_models.PartialComponent] = []

        for component_payload in payload[&#34;components&#34;]:
            try:
                components.append(self.deserialize_component(component_payload))

            except errors.UnrecognisedEntityError:
                pass

        return message_models.ActionRowComponent(
            type=message_models.ComponentType(payload[&#34;type&#34;]), components=components
        )

    def deserialize_button(self, payload: data_binding.JSONObject) -&gt; message_models.ButtonComponent:
        emoji_payload = payload.get(&#34;emoji&#34;)
        return message_models.ButtonComponent(
            type=message_models.ComponentType(payload[&#34;type&#34;]),
            style=message_models.ButtonStyle(payload[&#34;style&#34;]),
            label=payload.get(&#34;label&#34;),
            emoji=self.deserialize_emoji(emoji_payload) if emoji_payload else None,
            custom_id=payload.get(&#34;custom_id&#34;),
            url=payload.get(&#34;url&#34;),
            is_disabled=payload.get(&#34;disabled&#34;, False),
        )

    def deserialize_select_menu(self, payload: data_binding.JSONObject) -&gt; message_models.SelectMenuComponent:
        options: typing.List[message_models.SelectMenuOption] = []
        for option_payload in payload[&#34;options&#34;]:
            emoji = None
            if emoji_payload := option_payload.get(&#34;emoji&#34;):
                emoji = self.deserialize_emoji(emoji_payload)

            options.append(
                message_models.SelectMenuOption(
                    label=option_payload[&#34;label&#34;],
                    value=option_payload[&#34;value&#34;],
                    description=option_payload.get(&#34;description&#34;),
                    emoji=emoji,
                    is_default=option_payload.get(&#34;default&#34;, False),
                )
            )

        return message_models.SelectMenuComponent(
            type=message_models.ComponentType(payload[&#34;type&#34;]),
            custom_id=payload[&#34;custom_id&#34;],
            options=options,
            placeholder=payload.get(&#34;placeholder&#34;),
            min_values=payload.get(&#34;min_values&#34;, 1),
            max_values=payload.get(&#34;max_values&#34;, 1),
            is_disabled=payload.get(&#34;disabled&#34;, False),
        )

    def deserialize_component(self, payload: data_binding.JSONObject) -&gt; message_models.PartialComponent:
        component_type = message_models.ComponentType(payload[&#34;type&#34;])

        if deserialize := self._component_type_mapping.get(component_type):
            return deserialize(payload)

        _LOGGER.debug(&#34;Unknown component type %s&#34;, component_type)
        raise errors.UnrecognisedEntityError(f&#34;Unrecognised component type {component_type}&#34;)

    def _deserialize_message_activity(self, payload: data_binding.JSONObject) -&gt; message_models.MessageActivity:
        return message_models.MessageActivity(
            type=message_models.MessageActivityType(payload[&#34;type&#34;]), party_id=payload.get(&#34;party_id&#34;)
        )

    def _deserialize_message_application(self, payload: data_binding.JSONObject) -&gt; message_models.MessageApplication:
        primary_sku_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_primary_sku_id := payload.get(&#34;primary_sku_id&#34;)) is not None:
            primary_sku_id = snowflakes.Snowflake(raw_primary_sku_id)

        return message_models.MessageApplication(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;] or None,
            icon_hash=payload[&#34;icon&#34;],
            summary=payload[&#34;summary&#34;] or None,
            cover_image_hash=payload.get(&#34;cover_image&#34;),
            primary_sku_id=primary_sku_id,
        )

    def _deserialize_message_attachment(self, payload: data_binding.JSONObject) -&gt; message_models.Attachment:
        return message_models.Attachment(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            filename=payload[&#34;filename&#34;],
            media_type=payload.get(&#34;content_type&#34;),
            size=int(payload[&#34;size&#34;]),
            url=payload[&#34;url&#34;],
            proxy_url=payload[&#34;proxy_url&#34;],
            height=payload.get(&#34;height&#34;),
            width=payload.get(&#34;width&#34;),
        )

    def _deserialize_message_reaction(self, payload: data_binding.JSONObject) -&gt; message_models.Reaction:
        return message_models.Reaction(
            count=int(payload[&#34;count&#34;]), emoji=self.deserialize_emoji(payload[&#34;emoji&#34;]), is_me=payload[&#34;me&#34;]
        )

    def _deserialize_message_reference(self, payload: data_binding.JSONObject) -&gt; message_models.MessageReference:
        message_reference_message_id: typing.Optional[snowflakes.Snowflake] = None
        if &#34;message_id&#34; in payload:
            message_reference_message_id = snowflakes.Snowflake(payload[&#34;message_id&#34;])

        message_reference_guild_id: typing.Optional[snowflakes.Snowflake] = None
        if &#34;guild_id&#34; in payload:
            message_reference_guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        return message_models.MessageReference(
            app=self._app,
            id=message_reference_message_id,
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            guild_id=message_reference_guild_id,
        )

    def _deserialize_message_interaction(self, payload: data_binding.JSONObject) -&gt; message_models.MessageInteraction:
        return message_models.MessageInteraction(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=base_interactions.InteractionType(payload[&#34;type&#34;]),
            name=payload[&#34;name&#34;],
            user=self.deserialize_user(payload[&#34;user&#34;]),
        )

    def deserialize_partial_message(  # noqa CFQ001 - Function too long
        self, payload: data_binding.JSONObject
    ) -&gt; message_models.PartialMessage:
        author: undefined.UndefinedOr[user_models.User] = undefined.UNDEFINED
        if author_pl := payload.get(&#34;author&#34;):
            author = self.deserialize_user(author_pl)

        guild_id: typing.Optional[snowflakes.Snowflake] = None
        member: undefined.UndefinedNoneOr[guild_models.Member] = None
        if &#34;guild_id&#34; in payload:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

            if member_pl := payload.get(&#34;member&#34;):
                assert author is not None, &#34;received message with a member object without a user object&#34;
                member = self.deserialize_member(member_pl, user=author, guild_id=guild_id)
            else:
                member = undefined.UNDEFINED

        timestamp: undefined.UndefinedOr[datetime.datetime] = undefined.UNDEFINED
        if &#34;timestamp&#34; in payload:
            timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;])

        edited_timestamp: undefined.UndefinedNoneOr[datetime.datetime] = undefined.UNDEFINED
        if &#34;edited_timestamp&#34; in payload:
            if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
                edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)
            else:
                edited_timestamp = None

        attachments: undefined.UndefinedOr[typing.List[message_models.Attachment]] = undefined.UNDEFINED
        if &#34;attachments&#34; in payload:
            attachments = [self._deserialize_message_attachment(attachment) for attachment in payload[&#34;attachments&#34;]]

        embeds: undefined.UndefinedOr[typing.List[embed_models.Embed]] = undefined.UNDEFINED
        if &#34;embeds&#34; in payload:
            embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

        reactions: undefined.UndefinedOr[typing.List[message_models.Reaction]] = undefined.UNDEFINED
        if &#34;reactions&#34; in payload:
            reactions = [self._deserialize_message_reaction(reaction) for reaction in payload[&#34;reactions&#34;]]

        activity: undefined.UndefinedOr[message_models.MessageActivity] = undefined.UNDEFINED
        if &#34;activity&#34; in payload:
            activity = self._deserialize_message_activity(payload[&#34;activity&#34;])

        application: undefined.UndefinedOr[message_models.MessageApplication] = undefined.UNDEFINED
        if &#34;application&#34; in payload:
            application = self._deserialize_message_application(payload[&#34;application&#34;])

        message_reference: undefined.UndefinedOr[message_models.MessageReference] = undefined.UNDEFINED
        if &#34;message_reference&#34; in payload:
            message_reference = self._deserialize_message_reference(payload[&#34;message_reference&#34;])

        referenced_message: undefined.UndefinedNoneOr[message_models.Message] = undefined.UNDEFINED
        if &#34;referenced_message&#34; in payload:
            if (referenced_message_payload := payload[&#34;referenced_message&#34;]) is not None:
                referenced_message = self.deserialize_message(referenced_message_payload)
            else:
                referenced_message = None

        stickers: undefined.UndefinedOr[typing.Sequence[sticker_models.PartialSticker]] = undefined.UNDEFINED
        if &#34;sticker_items&#34; in payload:
            stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;sticker_items&#34;]]
        # This is only here for backwards compatibility as old messages still return this field
        elif &#34;stickers&#34; in payload:
            stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;stickers&#34;]]

        content = payload.get(&#34;content&#34;, undefined.UNDEFINED)
        if content is not undefined.UNDEFINED:
            content = content or None  # Default to None if content is an empty string

        application_id: undefined.UndefinedNoneOr[snowflakes.Snowflake] = undefined.UNDEFINED
        if raw_application_id := payload.get(&#34;application_id&#34;):
            application_id = snowflakes.Snowflake(raw_application_id)

        interaction: undefined.UndefinedNoneOr[message_models.MessageInteraction] = undefined.UNDEFINED
        if interaction_payload := payload.get(&#34;interaction&#34;):
            interaction = self._deserialize_message_interaction(interaction_payload)

        components: undefined.UndefinedOr[typing.List[message_models.PartialComponent]] = undefined.UNDEFINED
        if component_payloads := payload.get(&#34;components&#34;):
            components = []
            for component_payload in component_payloads:
                try:
                    components.append(self.deserialize_component(component_payload))

                except errors.UnrecognisedEntityError:
                    pass

        message = message_models.PartialMessage(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            guild_id=guild_id,
            author=author,
            member=member,
            content=content,
            timestamp=timestamp,
            edited_timestamp=edited_timestamp,
            is_tts=payload.get(&#34;tts&#34;, undefined.UNDEFINED),
            attachments=attachments,
            embeds=embeds,
            reactions=reactions,
            is_pinned=payload.get(&#34;pinned&#34;, undefined.UNDEFINED),
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else undefined.UNDEFINED,
            type=message_models.MessageType(payload[&#34;type&#34;]) if &#34;type&#34; in payload else undefined.UNDEFINED,
            activity=activity,
            application=application,
            message_reference=message_reference,
            referenced_message=referenced_message,
            flags=message_models.MessageFlag(payload[&#34;flags&#34;]) if &#34;flags&#34; in payload else undefined.UNDEFINED,
            stickers=stickers,
            nonce=payload.get(&#34;nonce&#34;, undefined.UNDEFINED),
            application_id=application_id,
            interaction=interaction,
            components=components,
            # We initialize these next.
            mentions=NotImplemented,
        )

        channels: undefined.UndefinedOr[typing.Dict[snowflakes.Snowflake, channel_models.PartialChannel]]
        channels = undefined.UNDEFINED
        if raw_channels := payload.get(&#34;mention_channels&#34;):
            channels = {c.id: c for c in map(self.deserialize_partial_channel, raw_channels)}

        users: undefined.UndefinedOr[typing.Dict[snowflakes.Snowflake, user_models.User]]
        users = undefined.UNDEFINED
        if raw_users := payload.get(&#34;mentions&#34;):
            users = {u.id: u for u in map(self.deserialize_user, raw_users)}

        role_ids: undefined.UndefinedOr[typing.List[snowflakes.Snowflake]] = undefined.UNDEFINED
        if raw_role_ids := payload.get(&#34;mention_roles&#34;):
            role_ids = [snowflakes.Snowflake(i) for i in raw_role_ids]

        everyone = payload.get(&#34;mention_everyone&#34;, undefined.UNDEFINED)

        message.mentions = message_models.Mentions(
            message=message,
            users=users,
            role_ids=role_ids,
            channels=channels,
            everyone=everyone,
        )

        return message

    def deserialize_message(  # noqa CFQ001 - Function too long
        self, payload: data_binding.JSONObject
    ) -&gt; message_models.Message:
        author = self.deserialize_user(payload[&#34;author&#34;])

        guild_id: typing.Optional[snowflakes.Snowflake] = None
        member: undefined.UndefinedNoneOr[guild_models.Member] = None
        if &#34;guild_id&#34; in payload:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

            if member_pl := payload.get(&#34;member&#34;):
                member = self.deserialize_member(member_pl, user=author, guild_id=guild_id)
            else:
                member = undefined.UNDEFINED

        edited_timestamp: typing.Optional[datetime.datetime] = None
        if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
            edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)

        attachments = [self._deserialize_message_attachment(attachment) for attachment in payload[&#34;attachments&#34;]]

        embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

        if &#34;reactions&#34; in payload:
            reactions = [self._deserialize_message_reaction(reaction) for reaction in payload[&#34;reactions&#34;]]
        else:
            reactions = []

        activity: typing.Optional[message_models.MessageActivity] = None
        if &#34;activity&#34; in payload:
            activity = self._deserialize_message_activity(payload[&#34;activity&#34;])

        message_reference: typing.Optional[message_models.MessageReference] = None
        if &#34;message_reference&#34; in payload:
            message_reference = self._deserialize_message_reference(payload[&#34;message_reference&#34;])

        referenced_message: undefined.UndefinedNoneOr[message_models.Message] = undefined.UNDEFINED
        if &#34;referenced_message&#34; in payload:
            if (referenced_message_payload := payload[&#34;referenced_message&#34;]) is not None:
                referenced_message = self.deserialize_message(referenced_message_payload)
            else:
                referenced_message = None

        application: typing.Optional[message_models.MessageApplication] = None
        if &#34;application&#34; in payload:
            application = self._deserialize_message_application(payload[&#34;application&#34;])

        if &#34;sticker_items&#34; in payload:
            stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;sticker_items&#34;]]
        elif &#34;stickers&#34; in payload:
            stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;stickers&#34;]]
        else:
            stickers = []

        interaction: typing.Optional[message_models.MessageInteraction] = None
        if interaction_payload := payload.get(&#34;interaction&#34;):
            interaction = self._deserialize_message_interaction(interaction_payload)

        components: typing.List[message_models.PartialComponent] = []
        if component_payloads := payload.get(&#34;components&#34;):
            for component_payload in component_payloads:
                try:
                    components.append(self.deserialize_component(component_payload))

                except errors.UnrecognisedEntityError:
                    pass

        message = message_models.Message(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            guild_id=guild_id,
            author=author,
            member=member,
            content=payload[&#34;content&#34;] or None,
            timestamp=time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]),
            edited_timestamp=edited_timestamp,
            is_tts=payload[&#34;tts&#34;],
            attachments=attachments,
            embeds=embeds,
            reactions=reactions,
            is_pinned=payload[&#34;pinned&#34;],
            webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else None,
            type=message_models.MessageType(payload[&#34;type&#34;]),
            activity=activity,
            application=application,
            message_reference=message_reference,
            referenced_message=referenced_message,
            flags=message_models.MessageFlag(payload[&#34;flags&#34;]),
            stickers=stickers,
            nonce=payload.get(&#34;nonce&#34;),
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]) if &#34;application_id&#34; in payload else None,
            interaction=interaction,
            components=components,
            # We initialize these next.
            mentions=NotImplemented,
        )

        if raw_channels := payload.get(&#34;mention_channels&#34;):
            channels = {c.id: c for c in map(self.deserialize_partial_channel, raw_channels)}

        else:
            channels = {}

        if raw_users := payload.get(&#34;mentions&#34;):
            users = {u.id: u for u in map(self.deserialize_user, raw_users)}

        else:
            users = {}

        if raw_role_ids := payload.get(&#34;mention_roles&#34;):
            role_ids = [snowflakes.Snowflake(i) for i in raw_role_ids]

        else:
            role_ids = []

        everyone = payload.get(&#34;mention_everyone&#34;, False)

        message.mentions = message_models.Mentions(
            message=message,
            users=users,
            role_ids=role_ids,
            channels=channels,
            everyone=everyone,
        )

        return message

    ###################
    # PRESENCE MODELS #
    ###################

    def deserialize_member_presence(  # noqa: CFQ001 - Max function length
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    ) -&gt; presence_models.MemberPresence:
        activities = []
        for activity_payload in payload[&#34;activities&#34;]:
            timestamps: typing.Optional[presence_models.ActivityTimestamps] = None
            if &#34;timestamps&#34; in activity_payload:
                timestamps_payload = activity_payload[&#34;timestamps&#34;]
                start = (
                    time.unix_epoch_to_datetime(timestamps_payload[&#34;start&#34;]) if &#34;start&#34; in timestamps_payload else None
                )
                end = time.unix_epoch_to_datetime(timestamps_payload[&#34;end&#34;]) if &#34;end&#34; in timestamps_payload else None
                timestamps = presence_models.ActivityTimestamps(start=start, end=end)

            application_id = (
                snowflakes.Snowflake(activity_payload[&#34;application_id&#34;])
                if &#34;application_id&#34; in activity_payload
                else None
            )

            party: typing.Optional[presence_models.ActivityParty] = None
            if &#34;party&#34; in activity_payload:
                party_payload = activity_payload[&#34;party&#34;]

                current_size: typing.Optional[int]
                max_size: typing.Optional[int]
                if &#34;size&#34; in party_payload:
                    raw_current_size, raw_max_size = party_payload[&#34;size&#34;]
                    current_size = int(raw_current_size)
                    max_size = int(raw_max_size)
                else:
                    current_size = max_size = None

                party = presence_models.ActivityParty(
                    id=party_payload.get(&#34;id&#34;), current_size=current_size, max_size=max_size
                )

            assets: typing.Optional[presence_models.ActivityAssets] = None
            if &#34;assets&#34; in activity_payload:
                assets_payload = activity_payload[&#34;assets&#34;]
                assets = presence_models.ActivityAssets(
                    large_image=assets_payload.get(&#34;large_image&#34;),
                    large_text=assets_payload.get(&#34;large_text&#34;),
                    small_image=assets_payload.get(&#34;small_image&#34;),
                    small_text=assets_payload.get(&#34;small_text&#34;),
                )

            secrets: typing.Optional[presence_models.ActivitySecret] = None
            if &#34;secrets&#34; in activity_payload:
                secrets_payload = activity_payload[&#34;secrets&#34;]
                secrets = presence_models.ActivitySecret(
                    join=secrets_payload.get(&#34;join&#34;),
                    spectate=secrets_payload.get(&#34;spectate&#34;),
                    match=secrets_payload.get(&#34;match&#34;),
                )

            emoji: typing.Optional[emoji_models.Emoji] = None
            raw_emoji = activity_payload.get(&#34;emoji&#34;)
            if raw_emoji is not None:
                emoji = self.deserialize_emoji(raw_emoji)

            activity = presence_models.RichActivity(
                name=activity_payload[&#34;name&#34;],
                # RichActivity&#39;s generated init already declares a converter for the &#34;type&#34; field
                type=activity_payload[&#34;type&#34;],
                url=activity_payload.get(&#34;url&#34;),
                created_at=time.unix_epoch_to_datetime(activity_payload[&#34;created_at&#34;]),
                timestamps=timestamps,
                application_id=application_id,
                details=activity_payload.get(&#34;details&#34;),
                state=activity_payload.get(&#34;state&#34;),
                emoji=emoji,
                party=party,
                assets=assets,
                secrets=secrets,
                is_instance=activity_payload.get(&#34;instance&#34;),  # TODO: can we safely default this to False?
                flags=presence_models.ActivityFlag(activity_payload[&#34;flags&#34;]) if &#34;flags&#34; in activity_payload else None,
                buttons=activity_payload.get(&#34;buttons&#34;) or [],
            )
            activities.append(activity)

        client_status_payload = payload[&#34;client_status&#34;]
        desktop = (
            presence_models.Status(client_status_payload[&#34;desktop&#34;])
            if &#34;desktop&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        mobile = (
            presence_models.Status(client_status_payload[&#34;mobile&#34;])
            if &#34;mobile&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        web = (
            presence_models.Status(client_status_payload[&#34;web&#34;])
            if &#34;web&#34; in client_status_payload
            else presence_models.Status.OFFLINE
        )
        client_status = presence_models.ClientStatus(desktop=desktop, mobile=mobile, web=web)

        return presence_models.MemberPresence(
            app=self._app,
            user_id=snowflakes.Snowflake(payload[&#34;user&#34;][&#34;id&#34;]),
            guild_id=guild_id if guild_id is not undefined.UNDEFINED else snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            visible_status=presence_models.Status(payload[&#34;status&#34;]),
            activities=activities,
            client_status=client_status,
        )

    ###################
    # TEMPLATE MODELS #
    ###################

    def deserialize_template(self, payload: data_binding.JSONObject) -&gt; template_models.Template:
        source_guild_payload = payload[&#34;serialized_source_guild&#34;]
        # For some reason the guild ID isn&#39;t on the actual guild object in this special case.
        guild_id = snowflakes.Snowflake(payload[&#34;source_guild_id&#34;])
        default_message_notifications = guild_models.GuildMessageNotificationsLevel(
            source_guild_payload[&#34;default_message_notifications&#34;]
        )
        explicit_content_filter = guild_models.GuildExplicitContentFilterLevel(
            source_guild_payload[&#34;explicit_content_filter&#34;]
        )

        roles: typing.Dict[snowflakes.Snowflake, template_models.TemplateRole] = {}
        for role_payload in source_guild_payload[&#34;roles&#34;]:
            role = template_models.TemplateRole(
                app=self._app,
                id=snowflakes.Snowflake(role_payload[&#34;id&#34;]),
                name=role_payload[&#34;name&#34;],
                permissions=permission_models.Permissions(int(role_payload[&#34;permissions&#34;])),
                color=color_models.Color(role_payload[&#34;color&#34;]),
                is_hoisted=role_payload[&#34;hoist&#34;],
                is_mentionable=role_payload[&#34;mentionable&#34;],
            )
            roles[role.id] = role

        channels = {}
        for channel_payload in source_guild_payload[&#34;channels&#34;]:
            channel = self.deserialize_channel(channel_payload, guild_id=guild_id)
            assert isinstance(channel, channel_models.GuildChannel)
            channels[channel.id] = channel

        afk_channel_id = source_guild_payload[&#34;afk_channel_id&#34;]
        system_channel_id = source_guild_payload[&#34;system_channel_id&#34;]

        source_guild = template_models.TemplateGuild(
            app=self._app,
            id=guild_id,
            # For some reason in this case they use the key &#34;icon_hash&#34; rather than &#34;icon&#34;.
            # Cause Discord:TM:
            icon_hash=source_guild_payload[&#34;icon_hash&#34;],
            name=source_guild_payload[&#34;name&#34;],
            description=source_guild_payload[&#34;description&#34;],
            verification_level=guild_models.GuildVerificationLevel(source_guild_payload[&#34;verification_level&#34;]),
            default_message_notifications=default_message_notifications,
            explicit_content_filter=explicit_content_filter,
            preferred_locale=source_guild_payload[&#34;preferred_locale&#34;],
            afk_timeout=datetime.timedelta(seconds=source_guild_payload[&#34;afk_timeout&#34;]),
            roles=roles,
            channels=channels,
            afk_channel_id=snowflakes.Snowflake(afk_channel_id) if afk_channel_id is not None else None,
            system_channel_id=snowflakes.Snowflake(system_channel_id) if system_channel_id is not None else None,
            system_channel_flags=guild_models.GuildSystemChannelFlag(source_guild_payload[&#34;system_channel_flags&#34;]),
        )

        return template_models.Template(
            code=payload[&#34;code&#34;],
            name=payload[&#34;name&#34;],
            description=payload[&#34;description&#34;],
            usage_count=payload[&#34;usage_count&#34;],
            creator=self.deserialize_user(payload[&#34;creator&#34;]),
            created_at=time.iso8601_datetime_string_to_datetime(payload[&#34;created_at&#34;]),
            updated_at=time.iso8601_datetime_string_to_datetime(payload[&#34;updated_at&#34;]),
            source_guild=source_guild,
            is_unsynced=bool(payload[&#34;is_dirty&#34;]),
        )

    ###############
    # USER MODELS #
    ###############

    @staticmethod
    def _set_user_attributes(payload: data_binding.JSONObject) -&gt; _UserFields:
        return _UserFields(
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            discriminator=payload[&#34;discriminator&#34;],
            username=payload[&#34;username&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            is_bot=payload.get(&#34;bot&#34;, False),
            is_system=payload.get(&#34;system&#34;, False),
        )

    def deserialize_user(self, payload: data_binding.JSONObject) -&gt; user_models.User:
        user_fields = self._set_user_attributes(payload)
        flags = (
            user_models.UserFlag(payload[&#34;public_flags&#34;]) if &#34;public_flags&#34; in payload else user_models.UserFlag.NONE
        )
        return user_models.UserImpl(
            app=self._app,
            id=user_fields.id,
            discriminator=user_fields.discriminator,
            username=user_fields.username,
            avatar_hash=user_fields.avatar_hash,
            is_bot=user_fields.is_bot,
            is_system=user_fields.is_system,
            flags=flags,
        )

    def deserialize_my_user(self, payload: data_binding.JSONObject) -&gt; user_models.OwnUser:
        user_fields = self._set_user_attributes(payload)
        return user_models.OwnUser(
            app=self._app,
            id=user_fields.id,
            discriminator=user_fields.discriminator,
            username=user_fields.username,
            avatar_hash=user_fields.avatar_hash,
            is_bot=user_fields.is_bot,
            is_system=user_fields.is_system,
            is_mfa_enabled=payload[&#34;mfa_enabled&#34;],
            locale=payload.get(&#34;locale&#34;),
            is_verified=payload.get(&#34;verified&#34;),
            email=payload.get(&#34;email&#34;),
            flags=user_models.UserFlag(payload[&#34;flags&#34;]),
            premium_type=user_models.PremiumType(payload[&#34;premium_type&#34;]) if &#34;premium_type&#34; in payload else None,
        )

    ################
    # VOICE MODELS #
    ################

    def deserialize_voice_state(
        self,
        payload: data_binding.JSONObject,
        *,
        guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
        member: undefined.UndefinedOr[guild_models.Member] = undefined.UNDEFINED,
    ) -&gt; voice_models.VoiceState:
        if guild_id is undefined.UNDEFINED:
            guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        channel_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
            channel_id = snowflakes.Snowflake(raw_channel_id)

        if member is undefined.UNDEFINED:
            member = self.deserialize_member(payload[&#34;member&#34;], guild_id=guild_id)

        requested_to_speak_at: typing.Optional[datetime.datetime] = None
        if raw_requested_to_speak_at := payload.get(&#34;request_to_speak_timestamp&#34;):
            requested_to_speak_at = time.iso8601_datetime_string_to_datetime(raw_requested_to_speak_at)

        return voice_models.VoiceState(
            app=self._app,
            guild_id=guild_id,
            channel_id=channel_id,
            user_id=snowflakes.Snowflake(payload[&#34;user_id&#34;]),
            member=member,
            session_id=payload[&#34;session_id&#34;],
            is_guild_deafened=payload[&#34;deaf&#34;],
            is_guild_muted=payload[&#34;mute&#34;],
            is_self_deafened=payload[&#34;self_deaf&#34;],
            is_self_muted=payload[&#34;self_mute&#34;],
            is_streaming=payload.get(&#34;self_stream&#34;, False),
            is_video_enabled=payload[&#34;self_video&#34;],
            is_suppressed=payload[&#34;suppress&#34;],
            requested_to_speak_at=requested_to_speak_at,
        )

    def deserialize_voice_region(self, payload: data_binding.JSONObject) -&gt; voice_models.VoiceRegion:
        return voice_models.VoiceRegion(
            id=payload[&#34;id&#34;],
            name=payload[&#34;name&#34;],
            is_vip=payload[&#34;vip&#34;],
            is_optimal_location=payload[&#34;optimal&#34;],
            is_deprecated=payload[&#34;deprecated&#34;],
            is_custom=payload[&#34;custom&#34;],
        )

    ##################
    # WEBHOOK MODELS #
    ##################

    def deserialize_incoming_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.IncomingWebhook:
        application_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_application_id := payload.get(&#34;application_id&#34;)) is not None:
            application_id = snowflakes.Snowflake(raw_application_id)

        return webhook_models.IncomingWebhook(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=webhook_models.WebhookType(payload[&#34;type&#34;]),
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            author=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
            name=payload[&#34;name&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            token=payload.get(&#34;token&#34;),
            application_id=application_id,
        )

    def deserialize_channel_follower_webhook(
        self, payload: data_binding.JSONObject
    ) -&gt; webhook_models.ChannelFollowerWebhook:
        application_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_application_id := payload.get(&#34;application_id&#34;)) is not None:
            application_id = snowflakes.Snowflake(raw_application_id)

        raw_source_channel = payload[&#34;source_channel&#34;]
        # In this case the channel type isn&#39;t provided as we can safely
        # assume it&#39;s a news channel.
        raw_source_channel[&#34;type&#34;] = channel_models.ChannelType.GUILD_NEWS
        source_channel = self.deserialize_partial_channel(raw_source_channel)
        source_guild_payload = payload[&#34;source_guild&#34;]
        source_guild = guild_models.PartialGuild(
            app=self._app,
            id=snowflakes.Snowflake(source_guild_payload[&#34;id&#34;]),
            name=source_guild_payload[&#34;name&#34;],
            icon_hash=source_guild_payload.get(&#34;icon&#34;),
        )

        return webhook_models.ChannelFollowerWebhook(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=webhook_models.WebhookType(payload[&#34;type&#34;]),
            guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
            channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
            author=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
            name=payload[&#34;name&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            application_id=application_id,
            source_channel=source_channel,
            source_guild=source_guild,
        )

    def deserialize_application_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.ApplicationWebhook:
        return webhook_models.ApplicationWebhook(
            app=self._app,
            id=snowflakes.Snowflake(payload[&#34;id&#34;]),
            type=webhook_models.WebhookType(payload[&#34;type&#34;]),
            name=payload[&#34;name&#34;],
            avatar_hash=payload[&#34;avatar&#34;],
            application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
        )

    def deserialize_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.PartialWebhook:
        webhook_type = webhook_models.WebhookType(payload[&#34;type&#34;])

        if converter := self._webhook_type_mapping.get(webhook_type):
            return converter(payload)

        _LOGGER.debug(f&#34;Unrecognised webhook type {webhook_type}&#34;)
        raise errors.UnrecognisedEntityError(f&#34;Unrecognised webhook type {webhook_type}&#34;)</code></pre>
</details>
<div class="sep"></div>
<h5>Method resolution order</h5>
<dl>
<dt class="nested"><small class='text-muted'><em><abbr title='A standard Python type.'>class</abbr></em></small> <a title="EntityFactoryImpl -- Standard implementation for a serializer/deserializer …" href="#hikari.impl.entity_factory.EntityFactoryImpl"
>EntityFactoryImpl</a></dt>
<dd class="nested"><em class="text-muted">That's this class!</em></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='An abstract base class which may have abstract methods and abstract properties.'>abstract</abbr> <abbr title='A standard Python type.'>class</abbr></em></small> <a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></dt>
<dd class="nested"><p>Interface for components that serialize and deserialize JSON payloads.</p></dd>
<dt class="nested"><small class='text-muted'><em><abbr title='Anything that is external to this library.'>extern</abbr> class</em></small> <a title="abc.ABC -- Helper class that provides a standard way to create an ABC using
inheritance." href="https://docs.python.org/3/library/abc.html#abc.ABC"
>abc.ABC</a></dt>
<dd class="nested"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p></dd>
</dl>
<div class="sep"></div>
<h5>Methods</h5>
<dl>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_action_row" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_action_row" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_action_row" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_action_row">deserialize_action_row</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../messages.html#hikari.messages.ActionRowComponent'>ActionRowComponent</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_action_row -- Parse a raw payload from Discord into an action row component object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_action_row"
>deserialize_action_row</a></code>
</p>
<p>Parse a raw payload from Discord into an action row component object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../messages.html#hikari.messages.ActionRowComponent'>ActionRowComponent</a></code></dt>
<dd>The deserialized action row component.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1990-L2002" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_action_row(self, payload: data_binding.JSONObject) -&gt; message_models.ActionRowComponent:
    components: typing.List[message_models.PartialComponent] = []

    for component_payload in payload[&#34;components&#34;]:
        try:
            components.append(self.deserialize_component(component_payload))

        except errors.UnrecognisedEntityError:
            pass

    return message_models.ActionRowComponent(
        type=message_models.ComponentType(payload[&#34;type&#34;]), components=components
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_application" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application">deserialize_application</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../applications.html#hikari.applications.Application'>Application</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_application -- Parse a raw payload from Discord into an application object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_application"
>deserialize_application</a></code>
</p>
<p>Parse a raw payload from Discord into an application object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../applications.html#hikari.applications.Application'>Application</a></code></dt>
<dd>The deserialized application object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L314-L356" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_application(self, payload: data_binding.JSONObject) -&gt; application_models.Application:
    team: typing.Optional[application_models.Team] = None
    if (team_payload := payload.get(&#34;team&#34;)) is not None:
        members = {}
        for member_payload in team_payload[&#34;members&#34;]:
            team_member = application_models.TeamMember(
                membership_state=application_models.TeamMembershipState(member_payload[&#34;membership_state&#34;]),
                permissions=member_payload[&#34;permissions&#34;],
                team_id=snowflakes.Snowflake(member_payload[&#34;team_id&#34;]),
                user=self.deserialize_user(member_payload[&#34;user&#34;]),
            )
            members[team_member.user.id] = team_member

        team = application_models.Team(
            app=self._app,
            id=snowflakes.Snowflake(team_payload[&#34;id&#34;]),
            name=team_payload[&#34;name&#34;],
            icon_hash=team_payload[&#34;icon&#34;],
            members=members,
            owner_id=snowflakes.Snowflake(team_payload[&#34;owner_user_id&#34;]),
        )

    primary_sku_id = snowflakes.Snowflake(payload[&#34;primary_sku_id&#34;]) if &#34;primary_sku_id&#34; in payload else None
    return application_models.Application(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        description=payload[&#34;description&#34;] or None,
        is_bot_public=payload[&#34;bot_public&#34;],
        is_bot_code_grant_required=payload[&#34;bot_require_code_grant&#34;],
        owner=self.deserialize_user(payload[&#34;owner&#34;]),
        rpc_origins=payload.get(&#34;rpc_origins&#34;),
        summary=payload[&#34;summary&#34;] or None,
        public_key=bytes.fromhex(payload[&#34;verify_key&#34;]),
        icon_hash=payload.get(&#34;icon&#34;),
        team=team,
        guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]) if &#34;guild_id&#34; in payload else None,
        primary_sku_id=primary_sku_id,
        slug=payload.get(&#34;slug&#34;),
        cover_image_hash=payload.get(&#34;cover_image&#34;),
        privacy_policy_url=payload.get(&#34;privacy_policy_url&#34;),
        terms_of_service_url=payload.get(&#34;terms_of_service_url&#34;),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application_webhook" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_application_webhook" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application_webhook" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_application_webhook">deserialize_application_webhook</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../webhooks.html#hikari.webhooks.ApplicationWebhook'>ApplicationWebhook</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_application_webhook -- Parse a raw payload from Discord into an application webhook object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_application_webhook"
>deserialize_application_webhook</a></code>
</p>
<p>Parse a raw payload from Discord into an application webhook object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../webhooks.html#hikari.webhooks.ApplicationWebhook'>ApplicationWebhook</a></code></dt>
<dd>The parsed application webhook object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2728-L2736" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_application_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.ApplicationWebhook:
    return webhook_models.ApplicationWebhook(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        type=webhook_models.WebhookType(payload[&#34;type&#34;]),
        name=payload[&#34;name&#34;],
        avatar_hash=payload[&#34;avatar&#34;],
        application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_audit_log" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_audit_log" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_audit_log" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_audit_log">deserialize_audit_log</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../audit_logs.html#hikari.audit_logs.AuditLog'>AuditLog</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_audit_log -- Parse a raw payload from Discord into an audit log object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_audit_log"
>deserialize_audit_log</a></code>
</p>
<p>Parse a raw payload from Discord into an audit log object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../audit_logs.html#hikari.audit_logs.AuditLog'>AuditLog</a></code></dt>
<dd>The deserialized audit log object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L488-L558" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_audit_log(self, payload: data_binding.JSONObject) -&gt; audit_log_models.AuditLog:
    entries = {}
    for entry_payload in payload[&#34;audit_log_entries&#34;]:
        entry_id = snowflakes.Snowflake(entry_payload[&#34;id&#34;])

        changes = []
        if (change_payloads := entry_payload.get(&#34;changes&#34;)) is not None:
            for change_payload in change_payloads:
                key: typing.Union[audit_log_models.AuditLogChangeKey, str] = audit_log_models.AuditLogChangeKey(
                    change_payload[&#34;key&#34;]
                )

                new_value = change_payload.get(&#34;new_value&#34;)
                old_value = change_payload.get(&#34;old_value&#34;)
                if value_converter := self._audit_log_entry_converters.get(key):
                    new_value = value_converter(new_value) if new_value is not None else None
                    old_value = value_converter(old_value) if old_value is not None else None

                elif not isinstance(key, audit_log_models.AuditLogChangeKey):
                    _LOGGER.debug(&#34;Unknown audit log change key found %r&#34;, key)

                changes.append(audit_log_models.AuditLogChange(key=key, new_value=new_value, old_value=old_value))

        target_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_target_id := entry_payload[&#34;target_id&#34;]) is not None:
            target_id = snowflakes.Snowflake(raw_target_id)

        user_id: typing.Optional[snowflakes.Snowflake] = None
        if (raw_user_id := entry_payload[&#34;user_id&#34;]) is not None:
            user_id = snowflakes.Snowflake(raw_user_id)

        action_type: typing.Union[audit_log_models.AuditLogEventType, int]
        action_type = audit_log_models.AuditLogEventType(entry_payload[&#34;action_type&#34;])

        options: typing.Optional[audit_log_models.BaseAuditLogEntryInfo] = None
        if (raw_option := entry_payload.get(&#34;options&#34;)) is not None:
            if option_converter := self._audit_log_event_mapping.get(action_type):
                options = option_converter(raw_option)

            else:
                _LOGGER.debug(&#34;Unknown audit log action type found %r&#34;, action_type)
                continue

        entries[entry_id] = audit_log_models.AuditLogEntry(
            app=self._app,
            id=entry_id,
            target_id=target_id,
            changes=changes,
            user_id=user_id,
            action_type=action_type,
            options=options,
            reason=entry_payload.get(&#34;reason&#34;),
        )

    integrations = {
        snowflakes.Snowflake(integration[&#34;id&#34;]): self.deserialize_partial_integration(integration)
        for integration in payload[&#34;integrations&#34;]
    }
    users = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;users&#34;]}

    webhooks: typing.Dict[snowflakes.Snowflake, webhook_models.PartialWebhook] = {}
    for webhook_payload in payload[&#34;webhooks&#34;]:
        try:
            webhook = self.deserialize_webhook(webhook_payload)

        except errors.UnrecognisedEntityError:
            continue

        webhooks[webhook.id] = webhook

    return audit_log_models.AuditLog(entries=entries, integrations=integrations, users=users, webhooks=webhooks)</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_authorization_information" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_authorization_information" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_authorization_information" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_authorization_information">deserialize_authorization_information</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../applications.html#hikari.applications.AuthorizationInformation'>AuthorizationInformation</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_authorization_information -- Parse a raw payload from Discord into an authorization information object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_authorization_information"
>deserialize_authorization_information</a></code>
</p>
<p>Parse a raw payload from Discord into an authorization information object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../applications.html#hikari.applications.AuthorizationInformation'>AuthorizationInformation</a></code></dt>
<dd>The deserialized authorization information object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L358-L380" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_authorization_information(
    self, payload: data_binding.JSONObject
) -&gt; application_models.AuthorizationInformation:
    application_payload = payload[&#34;application&#34;]
    application = application_models.AuthorizationApplication(
        id=snowflakes.Snowflake(application_payload[&#34;id&#34;]),
        name=application_payload[&#34;name&#34;],
        description=application_payload[&#34;description&#34;] or None,
        icon_hash=application_payload.get(&#34;icon&#34;),
        summary=application_payload[&#34;summary&#34;] or None,
        is_bot_public=application_payload.get(&#34;bot_public&#34;),
        is_bot_code_grant_required=application_payload.get(&#34;bot_require_code_grant&#34;),
        public_key=bytes.fromhex(application_payload[&#34;verify_key&#34;]),
        terms_of_service_url=application_payload.get(&#34;terms_of_service_url&#34;),
        privacy_policy_url=application_payload.get(&#34;privacy_policy_url&#34;),
    )

    return application_models.AuthorizationInformation(
        application=application,
        scopes=[application_models.OAuth2Scope(scope) for scope in payload[&#34;scopes&#34;]],
        expires_at=time.iso8601_datetime_string_to_datetime(payload[&#34;expires&#34;]),
        user=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_authorization_token" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_authorization_token" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_authorization_token" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_authorization_token">deserialize_authorization_token</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../applications.html#hikari.applications.OAuth2AuthorizationToken'>OAuth2AuthorizationToken</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_authorization_token -- Parse a raw payload from Discord into an authorization token object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_authorization_token"
>deserialize_authorization_token</a></code>
</p>
<p>Parse a raw payload from Discord into an authorization token object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../applications.html#hikari.applications.OAuth2AuthorizationToken'>OAuth2AuthorizationToken</a></code></dt>
<dd>The deserialized OAuth2 authorization token object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L390-L401" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_authorization_token(
    self, payload: data_binding.JSONObject
) -&gt; application_models.OAuth2AuthorizationToken:
    return application_models.OAuth2AuthorizationToken(
        access_token=payload[&#34;access_token&#34;],
        token_type=application_models.TokenType(payload[&#34;token_type&#34;]),
        expires_in=datetime.timedelta(seconds=int(payload[&#34;expires_in&#34;])),
        scopes=[application_models.OAuth2Scope(scope) for scope in payload[&#34;scope&#34;].split(&#34; &#34;)],
        refresh_token=payload[&#34;refresh_token&#34;],
        webhook=self.deserialize_incoming_webhook(payload[&#34;webhook&#34;]) if &#34;webhook&#34; in payload else None,
        guild=self.deserialize_rest_guild(payload[&#34;guild&#34;]) if &#34;guild&#34; in payload else None,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_button" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_button" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_button" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_button">deserialize_button</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../messages.html#hikari.messages.ButtonComponent'>ButtonComponent</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_button -- Parse a raw payload from Discord into a button component object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_button"
>deserialize_button</a></code>
</p>
<p>Parse a raw payload from Discord into a button component object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../messages.html#hikari.messages.ButtonComponent'>ButtonComponent</a></code></dt>
<dd>The deserialized button component.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2004-L2014" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_button(self, payload: data_binding.JSONObject) -&gt; message_models.ButtonComponent:
    emoji_payload = payload.get(&#34;emoji&#34;)
    return message_models.ButtonComponent(
        type=message_models.ComponentType(payload[&#34;type&#34;]),
        style=message_models.ButtonStyle(payload[&#34;style&#34;]),
        label=payload.get(&#34;label&#34;),
        emoji=self.deserialize_emoji(emoji_payload) if emoji_payload else None,
        custom_id=payload.get(&#34;custom_id&#34;),
        url=payload.get(&#34;url&#34;),
        is_disabled=payload.get(&#34;disabled&#34;, False),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel">deserialize_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.PartialChannel'>PartialChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_channel -- Parse a raw payload from Discord into a channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_channel"
>deserialize_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this channel belongs to. This will be ignored
for DM and group DM channels and will be prioritised over
<code>"guild_id"</code> in the payload when passed.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is not included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.PartialChannel'>PartialChannel</a></code></dt>
<dd>The deserialized partial channel-derived object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload of a guild
channel.</dd>
<dt><code><a href='../errors.html#hikari.errors.UnrecognisedEntityError'>UnrecognisedEntityError</a></code></dt>
<dd>If the channel type is unknown.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L820-L834" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.PartialChannel:
    channel_type = channel_models.ChannelType(payload[&#34;type&#34;])
    if guild_channel_model := self._guild_channel_type_mapping.get(channel_type):
        return guild_channel_model(payload, guild_id=guild_id)

    if dm_channel_model := self._dm_channel_type_mapping.get(channel_type):
        return dm_channel_model(payload)

    _LOGGER.debug(f&#34;Unrecognised channel type {channel_type}&#34;)
    raise errors.UnrecognisedEntityError(f&#34;Unrecognised channel type {channel_type}&#34;)</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follow" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_channel_follow" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follow" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follow">deserialize_channel_follow</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../channels.html#hikari.channels.ChannelFollow'>ChannelFollow</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_channel_follow -- Parse a raw payload from Discord into a channel follow object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_channel_follow"
>deserialize_channel_follow</a></code>
</p>
<p>Parse a raw payload from Discord into a channel follow object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.ChannelFollow'>ChannelFollow</a></code></dt>
<dd>The deserialized channel follow object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L564-L569" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_channel_follow(self, payload: data_binding.JSONObject) -&gt; channel_models.ChannelFollow:
    return channel_models.ChannelFollow(
        app=self._app,
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follower_webhook" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_channel_follower_webhook" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follower_webhook" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_channel_follower_webhook">deserialize_channel_follower_webhook</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../webhooks.html#hikari.webhooks.ChannelFollowerWebhook'>ChannelFollowerWebhook</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_channel_follower_webhook -- Parse a raw payload from Discord into a channel follower webhook object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_channel_follower_webhook"
>deserialize_channel_follower_webhook</a></code>
</p>
<p>Parse a raw payload from Discord into a channel follower webhook object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../webhooks.html#hikari.webhooks.ChannelFollowerWebhook'>ChannelFollowerWebhook</a></code></dt>
<dd>The parsed channel follower webhook object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2694-L2726" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_channel_follower_webhook(
    self, payload: data_binding.JSONObject
) -&gt; webhook_models.ChannelFollowerWebhook:
    application_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_application_id := payload.get(&#34;application_id&#34;)) is not None:
        application_id = snowflakes.Snowflake(raw_application_id)

    raw_source_channel = payload[&#34;source_channel&#34;]
    # In this case the channel type isn&#39;t provided as we can safely
    # assume it&#39;s a news channel.
    raw_source_channel[&#34;type&#34;] = channel_models.ChannelType.GUILD_NEWS
    source_channel = self.deserialize_partial_channel(raw_source_channel)
    source_guild_payload = payload[&#34;source_guild&#34;]
    source_guild = guild_models.PartialGuild(
        app=self._app,
        id=snowflakes.Snowflake(source_guild_payload[&#34;id&#34;]),
        name=source_guild_payload[&#34;name&#34;],
        icon_hash=source_guild_payload.get(&#34;icon&#34;),
    )

    return webhook_models.ChannelFollowerWebhook(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        type=webhook_models.WebhookType(payload[&#34;type&#34;]),
        guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        author=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
        name=payload[&#34;name&#34;],
        avatar_hash=payload[&#34;avatar&#34;],
        application_id=application_id,
        source_channel=source_channel,
        source_guild=source_guild,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_command" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_command" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_command" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_command">deserialize_command</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedNoneOr'>undefined.UndefinedNoneOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../commands.html#hikari.commands.Command'>Command</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_command -- Parse a raw payload from Discord into a command object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_command"
>deserialize_command</a></code>
</p>
<p>Parse a raw payload from Discord into a command object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedNoneOr'>UndefinedNoneOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this command belongs to. If this is specified
then this will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../commands.html#hikari.commands.Command'>Command</a></code></dt>
<dd>The deserialized command object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload for the payload of
the integration.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1681-L1705" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_command(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedNoneOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; commands.Command:
    if guild_id is undefined.UNDEFINED:
        raw_guild_id = payload[&#34;guild_id&#34;]
        guild_id = snowflakes.Snowflake(raw_guild_id) if raw_guild_id is not None else None

    options: typing.Optional[typing.List[commands.CommandOption]] = None
    if raw_options := payload.get(&#34;options&#34;):
        options = [self._deserialize_command_option(option) for option in raw_options]

    return commands.Command(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
        name=payload[&#34;name&#34;],
        description=payload[&#34;description&#34;],
        options=options,
        default_permission=payload.get(&#34;default_permission&#34;, True),
        guild_id=guild_id,
        version=snowflakes.Snowflake(payload[&#34;version&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_command_interaction" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_command_interaction" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_command_interaction" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_command_interaction">deserialize_command_interaction</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../interactions/command_interactions.html#hikari.interactions.command_interactions.CommandInteraction'>CommandInteraction</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_command_interaction -- Parse a raw payload from Discord into a command interaction object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_command_interaction"
>deserialize_command_interaction</a></code>
</p>
<p>Parse a raw payload from Discord into a command interaction object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../interactions/command_interactions.html#hikari.interactions.command_interactions.CommandInteraction'>CommandInteraction</a></code></dt>
<dd>The deserialized command interaction object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1790-L1873" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_command_interaction(
    self, payload: data_binding.JSONObject
) -&gt; command_interactions.CommandInteraction:
    data_payload = payload[&#34;data&#34;]

    guild_id: typing.Optional[snowflakes.Snowflake] = None
    if raw_guild_id := payload.get(&#34;guild_id&#34;):
        guild_id = snowflakes.Snowflake(raw_guild_id)

    options: typing.Optional[typing.List[command_interactions.CommandInteractionOption]] = None
    if raw_options := data_payload.get(&#34;options&#34;):
        options = [self._deserialize_interaction_command_option(option) for option in raw_options]

    member: typing.Optional[base_interactions.InteractionMember]
    if member_payload := payload.get(&#34;member&#34;):
        assert guild_id is not None
        member = self._deserialize_interaction_member(member_payload, guild_id=guild_id)
        # See https://github.com/discord/discord-api-docs/pull/2568
        user = member.user

    else:
        member = None
        user = self.deserialize_user(payload[&#34;user&#34;])

    resolved: typing.Optional[command_interactions.ResolvedOptionData] = None
    if resolved_payload := data_payload.get(&#34;resolved&#34;):
        channels: typing.Dict[snowflakes.Snowflake, command_interactions.InteractionChannel] = {}
        if raw_channels := resolved_payload.get(&#34;channels&#34;):
            for channel_payload in raw_channels.values():
                channel_id = snowflakes.Snowflake(channel_payload[&#34;id&#34;])
                channels[channel_id] = command_interactions.InteractionChannel(
                    app=self._app,
                    id=channel_id,
                    type=channel_models.ChannelType(channel_payload[&#34;type&#34;]),
                    name=channel_payload[&#34;name&#34;],
                    permissions=permission_models.Permissions(int(channel_payload[&#34;permissions&#34;])),
                )

        if raw_users := resolved_payload.get(&#34;users&#34;):
            users = {u.id: u for u in map(self.deserialize_user, raw_users.values())}

        else:
            users = {}

        members: typing.Dict[snowflakes.Snowflake, base_interactions.InteractionMember] = {}
        if raw_members := resolved_payload.get(&#34;members&#34;):
            for user_id, member_payload in raw_members.items():
                assert guild_id is not None
                user_id = snowflakes.Snowflake(user_id)
                members[user_id] = self._deserialize_interaction_member(
                    member_payload, user=users[user_id], guild_id=guild_id
                )

        if raw_roles := resolved_payload.get(&#34;roles&#34;):
            assert guild_id is not None
            roles_iter = (self.deserialize_role(role, guild_id=guild_id) for role in raw_roles.values())
            roles = {r.id: r for r in roles_iter}

        else:
            roles = {}

        resolved = command_interactions.ResolvedOptionData(
            channels=channels,
            members=members,
            users=users,
            roles=roles,
        )

    return command_interactions.CommandInteraction(
        app=self._app,
        application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        type=base_interactions.InteractionType(payload[&#34;type&#34;]),
        guild_id=guild_id,
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        member=member,
        user=user,
        token=payload[&#34;token&#34;],
        version=payload[&#34;version&#34;],
        command_id=snowflakes.Snowflake(data_payload[&#34;id&#34;]),
        command_name=data_payload[&#34;name&#34;],
        options=options,
        resolved=resolved,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_component" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_component" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_component" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_component">deserialize_component</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../messages.html#hikari.messages.PartialComponent'>PartialComponent</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_component -- Parse a raw payload from Discord into a message component object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_component"
>deserialize_component</a></code>
</p>
<p>Parse a raw payload from Discord into a message component object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../messages.html#hikari.messages.PartialComponent'>PartialComponent</a></code></dt>
<dd>The deserialized message component.</dd>
<dt><code><a href='../errors.html#hikari.errors.UnrecognisedEntityError'>UnrecognisedEntityError</a></code></dt>
<dd>If the message component type isn't recognised.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2043-L2050" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_component(self, payload: data_binding.JSONObject) -&gt; message_models.PartialComponent:
    component_type = message_models.ComponentType(payload[&#34;type&#34;])

    if deserialize := self._component_type_mapping.get(component_type):
        return deserialize(payload)

    _LOGGER.debug(&#34;Unknown component type %s&#34;, component_type)
    raise errors.UnrecognisedEntityError(f&#34;Unrecognised component type {component_type}&#34;)</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_component_interaction" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_component_interaction" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_component_interaction" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_component_interaction">deserialize_component_interaction</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../interactions/component_interactions.html#hikari.interactions.component_interactions.ComponentInteraction'>ComponentInteraction</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_component_interaction -- Parser a raw payload from Discord into a component interaction object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_component_interaction"
>deserialize_component_interaction</a></code>
</p>
<p>Parser a raw payload from Discord into a component interaction object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../interactions/component_interactions.html#hikari.interactions.component_interactions.ComponentInteraction'>ComponentInteraction</a></code></dt>
<dd>The deserialized component interaction.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1900-L1935" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_component_interaction(
    self, payload: data_binding.JSONObject
) -&gt; component_interactions.ComponentInteraction:
    data_payload = payload[&#34;data&#34;]

    guild_id = None
    if raw_guild_id := payload.get(&#34;guild_id&#34;):
        guild_id = snowflakes.Snowflake(raw_guild_id)

    member: typing.Optional[base_interactions.InteractionMember]
    if member_payload := payload.get(&#34;member&#34;):
        assert guild_id is not None
        member = self._deserialize_interaction_member(member_payload, guild_id=guild_id)
        # See https://github.com/discord/discord-api-docs/pull/2568
        user = member.user

    else:
        member = None
        user = self.deserialize_user(payload[&#34;user&#34;])

    return component_interactions.ComponentInteraction(
        app=self._app,
        application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        type=base_interactions.InteractionType(payload[&#34;type&#34;]),
        guild_id=guild_id,
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        member=member,
        user=user,
        token=payload[&#34;token&#34;],
        values=data_payload.get(&#34;values&#34;) or (),
        version=payload[&#34;version&#34;],
        custom_id=data_payload[&#34;custom_id&#34;],
        component_type=message_models.ComponentType(data_payload[&#34;component_type&#34;]),
        message=self.deserialize_message(payload[&#34;message&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_custom_emoji" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_custom_emoji" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_custom_emoji" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_custom_emoji">deserialize_custom_emoji</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../emojis.html#hikari.emojis.CustomEmoji'>CustomEmoji</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_custom_emoji -- Parse a raw payload from Discord into a custom emoji object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_custom_emoji"
>deserialize_custom_emoji</a></code>
</p>
<p>Parse a raw payload from Discord into a custom emoji object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../emojis.html#hikari.emojis.CustomEmoji'>CustomEmoji</a></code></dt>
<dd>The deserialized custom emoji object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1048-L1053" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_custom_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.CustomEmoji:
    return emoji_models.CustomEmoji(
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        is_animated=payload.get(&#34;animated&#34;, False),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_dm" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_dm" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_dm" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_dm">deserialize_dm</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../channels.html#hikari.channels.DMChannel'>DMChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_dm -- Parse a raw payload from Discord into a DM channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_dm"
>deserialize_dm</a></code>
</p>
<p>Parse a raw payload from Discord into a DM channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.DMChannel'>DMChannel</a></code></dt>
<dd>The deserialized DM channel object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L599-L611" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.DMChannel:
    last_message_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
        last_message_id = snowflakes.Snowflake(raw_last_message_id)

    return channel_models.DMChannel(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload.get(&#34;name&#34;),
        type=channel_models.ChannelType(payload[&#34;type&#34;]),
        last_message_id=last_message_id,
        recipient=self.deserialize_user(payload[&#34;recipients&#34;][0]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_embed" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_embed" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_embed" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_embed">deserialize_embed</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../embeds.html#hikari.embeds.Embed'>Embed</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_embed -- Parse a raw payload from Discord into an embed object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_embed"
>deserialize_embed</a></code>
</p>
<p>Parse a raw payload from Discord into an embed object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../embeds.html#hikari.embeds.Embed'>Embed</a></code></dt>
<dd>The deserialized embed object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L840-L935" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_embed(self, payload: data_binding.JSONObject) -&gt; embed_models.Embed:
    # Keep these separate to aid debugging later.
    title = payload.get(&#34;title&#34;)
    description = payload.get(&#34;description&#34;)
    url = payload.get(&#34;url&#34;)
    color = color_models.Color(payload[&#34;color&#34;]) if &#34;color&#34; in payload else None
    timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]) if &#34;timestamp&#34; in payload else None
    fields: typing.Optional[typing.List[embed_models.EmbedField]] = None

    image: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
    if (image_payload := payload.get(&#34;image&#34;)) and &#34;url&#34; in image_payload:
        proxy = files.ensure_resource(image_payload[&#34;proxy_url&#34;]) if &#34;proxy_url&#34; in image_payload else None
        image = embed_models.EmbedImage(
            resource=files.ensure_resource(image_payload[&#34;url&#34;]),
            proxy_resource=proxy,
            height=image_payload.get(&#34;height&#34;),
            width=image_payload.get(&#34;width&#34;),
        )

    thumbnail: typing.Optional[embed_models.EmbedImage[files.AsyncReader]] = None
    if (thumbnail_payload := payload.get(&#34;thumbnail&#34;)) and &#34;url&#34; in thumbnail_payload:
        proxy = files.ensure_resource(thumbnail_payload[&#34;proxy_url&#34;]) if &#34;proxy_url&#34; in thumbnail_payload else None
        thumbnail = embed_models.EmbedImage(
            resource=files.ensure_resource(thumbnail_payload[&#34;url&#34;]),
            proxy_resource=proxy,
            height=thumbnail_payload.get(&#34;height&#34;),
            width=thumbnail_payload.get(&#34;width&#34;),
        )

    video: typing.Optional[embed_models.EmbedVideo[files.AsyncReader]] = None
    if (video_payload := payload.get(&#34;video&#34;)) and &#34;url&#34; in video_payload:
        raw_proxy_url = video_payload.get(&#34;proxy_url&#34;)
        video = embed_models.EmbedVideo(
            resource=files.ensure_resource(video_payload[&#34;url&#34;]),
            proxy_resource=files.ensure_resource(raw_proxy_url) if raw_proxy_url else None,
            height=video_payload.get(&#34;height&#34;),
            width=video_payload.get(&#34;width&#34;),
        )

    provider: typing.Optional[embed_models.EmbedProvider] = None
    if provider_payload := payload.get(&#34;provider&#34;):
        provider = embed_models.EmbedProvider(name=provider_payload.get(&#34;name&#34;), url=provider_payload.get(&#34;url&#34;))

    icon: typing.Optional[embed_models.EmbedResourceWithProxy[files.AsyncReader]]
    author: typing.Optional[embed_models.EmbedAuthor] = None
    if author_payload := payload.get(&#34;author&#34;):
        icon = None
        if &#34;icon_url&#34; in author_payload:
            raw_proxy_url = author_payload.get(&#34;proxy_icon_url&#34;)
            icon = embed_models.EmbedResourceWithProxy(
                resource=files.ensure_resource(author_payload[&#34;icon_url&#34;]),
                proxy_resource=files.ensure_resource(raw_proxy_url) if raw_proxy_url else None,
            )

        author = embed_models.EmbedAuthor(
            name=author_payload.get(&#34;name&#34;),
            url=author_payload.get(&#34;url&#34;),
            icon=icon,
        )

    footer: typing.Optional[embed_models.EmbedFooter] = None
    if footer_payload := payload.get(&#34;footer&#34;):
        icon = None
        if &#34;icon_url&#34; in footer_payload:
            raw_proxy_url = footer_payload.get(&#34;proxy_icon_url&#34;)
            icon = embed_models.EmbedResourceWithProxy(
                resource=files.ensure_resource(footer_payload[&#34;icon_url&#34;]),
                proxy_resource=files.ensure_resource(raw_proxy_url) if raw_proxy_url else None,
            )

        footer = embed_models.EmbedFooter(text=footer_payload.get(&#34;text&#34;), icon=icon)

    if fields_array := payload.get(&#34;fields&#34;):
        fields = []
        for field_payload in fields_array:
            field = embed_models.EmbedField(
                name=field_payload[&#34;name&#34;],
                value=field_payload[&#34;value&#34;],
                inline=field_payload.get(&#34;inline&#34;, False),
            )
            fields.append(field)

    return embed_models.Embed.from_received_embed(
        title=title,
        description=description,
        url=url,
        color=color,
        timestamp=timestamp,
        image=image,
        thumbnail=thumbnail,
        video=video,
        provider=provider,
        author=author,
        footer=footer,
        fields=fields,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_emoji" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_emoji" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_emoji" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_emoji">deserialize_emoji</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> Union[<a href='../emojis.html#hikari.emojis.UnicodeEmoji'>UnicodeEmoji</a>, <a href='../emojis.html#hikari.emojis.CustomEmoji'>CustomEmoji</a>]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_emoji -- Parse a raw payload from Discord into an emoji object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_emoji"
>deserialize_emoji</a></code>
</p>
<p>Parse a raw payload from Discord into an emoji object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../emojis.html#hikari.emojis.UnicodeEmoji'>UnicodeEmoji</a></code> or <code><a href='../emojis.html#hikari.emojis.CustomEmoji'>CustomEmoji</a></code></dt>
<dd>The deserialized custom or unicode emoji object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1077-L1083" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_emoji(
    self, payload: data_binding.JSONObject
) -&gt; typing.Union[emoji_models.UnicodeEmoji, emoji_models.CustomEmoji]:
    if payload.get(&#34;id&#34;) is not None:
        return self.deserialize_custom_emoji(payload)

    return self.deserialize_unicode_emoji(payload)</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_bot_info" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_gateway_bot_info" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_bot_info" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_bot_info">deserialize_gateway_bot_info</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../sessions.html#hikari.sessions.GatewayBotInfo'>GatewayBotInfo</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_gateway_bot_info -- Parse a raw payload from Discord into a gateway bot object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_gateway_bot_info"
>deserialize_gateway_bot_info</a></code>
</p>
<p>Parse a raw payload from Discord into a gateway bot object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../sessions.html#hikari.sessions.GatewayBotInfo'>GatewayBotInfo</a></code></dt>
<dd>The deserialized gateway bot information object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1089-L1103" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_gateway_bot_info(self, payload: data_binding.JSONObject) -&gt; gateway_models.GatewayBotInfo:
    session_start_limit_payload = payload[&#34;session_start_limit&#34;]
    session_start_limit = gateway_models.SessionStartLimit(
        total=int(session_start_limit_payload[&#34;total&#34;]),
        remaining=int(session_start_limit_payload[&#34;remaining&#34;]),
        reset_after=datetime.timedelta(milliseconds=session_start_limit_payload[&#34;reset_after&#34;]),
        # I do not trust that this may never be zero for some unknown reason. If it was 0, it
        # would hang the application on start up, so I enforce it is at least 1.
        max_concurrency=max(session_start_limit_payload.get(&#34;max_concurrency&#34;, 0), 1),
    )
    return gateway_models.GatewayBotInfo(
        url=payload[&#34;url&#34;],
        shard_count=int(payload[&#34;shards&#34;]),
        session_start_limit=session_start_limit,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_guild" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_gateway_guild" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_guild" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_gateway_guild">deserialize_gateway_guild</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../api/entity_factory.html#hikari.api.entity_factory.GatewayGuildDefinition'>GatewayGuildDefinition</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_gateway_guild -- Parse a raw payload from Discord into a guild object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_gateway_guild"
>deserialize_gateway_guild</a></code>
</p>
<p>Parse a raw payload from Discord into a guild object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>GatewayGuildDefinition</code></dt>
<dd>The deserialized guild object and the internal collections as
maps of <code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code> mapping to
<code><a href='../channels.html#hikari.channels.GuildChannel'>GuildChannel</a></code>,
<code><a href='../guilds.html#hikari.guilds.Member'>Member</a></code>,
<code><a href='../presences.html#hikari.presences.MemberPresence'>MemberPresence</a></code>,
<code><a href='../guilds.html#hikari.guilds.Role'>Role</a></code>, and
<code><a href='../emojis.html#hikari.emojis.KnownCustomEmoji'>KnownCustomEmoji</a></code>. This is provided in
several components to allow separate caching and linking
between entities in various relational cache implementations
internally.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1440-L1530" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_gateway_guild(self, payload: data_binding.JSONObject) -&gt; entity_factory.GatewayGuildDefinition:
    guild_fields = self._set_guild_attributes(payload)
    is_large = payload.get(&#34;large&#34;)
    joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;]) if &#34;joined_at&#34; in payload else None
    member_count = int(payload[&#34;member_count&#34;]) if &#34;member_count&#34; in payload else None

    guild = guild_models.GatewayGuild(
        app=self._app,
        id=guild_fields.id,
        name=guild_fields.name,
        icon_hash=guild_fields.icon_hash,
        features=guild_fields.features,
        splash_hash=guild_fields.splash_hash,
        discovery_splash_hash=guild_fields.discovery_splash_hash,
        owner_id=guild_fields.owner_id,
        afk_channel_id=guild_fields.afk_channel_id,
        afk_timeout=guild_fields.afk_timeout,
        verification_level=guild_fields.verification_level,
        default_message_notifications=guild_fields.default_message_notifications,
        explicit_content_filter=guild_fields.explicit_content_filter,
        mfa_level=guild_fields.mfa_level,
        application_id=guild_fields.application_id,
        widget_channel_id=guild_fields.widget_channel_id,
        system_channel_id=guild_fields.system_channel_id,
        is_widget_enabled=guild_fields.is_widget_enabled,
        system_channel_flags=guild_fields.system_channel_flags,
        rules_channel_id=guild_fields.rules_channel_id,
        max_video_channel_users=guild_fields.max_video_channel_users,
        vanity_url_code=guild_fields.vanity_url_code,
        description=guild_fields.description,
        banner_hash=guild_fields.banner_hash,
        premium_tier=guild_fields.premium_tier,
        premium_subscription_count=guild_fields.premium_subscription_count,
        preferred_locale=guild_fields.preferred_locale,
        public_updates_channel_id=guild_fields.public_updates_channel_id,
        nsfw_level=guild_fields.nsfw_level,
        is_large=is_large,
        joined_at=joined_at,
        member_count=member_count,
    )

    members: typing.Optional[typing.Dict[snowflakes.Snowflake, guild_models.Member]] = None
    if &#34;members&#34; in payload:
        members = {}

        for member_payload in payload[&#34;members&#34;]:
            member = self.deserialize_member(member_payload, guild_id=guild.id)
            members[member.user.id] = member

    channels: typing.Optional[typing.Dict[snowflakes.Snowflake, channel_models.GuildChannel]] = None
    if &#34;channels&#34; in payload:
        channels = {}

        for channel_payload in payload[&#34;channels&#34;]:
            try:
                channel = self.deserialize_channel(channel_payload, guild_id=guild.id)
            except errors.UnrecognisedEntityError:
                # Ignore the channel, this has already been logged
                continue

            assert isinstance(channel, channel_models.GuildChannel)
            channels[channel.id] = channel

    presences: typing.Optional[typing.Dict[snowflakes.Snowflake, presence_models.MemberPresence]] = None
    if &#34;presences&#34; in payload:
        presences = {}

        for presence_payload in payload[&#34;presences&#34;]:
            presence = self.deserialize_member_presence(presence_payload, guild_id=guild.id)
            presences[presence.user_id] = presence

    voice_states: typing.Optional[typing.Dict[snowflakes.Snowflake, voice_models.VoiceState]] = None
    if &#34;voice_states&#34; in payload:
        voice_states = {}
        assert members is not None

        for voice_state_payload in payload[&#34;voice_states&#34;]:
            member = members[snowflakes.Snowflake(voice_state_payload[&#34;user_id&#34;])]
            voice_state = self.deserialize_voice_state(voice_state_payload, guild_id=guild.id, member=member)
            voice_states[voice_state.user_id] = voice_state

    roles = {
        snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild.id)
        for role in payload[&#34;roles&#34;]
    }
    emojis = {
        snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild.id)
        for emoji in payload[&#34;emojis&#34;]
    }

    return entity_factory.GatewayGuildDefinition(guild, channels, members, presences, roles, emojis, voice_states)</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_group_dm" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_group_dm" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_group_dm" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_group_dm">deserialize_group_dm</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../channels.html#hikari.channels.GroupDMChannel'>GroupDMChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_group_dm -- Parse a raw payload from Discord into a group DM channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_group_dm"
>deserialize_group_dm</a></code>
</p>
<p>Parse a raw payload from Discord into a group DM channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GroupDMChannel'>GroupDMChannel</a></code></dt>
<dd>The deserialized group DM object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L613-L636" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_group_dm(self, payload: data_binding.JSONObject) -&gt; channel_models.GroupDMChannel:
    last_message_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
        last_message_id = snowflakes.Snowflake(raw_last_message_id)

    if (raw_nicks := payload.get(&#34;nicks&#34;)) is not None:
        nicknames = {snowflakes.Snowflake(entry[&#34;id&#34;]): entry[&#34;nick&#34;] for entry in raw_nicks}
    else:
        nicknames = {}

    recipients = {snowflakes.Snowflake(user[&#34;id&#34;]): self.deserialize_user(user) for user in payload[&#34;recipients&#34;]}

    return channel_models.GroupDMChannel(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload.get(&#34;name&#34;),
        type=channel_models.ChannelType(payload[&#34;type&#34;]),
        last_message_id=last_message_id,
        owner_id=snowflakes.Snowflake(payload[&#34;owner_id&#34;]),
        icon_hash=payload[&#34;icon&#34;],
        nicknames=nicknames,
        application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]) if &#34;application_id&#34; in payload else None,
        recipients=recipients,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_category" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_category" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_category" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_category">deserialize_guild_category</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildCategory'>GuildCategory</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_category -- Parse a raw payload from Discord into a guild category object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_category"
>deserialize_guild_category</a></code>
</p>
<p>Parse a raw payload from Discord into a guild category object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is not included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildCategory'>GuildCategory</a></code></dt>
<dd>The deserialized guild category object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L667-L684" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_category(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildCategory:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
    return channel_models.GuildCategory(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_command_permissions" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_command_permissions" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_command_permissions" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_command_permissions">deserialize_guild_command_permissions</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../commands.html#hikari.commands.GuildCommandPermissions'>GuildCommandPermissions</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_command_permissions -- Parse a raw payload from Discord into guild command permissions object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_command_permissions"
>deserialize_guild_command_permissions</a></code>
</p>
<p>Parse a raw payload from Discord into guild command permissions object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../commands.html#hikari.commands.GuildCommandPermissions'>GuildCommandPermissions</a></code></dt>
<dd>The deserialized guild command permissions object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1707-L1723" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_command_permissions(
    self, payload: data_binding.JSONObject
) -&gt; commands.GuildCommandPermissions:
    permissions = [
        commands.CommandPermission(
            id=snowflakes.Snowflake(perm[&#34;id&#34;]),
            type=commands.CommandPermissionType(perm[&#34;type&#34;]),
            has_access=perm[&#34;permission&#34;],
        )
        for perm in payload[&#34;permissions&#34;]
    ]
    return commands.GuildCommandPermissions(
        application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
        command_id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
        permissions=permissions,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_member_ban" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_member_ban" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_member_ban" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_member_ban">deserialize_guild_member_ban</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.GuildBan'>GuildBan</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_member_ban -- Parse a raw payload from Discord into a guild member ban object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_member_ban"
>deserialize_guild_member_ban</a></code>
</p>
<p>Parse a raw payload from Discord into a guild member ban object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.GuildBan'>GuildBan</a></code></dt>
<dd>The deserialized guild member ban object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1305-L1306" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_member_ban(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildBan:
    return guild_models.GuildBan(reason=payload[&#34;reason&#34;], user=self.deserialize_user(payload[&#34;user&#34;]))</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_news_channel" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_news_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_news_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_news_channel">deserialize_guild_news_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildNewsChannel'>GuildNewsChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_news_channel -- Parse a raw payload from Discord into a guild news channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_news_channel"
>deserialize_guild_news_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a guild news channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is not included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildNewsChannel'>GuildNewsChannel</a></code></dt>
<dd>The deserialized guild news channel object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L721-L750" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_news_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildNewsChannel:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

    last_message_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
        last_message_id = snowflakes.Snowflake(raw_last_message_id)

    last_pin_timestamp: typing.Optional[datetime.datetime] = None
    if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
        last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

    return channel_models.GuildNewsChannel(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
        topic=payload[&#34;topic&#34;],
        last_message_id=last_message_id,
        last_pin_timestamp=last_pin_timestamp,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_preview" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_preview" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_preview" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_preview">deserialize_guild_preview</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.GuildPreview'>GuildPreview</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_preview -- Parse a raw payload from Discord into a guild preview object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_preview"
>deserialize_guild_preview</a></code>
</p>
<p>Parse a raw payload from Discord into a guild preview object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.GuildPreview'>GuildPreview</a></code></dt>
<dd>The deserialized guild preview object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1308-L1326" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_preview(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildPreview:
    guild_id = snowflakes.Snowflake(payload[&#34;id&#34;])
    emojis = {
        snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_id)
        for emoji in payload[&#34;emojis&#34;]
    }
    return guild_models.GuildPreview(
        app=self._app,
        id=guild_id,
        name=payload[&#34;name&#34;],
        icon_hash=payload[&#34;icon&#34;],
        features=[guild_models.GuildFeature(feature) for feature in payload[&#34;features&#34;]],
        splash_hash=payload[&#34;splash&#34;],
        discovery_splash_hash=payload[&#34;discovery_splash&#34;],
        emojis=emojis,
        approximate_active_member_count=int(payload[&#34;approximate_presence_count&#34;]),
        approximate_member_count=int(payload[&#34;approximate_member_count&#34;]),
        description=payload[&#34;description&#34;],
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_stage_channel" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_stage_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_stage_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_stage_channel">deserialize_guild_stage_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildStageChannel'>GuildStageChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_stage_channel -- Parse a raw payload from Discord into a guild stage channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_stage_channel"
>deserialize_guild_stage_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a guild stage channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is npt included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildStageChannel'>GuildStageChannel</a></code></dt>
<dd>The deserialized guild stage channel object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L798-L818" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_stage_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildStageChannel:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
    return channel_models.GuildStageChannel(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
        region=payload[&#34;rtc_region&#34;],
        bitrate=int(payload[&#34;bitrate&#34;]),
        user_limit=int(payload[&#34;user_limit&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_sticker" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_sticker" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_sticker" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_sticker">deserialize_guild_sticker</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../stickers.html#hikari.stickers.GuildSticker'>GuildSticker</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_sticker -- Parse a raw payload from Discord into a guild sticker object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_sticker"
>deserialize_guild_sticker</a></code>
</p>
<p>Parse a raw payload from Discord into a guild sticker object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../stickers.html#hikari.stickers.GuildSticker'>GuildSticker</a></code></dt>
<dd>The deserialized guild sticker object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1974-L1984" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_sticker(self, payload: data_binding.JSONObject) -&gt; sticker_models.GuildSticker:
    return sticker_models.GuildSticker(
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        description=payload[&#34;description&#34;],
        format_type=sticker_models.StickerFormatType(payload[&#34;format_type&#34;]),
        guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
        is_available=payload[&#34;available&#34;],
        tag=payload[&#34;tags&#34;],
        user=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_store_channel" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_store_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_store_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_store_channel">deserialize_guild_store_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildStoreChannel'>GuildStoreChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_store_channel -- Parse a raw payload from Discord into a guild store channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_store_channel"
>deserialize_guild_store_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a guild store channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is not included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildStoreChannel'>GuildStoreChannel</a></code></dt>
<dd>The deserialized guild store channel object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L752-L769" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_store_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildStoreChannel:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
    return channel_models.GuildStoreChannel(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_text_channel" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_text_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_text_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_text_channel">deserialize_guild_text_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildTextChannel'>GuildTextChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_text_channel -- Parse a raw payload from Discord into a guild text channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_text_channel"
>deserialize_guild_text_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a guild text channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is not included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildTextChannel'>GuildTextChannel</a></code></dt>
<dd>The deserialized guild text channel object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L686-L719" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_text_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildTextChannel:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)

    last_message_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_last_message_id := payload.get(&#34;last_message_id&#34;)) is not None:
        last_message_id = snowflakes.Snowflake(raw_last_message_id)

    last_pin_timestamp: typing.Optional[datetime.datetime] = None
    if (raw_last_pin_timestamp := payload.get(&#34;last_pin_timestamp&#34;)) is not None:
        last_pin_timestamp = time.iso8601_datetime_string_to_datetime(raw_last_pin_timestamp)

    return channel_models.GuildTextChannel(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
        topic=payload[&#34;topic&#34;],
        last_message_id=last_message_id,
        # Usually this is 0 if unset, but some old channels made before the
        # rate_limit_per_user field was implemented will not have this field
        # at all if they have never had the rate limit changed...
        rate_limit_per_user=datetime.timedelta(seconds=payload.get(&#34;rate_limit_per_user&#34;, 0)),
        last_pin_timestamp=last_pin_timestamp,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_voice_channel" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_voice_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_voice_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_voice_channel">deserialize_guild_voice_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../channels.html#hikari.channels.GuildVoiceChannel'>GuildVoiceChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_voice_channel -- Parse a raw payload from Discord into a guild voice channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_voice_channel"
>deserialize_guild_voice_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a guild voice channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this channel belongs to. If passed then this
will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> currently only covers the gateway GUILD_CREATE event
where <code>"guild_id"</code> is npt included in the channel's payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.GuildVoiceChannel'>GuildVoiceChannel</a></code></dt>
<dd>The deserialized guild voice channel object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L771-L796" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_voice_channel(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; channel_models.GuildVoiceChannel:
    channel_fields = self._set_guild_channel_attributes(payload, guild_id=guild_id)
    # Discord seems to be only returning this after it&#39;s been initially PATCHed in for older channels.
    video_quality_mode = payload.get(&#34;video_quality_mode&#34;, channel_models.VideoQualityMode.AUTO)
    return channel_models.GuildVoiceChannel(
        app=self._app,
        id=channel_fields.id,
        name=channel_fields.name,
        type=channel_fields.type,
        guild_id=channel_fields.guild_id,
        position=channel_fields.position,
        permission_overwrites=channel_fields.permission_overwrites,
        is_nsfw=channel_fields.is_nsfw,
        parent_id=channel_fields.parent_id,
        # There seems to be an edge case where rtc_region won&#39;t be included in gateway events (e.g. GUILD_CREATE)
        # for a voice channel that just hasn&#39;t been touched since this was introduced (e.g. has been archived).
        region=payload.get(&#34;rtc_region&#34;),
        bitrate=int(payload[&#34;bitrate&#34;]),
        user_limit=int(payload[&#34;user_limit&#34;]),
        video_quality_mode=channel_models.VideoQualityMode(int(video_quality_mode)),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_widget" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_guild_widget" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_widget" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_guild_widget">deserialize_guild_widget</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.GuildWidget'>GuildWidget</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_guild_widget -- Parse a raw payload from Discord into a guild widget object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_guild_widget"
>deserialize_guild_widget</a></code>
</p>
<p>Parse a raw payload from Discord into a guild widget object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.GuildWidget'>GuildWidget</a></code></dt>
<dd>The deserialized guild widget object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1109-L1114" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_guild_widget(self, payload: data_binding.JSONObject) -&gt; guild_models.GuildWidget:
    channel_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
        channel_id = snowflakes.Snowflake(raw_channel_id)

    return guild_models.GuildWidget(app=self._app, channel_id=channel_id, is_enabled=payload[&#34;enabled&#34;])</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_implicit_token" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_implicit_token" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_implicit_token" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_implicit_token">deserialize_implicit_token</a>(
    query: <a href='../internal/data_binding.html#hikari.internal.data_binding.Query'>data_binding.Query</a>,
) -> <a href='../applications.html#hikari.applications.OAuth2ImplicitToken'>OAuth2ImplicitToken</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_implicit_token -- Parse a query from Discord into an implicit token object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_implicit_token"
>deserialize_implicit_token</a></code>
</p>
<p>Parse a query from Discord into an implicit token object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>query</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.Query'>Query</a></code></dt>
<dd>The query parameters to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../applications.html#hikari.applications.OAuth2ImplicitToken'>OAuth2ImplicitToken</a></code></dt>
<dd>The deserialized OAuth2 implicit token object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L403-L410" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_implicit_token(self, query: data_binding.Query) -&gt; application_models.OAuth2ImplicitToken:
    return application_models.OAuth2ImplicitToken(
        access_token=query[&#34;access_token&#34;],
        token_type=application_models.TokenType(query[&#34;token_type&#34;]),
        expires_in=datetime.timedelta(seconds=int(query[&#34;expires_in&#34;])),
        scopes=[application_models.OAuth2Scope(scope) for scope in query[&#34;scope&#34;].split(&#34; &#34;)],
        state=query.get(&#34;state&#34;),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_incoming_webhook" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_incoming_webhook" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_incoming_webhook" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_incoming_webhook">deserialize_incoming_webhook</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../webhooks.html#hikari.webhooks.IncomingWebhook'>IncomingWebhook</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_incoming_webhook -- Parse a raw payload from Discord into a incoming webhook object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_incoming_webhook"
>deserialize_incoming_webhook</a></code>
</p>
<p>Parse a raw payload from Discord into a incoming webhook object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../webhooks.html#hikari.webhooks.IncomingWebhook'>IncomingWebhook</a></code></dt>
<dd>The parsed incoming webhook object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2676-L2692" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_incoming_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.IncomingWebhook:
    application_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_application_id := payload.get(&#34;application_id&#34;)) is not None:
        application_id = snowflakes.Snowflake(raw_application_id)

    return webhook_models.IncomingWebhook(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        type=webhook_models.WebhookType(payload[&#34;type&#34;]),
        guild_id=snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        author=self.deserialize_user(payload[&#34;user&#34;]) if &#34;user&#34; in payload else None,
        name=payload[&#34;name&#34;],
        avatar_hash=payload[&#34;avatar&#34;],
        token=payload.get(&#34;token&#34;),
        application_id=application_id,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_integration" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_integration" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_integration" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_integration">deserialize_integration</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../guilds.html#hikari.guilds.Integration'>Integration</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_integration -- Parse a raw payload from Discord into an integration object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_integration"
>deserialize_integration</a></code>
</p>
<p>Parse a raw payload from Discord into an integration object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this integration belongs to. If this is specified
then this will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.Integration'>Integration</a></code></dt>
<dd>The deserialized integration object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload for the payload of
the integration.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1243-L1303" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_integration(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; guild_models.Integration:
    integration_fields = self._set_partial_integration_attributes(payload)

    role_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_role_id := payload.get(&#34;role_id&#34;)) is not None:
        role_id = snowflakes.Snowflake(raw_role_id)

    last_synced_at: typing.Optional[datetime.datetime] = None
    if (raw_last_synced_at := payload.get(&#34;synced_at&#34;)) is not None:
        last_synced_at = time.iso8601_datetime_string_to_datetime(raw_last_synced_at)

    expire_grace_period: typing.Optional[datetime.timedelta] = None
    if (raw_expire_grace_period := payload.get(&#34;expire_grace_period&#34;)) is not None:
        expire_grace_period = datetime.timedelta(days=raw_expire_grace_period)

    expire_behavior: typing.Union[guild_models.IntegrationExpireBehaviour, int, None] = None
    if (raw_expire_behavior := payload.get(&#34;expire_behavior&#34;)) is not None:
        expire_behavior = guild_models.IntegrationExpireBehaviour(raw_expire_behavior)

    user: typing.Optional[user_models.User] = None
    if (raw_user := payload.get(&#34;user&#34;)) is not None:
        user = self.deserialize_user(raw_user)

    application: typing.Optional[guild_models.IntegrationApplication] = None
    if (raw_application := payload.get(&#34;application&#34;)) is not None:
        bot: typing.Optional[user_models.User] = None
        if (raw_application_bot := raw_application.get(&#34;bot&#34;)) is not None:
            bot = self.deserialize_user(raw_application_bot)

        application = guild_models.IntegrationApplication(
            id=snowflakes.Snowflake(raw_application[&#34;id&#34;]),
            name=raw_application[&#34;name&#34;],
            icon_hash=raw_application[&#34;icon&#34;],
            summary=raw_application[&#34;summary&#34;] or None,
            description=raw_application[&#34;description&#34;] or None,
            bot=bot,
        )

    return guild_models.Integration(
        id=integration_fields.id,
        guild_id=guild_id if guild_id is not undefined.UNDEFINED else snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
        name=integration_fields.name,
        type=integration_fields.type,
        account=integration_fields.account,
        is_enabled=payload[&#34;enabled&#34;],
        is_syncing=payload.get(&#34;syncing&#34;),
        is_revoked=payload.get(&#34;revoked&#34;),
        role_id=role_id,
        is_emojis_enabled=payload.get(&#34;enable_emoticons&#34;),
        expire_behavior=expire_behavior,
        expire_grace_period=expire_grace_period,
        user=user,
        last_synced_at=last_synced_at,
        subscriber_count=payload.get(&#34;subscriber_count&#34;),
        application=application,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_interaction" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_interaction" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_interaction" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_interaction">deserialize_interaction</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../interactions/base_interactions.html#hikari.interactions.base_interactions.PartialInteraction'>PartialInteraction</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_interaction -- Parse a raw payload from Discord into a interaction object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_interaction"
>deserialize_interaction</a></code>
</p>
<p>Parse a raw payload from Discord into a interaction object.</p>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>This isn't required to implement logic for deserializing
PING interactions and if you want to unmarshal those
<code>EntityFactory.deserialize_partial_interaction</code> should be compatible.</p>
</div>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../interactions/base_interactions.html#hikari.interactions.base_interactions.PartialInteraction'>PartialInteraction</a></code></dt>
<dd>The deserialized interaction object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='../errors.html#hikari.errors.UnrecognisedEntityError'>UnrecognisedEntityError</a></code></dt>
<dd>If the integration type is unknown.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1875-L1882" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_interaction(self, payload: data_binding.JSONObject) -&gt; base_interactions.PartialInteraction:
    interaction_type = base_interactions.InteractionType(payload[&#34;type&#34;])

    if deserialize := self._interaction_type_mapping.get(interaction_type):
        return deserialize(payload)

    _LOGGER.debug(&#34;Unknown interaction type %s&#34;, interaction_type)
    raise errors.UnrecognisedEntityError(f&#34;Unrecognised interaction type {interaction_type}&#34;)</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_invite" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite">deserialize_invite</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../invites.html#hikari.invites.Invite'>Invite</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_invite -- Parse a raw payload from Discord into an invite object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_invite"
>deserialize_invite</a></code>
</p>
<p>Parse a raw payload from Discord into an invite object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../invites.html#hikari.invites.Invite'>Invite</a></code></dt>
<dd>The deserialized invite object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1604-L1625" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_invite(self, payload: data_binding.JSONObject) -&gt; invite_models.Invite:
    invite_fields = self._set_invite_attributes(payload)

    expires_at: typing.Optional[datetime.datetime] = None
    if raw_expires_at := payload.get(&#34;expires_at&#34;):
        expires_at = time.iso8601_datetime_string_to_datetime(raw_expires_at)

    return invite_models.Invite(
        app=self._app,
        code=invite_fields.code,
        guild=invite_fields.guild,
        guild_id=invite_fields.guild_id,
        channel=invite_fields.channel,
        channel_id=invite_fields.channel_id,
        inviter=invite_fields.inviter,
        target_type=invite_fields.target_type,
        target_user=invite_fields.target_user,
        target_application=invite_fields.target_application,
        approximate_member_count=invite_fields.approximate_member_count,
        approximate_active_member_count=invite_fields.approximate_active_member_count,
        expires_at=expires_at,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite_with_metadata" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_invite_with_metadata" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite_with_metadata" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_invite_with_metadata">deserialize_invite_with_metadata</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../invites.html#hikari.invites.InviteWithMetadata'>InviteWithMetadata</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_invite_with_metadata -- Parse a raw payload from Discord into a invite with metadata object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_invite_with_metadata"
>deserialize_invite_with_metadata</a></code>
</p>
<p>Parse a raw payload from Discord into a invite with metadata object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../invites.html#hikari.invites.InviteWithMetadata'>InviteWithMetadata</a></code></dt>
<dd>The deserialized invite with metadata object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1627-L1657" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_invite_with_metadata(self, payload: data_binding.JSONObject) -&gt; invite_models.InviteWithMetadata:
    invite_fields = self._set_invite_attributes(payload)
    created_at = time.iso8601_datetime_string_to_datetime(payload[&#34;created_at&#34;])
    max_uses = int(payload[&#34;max_uses&#34;])

    expires_at: typing.Optional[datetime.datetime] = None
    max_age: typing.Optional[datetime.timedelta] = None
    if (raw_max_age := payload[&#34;max_age&#34;]) &gt; 0:
        max_age = datetime.timedelta(seconds=raw_max_age)
        expires_at = created_at + max_age

    return invite_models.InviteWithMetadata(
        app=self._app,
        code=invite_fields.code,
        guild=invite_fields.guild,
        guild_id=invite_fields.guild_id,
        channel=invite_fields.channel,
        channel_id=invite_fields.channel_id,
        inviter=invite_fields.inviter,
        target_type=invite_fields.target_type,
        target_user=invite_fields.target_user,
        target_application=invite_fields.target_application,
        approximate_member_count=invite_fields.approximate_member_count,
        approximate_active_member_count=invite_fields.approximate_active_member_count,
        uses=int(payload[&#34;uses&#34;]),
        max_uses=max_uses if max_uses &gt; 0 else None,
        max_age=max_age,
        is_temporary=payload[&#34;temporary&#34;],
        created_at=created_at,
        expires_at=expires_at,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_known_custom_emoji" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_known_custom_emoji" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_known_custom_emoji" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_known_custom_emoji">deserialize_known_custom_emoji</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>,
) -> <a href='../emojis.html#hikari.emojis.KnownCustomEmoji'>KnownCustomEmoji</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_known_custom_emoji -- Parse a raw payload from Discord into a known custom emoji object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_known_custom_emoji"
>deserialize_known_custom_emoji</a></code>
</p>
<p>Parse a raw payload from Discord into a known custom emoji object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this emoji belongs to. This is used to ensure
that the guild a known custom emoji belongs to is remembered by
allowing for a context based artificial <code>guild_id</code> attribute.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../emojis.html#hikari.emojis.KnownCustomEmoji'>KnownCustomEmoji</a></code></dt>
<dd>The deserialized "known custom emoji" object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1055-L1075" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_known_custom_emoji(
    self, payload: data_binding.JSONObject, *, guild_id: snowflakes.Snowflake
) -&gt; emoji_models.KnownCustomEmoji:
    role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]] if &#34;roles&#34; in payload else []

    user: typing.Optional[user_models.User] = None
    if (raw_user := payload.get(&#34;user&#34;)) is not None:
        user = self.deserialize_user(raw_user)

    return emoji_models.KnownCustomEmoji(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        is_animated=payload.get(&#34;animated&#34;, False),
        guild_id=guild_id,
        role_ids=role_ids,
        user=user,
        is_colons_required=payload[&#34;require_colons&#34;],
        is_managed=payload[&#34;managed&#34;],
        is_available=payload[&#34;available&#34;],
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_member" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member">deserialize_member</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    user: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../users.html#hikari.users.User'>user_models.User</a>] = UNDEFINED,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../guilds.html#hikari.guilds.Member'>Member</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_member -- Parse a raw payload from Discord into a member object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_member"
>deserialize_member</a></code>
</p>
<p>Parse a raw payload from Discord into a member object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>user</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../users.html#hikari.users.User'>User</a>]</code></dt>
<dd>The user to attach to this member, should only be passed in
situations where "user" is not included in the payload.</dd>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this member belongs to. If this is specified
then this will be prioritised over <code>"guild_id"</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p><code>guild_id</code> covers cases such as the GUILD_CREATE gateway event and
GET Guild Member where <code>"guild_id"</code> is not included in the returned
payload.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.Member'>Member</a></code></dt>
<dd>The deserialized member object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1152-L1187" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_member(
    self,
    payload: data_binding.JSONObject,
    *,
    user: undefined.UndefinedOr[user_models.User] = undefined.UNDEFINED,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; guild_models.Member:
    if user is undefined.UNDEFINED:
        user = self.deserialize_user(payload[&#34;user&#34;])

    if guild_id is undefined.UNDEFINED:
        guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

    role_ids = [snowflakes.Snowflake(role_id) for role_id in payload[&#34;roles&#34;]]
    # If Discord ever does start including this here without warning we don&#39;t want to duplicate the entry.
    if guild_id not in role_ids:
        role_ids.append(guild_id)

    joined_at = time.iso8601_datetime_string_to_datetime(payload[&#34;joined_at&#34;])

    raw_premium_since = payload.get(&#34;premium_since&#34;)
    premium_since = (
        time.iso8601_datetime_string_to_datetime(raw_premium_since) if raw_premium_since is not None else None
    )

    return guild_models.Member(
        user=user,
        guild_id=guild_id,
        role_ids=role_ids,
        joined_at=joined_at,
        nickname=payload.get(&#34;nick&#34;),
        premium_since=premium_since,
        is_deaf=payload.get(&#34;deaf&#34;, undefined.UNDEFINED),
        is_mute=payload.get(&#34;mute&#34;, undefined.UNDEFINED),
        is_pending=payload.get(&#34;pending&#34;, undefined.UNDEFINED),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member_presence" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_member_presence" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member_presence" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_member_presence">deserialize_member_presence</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
) -> <a href='../presences.html#hikari.presences.MemberPresence'>MemberPresence</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_member_presence -- Parse a raw payload from Discord into a member presence object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_member_presence"
>deserialize_member_presence</a></code>
</p>
<p>Parse a raw payload from Discord into a member presence object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild the presence belongs to. If this is specified
then it is prioritised over <code>guild_id</code> in the payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>At the time of writing, the only place where <code>guild_id</code> will be
mandatory is when parsing presences sent in a <code>GUILD_CREATE</code> event
from Discord, since the <code>guild_id</code> attribute in the payload will
have been omitted for redundancy.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../presences.html#hikari.presences.MemberPresence'>MemberPresence</a></code></dt>
<dd>The deserialized member presence object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>
<p>If <code>guild_id</code> is not an attribute of the <code>payload</code> dict, and no
guild ID was passed for the <code>guild_id</code> parameter.</p>
<p>If this is raised, no guild ID info was provided anywhere.</p>
</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2391-L2500" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_member_presence(  # noqa: CFQ001 - Max function length
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
) -&gt; presence_models.MemberPresence:
    activities = []
    for activity_payload in payload[&#34;activities&#34;]:
        timestamps: typing.Optional[presence_models.ActivityTimestamps] = None
        if &#34;timestamps&#34; in activity_payload:
            timestamps_payload = activity_payload[&#34;timestamps&#34;]
            start = (
                time.unix_epoch_to_datetime(timestamps_payload[&#34;start&#34;]) if &#34;start&#34; in timestamps_payload else None
            )
            end = time.unix_epoch_to_datetime(timestamps_payload[&#34;end&#34;]) if &#34;end&#34; in timestamps_payload else None
            timestamps = presence_models.ActivityTimestamps(start=start, end=end)

        application_id = (
            snowflakes.Snowflake(activity_payload[&#34;application_id&#34;])
            if &#34;application_id&#34; in activity_payload
            else None
        )

        party: typing.Optional[presence_models.ActivityParty] = None
        if &#34;party&#34; in activity_payload:
            party_payload = activity_payload[&#34;party&#34;]

            current_size: typing.Optional[int]
            max_size: typing.Optional[int]
            if &#34;size&#34; in party_payload:
                raw_current_size, raw_max_size = party_payload[&#34;size&#34;]
                current_size = int(raw_current_size)
                max_size = int(raw_max_size)
            else:
                current_size = max_size = None

            party = presence_models.ActivityParty(
                id=party_payload.get(&#34;id&#34;), current_size=current_size, max_size=max_size
            )

        assets: typing.Optional[presence_models.ActivityAssets] = None
        if &#34;assets&#34; in activity_payload:
            assets_payload = activity_payload[&#34;assets&#34;]
            assets = presence_models.ActivityAssets(
                large_image=assets_payload.get(&#34;large_image&#34;),
                large_text=assets_payload.get(&#34;large_text&#34;),
                small_image=assets_payload.get(&#34;small_image&#34;),
                small_text=assets_payload.get(&#34;small_text&#34;),
            )

        secrets: typing.Optional[presence_models.ActivitySecret] = None
        if &#34;secrets&#34; in activity_payload:
            secrets_payload = activity_payload[&#34;secrets&#34;]
            secrets = presence_models.ActivitySecret(
                join=secrets_payload.get(&#34;join&#34;),
                spectate=secrets_payload.get(&#34;spectate&#34;),
                match=secrets_payload.get(&#34;match&#34;),
            )

        emoji: typing.Optional[emoji_models.Emoji] = None
        raw_emoji = activity_payload.get(&#34;emoji&#34;)
        if raw_emoji is not None:
            emoji = self.deserialize_emoji(raw_emoji)

        activity = presence_models.RichActivity(
            name=activity_payload[&#34;name&#34;],
            # RichActivity&#39;s generated init already declares a converter for the &#34;type&#34; field
            type=activity_payload[&#34;type&#34;],
            url=activity_payload.get(&#34;url&#34;),
            created_at=time.unix_epoch_to_datetime(activity_payload[&#34;created_at&#34;]),
            timestamps=timestamps,
            application_id=application_id,
            details=activity_payload.get(&#34;details&#34;),
            state=activity_payload.get(&#34;state&#34;),
            emoji=emoji,
            party=party,
            assets=assets,
            secrets=secrets,
            is_instance=activity_payload.get(&#34;instance&#34;),  # TODO: can we safely default this to False?
            flags=presence_models.ActivityFlag(activity_payload[&#34;flags&#34;]) if &#34;flags&#34; in activity_payload else None,
            buttons=activity_payload.get(&#34;buttons&#34;) or [],
        )
        activities.append(activity)

    client_status_payload = payload[&#34;client_status&#34;]
    desktop = (
        presence_models.Status(client_status_payload[&#34;desktop&#34;])
        if &#34;desktop&#34; in client_status_payload
        else presence_models.Status.OFFLINE
    )
    mobile = (
        presence_models.Status(client_status_payload[&#34;mobile&#34;])
        if &#34;mobile&#34; in client_status_payload
        else presence_models.Status.OFFLINE
    )
    web = (
        presence_models.Status(client_status_payload[&#34;web&#34;])
        if &#34;web&#34; in client_status_payload
        else presence_models.Status.OFFLINE
    )
    client_status = presence_models.ClientStatus(desktop=desktop, mobile=mobile, web=web)

    return presence_models.MemberPresence(
        app=self._app,
        user_id=snowflakes.Snowflake(payload[&#34;user&#34;][&#34;id&#34;]),
        guild_id=guild_id if guild_id is not undefined.UNDEFINED else snowflakes.Snowflake(payload[&#34;guild_id&#34;]),
        visible_status=presence_models.Status(payload[&#34;status&#34;]),
        activities=activities,
        client_status=client_status,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_message" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_message" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_message" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_message">deserialize_message</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../messages.html#hikari.messages.Message'>Message</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_message -- Parse a raw payload from Discord into a message object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_message"
>deserialize_message</a></code>
</p>
<p>Parse a raw payload from Discord into a message object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../messages.html#hikari.messages.Message'>Message</a></code></dt>
<dd>The deserialized message object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2259-L2385" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_message(  # noqa CFQ001 - Function too long
    self, payload: data_binding.JSONObject
) -&gt; message_models.Message:
    author = self.deserialize_user(payload[&#34;author&#34;])

    guild_id: typing.Optional[snowflakes.Snowflake] = None
    member: undefined.UndefinedNoneOr[guild_models.Member] = None
    if &#34;guild_id&#34; in payload:
        guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        if member_pl := payload.get(&#34;member&#34;):
            member = self.deserialize_member(member_pl, user=author, guild_id=guild_id)
        else:
            member = undefined.UNDEFINED

    edited_timestamp: typing.Optional[datetime.datetime] = None
    if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
        edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)

    attachments = [self._deserialize_message_attachment(attachment) for attachment in payload[&#34;attachments&#34;]]

    embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

    if &#34;reactions&#34; in payload:
        reactions = [self._deserialize_message_reaction(reaction) for reaction in payload[&#34;reactions&#34;]]
    else:
        reactions = []

    activity: typing.Optional[message_models.MessageActivity] = None
    if &#34;activity&#34; in payload:
        activity = self._deserialize_message_activity(payload[&#34;activity&#34;])

    message_reference: typing.Optional[message_models.MessageReference] = None
    if &#34;message_reference&#34; in payload:
        message_reference = self._deserialize_message_reference(payload[&#34;message_reference&#34;])

    referenced_message: undefined.UndefinedNoneOr[message_models.Message] = undefined.UNDEFINED
    if &#34;referenced_message&#34; in payload:
        if (referenced_message_payload := payload[&#34;referenced_message&#34;]) is not None:
            referenced_message = self.deserialize_message(referenced_message_payload)
        else:
            referenced_message = None

    application: typing.Optional[message_models.MessageApplication] = None
    if &#34;application&#34; in payload:
        application = self._deserialize_message_application(payload[&#34;application&#34;])

    if &#34;sticker_items&#34; in payload:
        stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;sticker_items&#34;]]
    elif &#34;stickers&#34; in payload:
        stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;stickers&#34;]]
    else:
        stickers = []

    interaction: typing.Optional[message_models.MessageInteraction] = None
    if interaction_payload := payload.get(&#34;interaction&#34;):
        interaction = self._deserialize_message_interaction(interaction_payload)

    components: typing.List[message_models.PartialComponent] = []
    if component_payloads := payload.get(&#34;components&#34;):
        for component_payload in component_payloads:
            try:
                components.append(self.deserialize_component(component_payload))

            except errors.UnrecognisedEntityError:
                pass

    message = message_models.Message(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        guild_id=guild_id,
        author=author,
        member=member,
        content=payload[&#34;content&#34;] or None,
        timestamp=time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;]),
        edited_timestamp=edited_timestamp,
        is_tts=payload[&#34;tts&#34;],
        attachments=attachments,
        embeds=embeds,
        reactions=reactions,
        is_pinned=payload[&#34;pinned&#34;],
        webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else None,
        type=message_models.MessageType(payload[&#34;type&#34;]),
        activity=activity,
        application=application,
        message_reference=message_reference,
        referenced_message=referenced_message,
        flags=message_models.MessageFlag(payload[&#34;flags&#34;]),
        stickers=stickers,
        nonce=payload.get(&#34;nonce&#34;),
        application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]) if &#34;application_id&#34; in payload else None,
        interaction=interaction,
        components=components,
        # We initialize these next.
        mentions=NotImplemented,
    )

    if raw_channels := payload.get(&#34;mention_channels&#34;):
        channels = {c.id: c for c in map(self.deserialize_partial_channel, raw_channels)}

    else:
        channels = {}

    if raw_users := payload.get(&#34;mentions&#34;):
        users = {u.id: u for u in map(self.deserialize_user, raw_users)}

    else:
        users = {}

    if raw_role_ids := payload.get(&#34;mention_roles&#34;):
        role_ids = [snowflakes.Snowflake(i) for i in raw_role_ids]

    else:
        role_ids = []

    everyone = payload.get(&#34;mention_everyone&#34;, False)

    message.mentions = message_models.Mentions(
        message=message,
        users=users,
        role_ids=role_ids,
        channels=channels,
        everyone=everyone,
    )

    return message</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_my_user" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_my_user" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_my_user" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_my_user">deserialize_my_user</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../users.html#hikari.users.OwnUser'>OwnUser</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_my_user -- Parse a raw payload from Discord into a user object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_my_user"
>deserialize_my_user</a></code>
</p>
<p>Parse a raw payload from Discord into a user object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../users.html#hikari.users.OwnUser'>OwnUser</a></code></dt>
<dd>The deserialized user object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2602-L2618" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_my_user(self, payload: data_binding.JSONObject) -&gt; user_models.OwnUser:
    user_fields = self._set_user_attributes(payload)
    return user_models.OwnUser(
        app=self._app,
        id=user_fields.id,
        discriminator=user_fields.discriminator,
        username=user_fields.username,
        avatar_hash=user_fields.avatar_hash,
        is_bot=user_fields.is_bot,
        is_system=user_fields.is_system,
        is_mfa_enabled=payload[&#34;mfa_enabled&#34;],
        locale=payload.get(&#34;locale&#34;),
        is_verified=payload.get(&#34;verified&#34;),
        email=payload.get(&#34;email&#34;),
        flags=user_models.UserFlag(payload[&#34;flags&#34;]),
        premium_type=user_models.PremiumType(payload[&#34;premium_type&#34;]) if &#34;premium_type&#34; in payload else None,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_connection" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_own_connection" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_connection" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_connection">deserialize_own_connection</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../applications.html#hikari.applications.OwnConnection'>OwnConnection</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_own_connection -- Parse a raw payload from Discord into an own connection object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_own_connection"
>deserialize_own_connection</a></code>
</p>
<p>Parse a raw payload from Discord into an own connection object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../applications.html#hikari.applications.OwnConnection'>OwnConnection</a></code></dt>
<dd>The deserialized "own connection" object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L285-L301" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_own_connection(self, payload: data_binding.JSONObject) -&gt; application_models.OwnConnection:
    if (integration_payloads := payload.get(&#34;integrations&#34;)) is not None:
        integrations = [self.deserialize_partial_integration(integration) for integration in integration_payloads]
    else:
        integrations = []

    return application_models.OwnConnection(
        id=payload[&#34;id&#34;],
        name=payload[&#34;name&#34;],
        type=payload[&#34;type&#34;],
        is_revoked=payload[&#34;revoked&#34;],
        integrations=integrations,
        is_verified=payload[&#34;verified&#34;],
        is_friend_sync_enabled=payload[&#34;friend_sync&#34;],
        is_activity_visible=payload[&#34;show_activity&#34;],
        visibility=application_models.ConnectionVisibility(payload[&#34;visibility&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_guild" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_own_guild" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_guild" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_own_guild">deserialize_own_guild</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../applications.html#hikari.applications.OwnGuild'>OwnGuild</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_own_guild -- Parse a raw payload from Discord into an own guild object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_own_guild"
>deserialize_own_guild</a></code>
</p>
<p>Parse a raw payload from Discord into an own guild object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../applications.html#hikari.applications.OwnGuild'>OwnGuild</a></code></dt>
<dd>The deserialized "own guild" object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L303-L312" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_own_guild(self, payload: data_binding.JSONObject) -&gt; application_models.OwnGuild:
    return application_models.OwnGuild(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        icon_hash=payload[&#34;icon&#34;],
        features=[guild_models.GuildFeature(feature) for feature in payload[&#34;features&#34;]],
        is_owner=bool(payload[&#34;owner&#34;]),
        my_permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_channel" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_partial_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_channel">deserialize_partial_channel</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../channels.html#hikari.channels.PartialChannel'>PartialChannel</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_partial_channel -- Parse a raw payload from Discord into a partial channel object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_partial_channel"
>deserialize_partial_channel</a></code>
</p>
<p>Parse a raw payload from Discord into a partial channel object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.PartialChannel'>PartialChannel</a></code></dt>
<dd>The deserialized "partial channel" object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L591-L597" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_partial_channel(self, payload: data_binding.JSONObject) -&gt; channel_models.PartialChannel:
    return channel_models.PartialChannel(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload.get(&#34;name&#34;),
        type=channel_models.ChannelType(payload[&#34;type&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_integration" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_partial_integration" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_integration" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_integration">deserialize_partial_integration</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.PartialIntegration'>PartialIntegration</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_partial_integration -- Parse a raw payload from Discord into a partial integration object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_partial_integration"
>deserialize_partial_integration</a></code>
</p>
<p>Parse a raw payload from Discord into a partial integration object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.PartialIntegration'>PartialIntegration</a></code></dt>
<dd>The deserialized partial integration object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1234-L1241" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_partial_integration(self, payload: data_binding.JSONObject) -&gt; guild_models.PartialIntegration:
    integration_fields = self._set_partial_integration_attributes(payload)
    return guild_models.PartialIntegration(
        id=integration_fields.id,
        name=integration_fields.name,
        type=integration_fields.type,
        account=integration_fields.account,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_interaction" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_partial_interaction" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_interaction" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_interaction">deserialize_partial_interaction</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../interactions/base_interactions.html#hikari.interactions.base_interactions.PartialInteraction'>PartialInteraction</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_partial_interaction -- Parse a raw payload from Discord into a partial interaction object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_partial_interaction"
>deserialize_partial_interaction</a></code>
</p>
<p>Parse a raw payload from Discord into a partial interaction object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../interactions/base_interactions.html#hikari.interactions.base_interactions.PartialInteraction'>PartialInteraction</a></code></dt>
<dd>The deserialized partial interaction object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1728-L1736" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_partial_interaction(self, payload: data_binding.JSONObject) -&gt; base_interactions.PartialInteraction:
    return base_interactions.PartialInteraction(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        type=base_interactions.InteractionType(payload[&#34;type&#34;]),
        token=payload[&#34;token&#34;],
        version=payload[&#34;version&#34;],
        application_id=snowflakes.Snowflake(payload[&#34;application_id&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_message" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_partial_message" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_message" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_message">deserialize_partial_message</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../messages.html#hikari.messages.PartialMessage'>PartialMessage</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_partial_message -- Parse a raw payload from Discord into a partial message object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_partial_message"
>deserialize_partial_message</a></code>
</p>
<p>Parse a raw payload from Discord into a partial message object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../messages.html#hikari.messages.PartialMessage'>PartialMessage</a></code></dt>
<dd>The deserialized partial message object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2113-L2257" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_partial_message(  # noqa CFQ001 - Function too long
    self, payload: data_binding.JSONObject
) -&gt; message_models.PartialMessage:
    author: undefined.UndefinedOr[user_models.User] = undefined.UNDEFINED
    if author_pl := payload.get(&#34;author&#34;):
        author = self.deserialize_user(author_pl)

    guild_id: typing.Optional[snowflakes.Snowflake] = None
    member: undefined.UndefinedNoneOr[guild_models.Member] = None
    if &#34;guild_id&#34; in payload:
        guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

        if member_pl := payload.get(&#34;member&#34;):
            assert author is not None, &#34;received message with a member object without a user object&#34;
            member = self.deserialize_member(member_pl, user=author, guild_id=guild_id)
        else:
            member = undefined.UNDEFINED

    timestamp: undefined.UndefinedOr[datetime.datetime] = undefined.UNDEFINED
    if &#34;timestamp&#34; in payload:
        timestamp = time.iso8601_datetime_string_to_datetime(payload[&#34;timestamp&#34;])

    edited_timestamp: undefined.UndefinedNoneOr[datetime.datetime] = undefined.UNDEFINED
    if &#34;edited_timestamp&#34; in payload:
        if (raw_edited_timestamp := payload[&#34;edited_timestamp&#34;]) is not None:
            edited_timestamp = time.iso8601_datetime_string_to_datetime(raw_edited_timestamp)
        else:
            edited_timestamp = None

    attachments: undefined.UndefinedOr[typing.List[message_models.Attachment]] = undefined.UNDEFINED
    if &#34;attachments&#34; in payload:
        attachments = [self._deserialize_message_attachment(attachment) for attachment in payload[&#34;attachments&#34;]]

    embeds: undefined.UndefinedOr[typing.List[embed_models.Embed]] = undefined.UNDEFINED
    if &#34;embeds&#34; in payload:
        embeds = [self.deserialize_embed(embed) for embed in payload[&#34;embeds&#34;]]

    reactions: undefined.UndefinedOr[typing.List[message_models.Reaction]] = undefined.UNDEFINED
    if &#34;reactions&#34; in payload:
        reactions = [self._deserialize_message_reaction(reaction) for reaction in payload[&#34;reactions&#34;]]

    activity: undefined.UndefinedOr[message_models.MessageActivity] = undefined.UNDEFINED
    if &#34;activity&#34; in payload:
        activity = self._deserialize_message_activity(payload[&#34;activity&#34;])

    application: undefined.UndefinedOr[message_models.MessageApplication] = undefined.UNDEFINED
    if &#34;application&#34; in payload:
        application = self._deserialize_message_application(payload[&#34;application&#34;])

    message_reference: undefined.UndefinedOr[message_models.MessageReference] = undefined.UNDEFINED
    if &#34;message_reference&#34; in payload:
        message_reference = self._deserialize_message_reference(payload[&#34;message_reference&#34;])

    referenced_message: undefined.UndefinedNoneOr[message_models.Message] = undefined.UNDEFINED
    if &#34;referenced_message&#34; in payload:
        if (referenced_message_payload := payload[&#34;referenced_message&#34;]) is not None:
            referenced_message = self.deserialize_message(referenced_message_payload)
        else:
            referenced_message = None

    stickers: undefined.UndefinedOr[typing.Sequence[sticker_models.PartialSticker]] = undefined.UNDEFINED
    if &#34;sticker_items&#34; in payload:
        stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;sticker_items&#34;]]
    # This is only here for backwards compatibility as old messages still return this field
    elif &#34;stickers&#34; in payload:
        stickers = [self.deserialize_partial_sticker(sticker) for sticker in payload[&#34;stickers&#34;]]

    content = payload.get(&#34;content&#34;, undefined.UNDEFINED)
    if content is not undefined.UNDEFINED:
        content = content or None  # Default to None if content is an empty string

    application_id: undefined.UndefinedNoneOr[snowflakes.Snowflake] = undefined.UNDEFINED
    if raw_application_id := payload.get(&#34;application_id&#34;):
        application_id = snowflakes.Snowflake(raw_application_id)

    interaction: undefined.UndefinedNoneOr[message_models.MessageInteraction] = undefined.UNDEFINED
    if interaction_payload := payload.get(&#34;interaction&#34;):
        interaction = self._deserialize_message_interaction(interaction_payload)

    components: undefined.UndefinedOr[typing.List[message_models.PartialComponent]] = undefined.UNDEFINED
    if component_payloads := payload.get(&#34;components&#34;):
        components = []
        for component_payload in component_payloads:
            try:
                components.append(self.deserialize_component(component_payload))

            except errors.UnrecognisedEntityError:
                pass

    message = message_models.PartialMessage(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        channel_id=snowflakes.Snowflake(payload[&#34;channel_id&#34;]),
        guild_id=guild_id,
        author=author,
        member=member,
        content=content,
        timestamp=timestamp,
        edited_timestamp=edited_timestamp,
        is_tts=payload.get(&#34;tts&#34;, undefined.UNDEFINED),
        attachments=attachments,
        embeds=embeds,
        reactions=reactions,
        is_pinned=payload.get(&#34;pinned&#34;, undefined.UNDEFINED),
        webhook_id=snowflakes.Snowflake(payload[&#34;webhook_id&#34;]) if &#34;webhook_id&#34; in payload else undefined.UNDEFINED,
        type=message_models.MessageType(payload[&#34;type&#34;]) if &#34;type&#34; in payload else undefined.UNDEFINED,
        activity=activity,
        application=application,
        message_reference=message_reference,
        referenced_message=referenced_message,
        flags=message_models.MessageFlag(payload[&#34;flags&#34;]) if &#34;flags&#34; in payload else undefined.UNDEFINED,
        stickers=stickers,
        nonce=payload.get(&#34;nonce&#34;, undefined.UNDEFINED),
        application_id=application_id,
        interaction=interaction,
        components=components,
        # We initialize these next.
        mentions=NotImplemented,
    )

    channels: undefined.UndefinedOr[typing.Dict[snowflakes.Snowflake, channel_models.PartialChannel]]
    channels = undefined.UNDEFINED
    if raw_channels := payload.get(&#34;mention_channels&#34;):
        channels = {c.id: c for c in map(self.deserialize_partial_channel, raw_channels)}

    users: undefined.UndefinedOr[typing.Dict[snowflakes.Snowflake, user_models.User]]
    users = undefined.UNDEFINED
    if raw_users := payload.get(&#34;mentions&#34;):
        users = {u.id: u for u in map(self.deserialize_user, raw_users)}

    role_ids: undefined.UndefinedOr[typing.List[snowflakes.Snowflake]] = undefined.UNDEFINED
    if raw_role_ids := payload.get(&#34;mention_roles&#34;):
        role_ids = [snowflakes.Snowflake(i) for i in raw_role_ids]

    everyone = payload.get(&#34;mention_everyone&#34;, undefined.UNDEFINED)

    message.mentions = message_models.Mentions(
        message=message,
        users=users,
        role_ids=role_ids,
        channels=channels,
        everyone=everyone,
    )

    return message</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_sticker" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_partial_sticker" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_sticker" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_sticker">deserialize_partial_sticker</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../stickers.html#hikari.stickers.PartialSticker'>PartialSticker</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_partial_sticker -- Parse a raw payload from Discord into a partial sticker object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_partial_sticker"
>deserialize_partial_sticker</a></code>
</p>
<p>Parse a raw payload from Discord into a partial sticker object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../stickers.html#hikari.stickers.PartialSticker'>PartialSticker</a></code></dt>
<dd>The deserialized partial sticker object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1956-L1961" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_partial_sticker(self, payload: data_binding.JSONObject) -&gt; sticker_models.PartialSticker:
    return sticker_models.PartialSticker(
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        format_type=sticker_models.StickerFormatType(payload[&#34;format_type&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_token" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_partial_token" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_token" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_partial_token">deserialize_partial_token</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../applications.html#hikari.applications.PartialOAuth2Token'>PartialOAuth2Token</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_partial_token -- Parse a raw payload from Discord into a partial OAuth2 token object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_partial_token"
>deserialize_partial_token</a></code>
</p>
<p>Parse a raw payload from Discord into a partial OAuth2 token object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../applications.html#hikari.applications.PartialOAuth2Token'>PartialOAuth2Token</a></code></dt>
<dd>The deserialized partial OAuth2 token object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L382-L388" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_partial_token(self, payload: data_binding.JSONObject) -&gt; application_models.PartialOAuth2Token:
    return application_models.PartialOAuth2Token(
        access_token=payload[&#34;access_token&#34;],
        token_type=application_models.TokenType(payload[&#34;token_type&#34;]),
        expires_in=datetime.timedelta(seconds=int(payload[&#34;expires_in&#34;])),
        scopes=[application_models.OAuth2Scope(scope) for scope in payload[&#34;scope&#34;].split(&#34; &#34;)],
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_permission_overwrite" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_permission_overwrite" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_permission_overwrite" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_permission_overwrite">deserialize_permission_overwrite</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../channels.html#hikari.channels.PermissionOverwrite'>PermissionOverwrite</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_permission_overwrite -- Parse a raw payload from Discord into a permission overwrite object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_permission_overwrite"
>deserialize_permission_overwrite</a></code>
</p>
<p>Parse a raw payload from Discord into a permission overwrite object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../channels.html#hikari.channels.PermissionOverwrite'>PermissionOverwrite</a></code></dt>
<dd>The deserialized permission overwrite object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L571-L579" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_permission_overwrite(self, payload: data_binding.JSONObject) -&gt; channel_models.PermissionOverwrite:
    return channel_models.PermissionOverwrite(
        # PermissionOverwrite&#39;s init has converters set for these fields which will handle casting
        id=payload[&#34;id&#34;],
        type=payload[&#34;type&#34;],
        # Permissions still have to be cast to int before they can be cast to Permission typing wise.
        allow=int(payload[&#34;allow&#34;]),
        deny=int(payload[&#34;deny&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_rest_guild" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_rest_guild" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_rest_guild" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_rest_guild">deserialize_rest_guild</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.RESTGuild'>RESTGuild</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_rest_guild -- Parse a raw payload from Discord into a guild object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_rest_guild"
>deserialize_rest_guild</a></code>
</p>
<p>Parse a raw payload from Discord into a guild object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.RESTGuild'>RESTGuild</a></code></dt>
<dd>The deserialized guild object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1378-L1438" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_rest_guild(self, payload: data_binding.JSONObject) -&gt; guild_models.RESTGuild:
    guild_fields = self._set_guild_attributes(payload)

    approximate_member_count: typing.Optional[int] = None
    if &#34;approximate_member_count&#34; in payload:
        approximate_member_count = int(payload[&#34;approximate_member_count&#34;])

    approximate_active_member_count: typing.Optional[int] = None
    if &#34;approximate_presence_count&#34; in payload:
        approximate_active_member_count = int(payload[&#34;approximate_presence_count&#34;])

    max_members = int(payload[&#34;max_members&#34;])

    raw_max_presences = payload[&#34;max_presences&#34;]
    max_presences = int(raw_max_presences) if raw_max_presences is not None else None

    roles = {
        snowflakes.Snowflake(role[&#34;id&#34;]): self.deserialize_role(role, guild_id=guild_fields.id)
        for role in payload[&#34;roles&#34;]
    }
    emojis = {
        snowflakes.Snowflake(emoji[&#34;id&#34;]): self.deserialize_known_custom_emoji(emoji, guild_id=guild_fields.id)
        for emoji in payload[&#34;emojis&#34;]
    }
    return guild_models.RESTGuild(
        app=self._app,
        id=guild_fields.id,
        name=guild_fields.name,
        icon_hash=guild_fields.icon_hash,
        features=guild_fields.features,
        splash_hash=guild_fields.splash_hash,
        discovery_splash_hash=guild_fields.discovery_splash_hash,
        owner_id=guild_fields.owner_id,
        afk_channel_id=guild_fields.afk_channel_id,
        afk_timeout=guild_fields.afk_timeout,
        verification_level=guild_fields.verification_level,
        default_message_notifications=guild_fields.default_message_notifications,
        explicit_content_filter=guild_fields.explicit_content_filter,
        mfa_level=guild_fields.mfa_level,
        application_id=guild_fields.application_id,
        widget_channel_id=guild_fields.widget_channel_id,
        system_channel_id=guild_fields.system_channel_id,
        is_widget_enabled=guild_fields.is_widget_enabled,
        system_channel_flags=guild_fields.system_channel_flags,
        rules_channel_id=guild_fields.rules_channel_id,
        max_presences=max_presences,
        max_members=max_members,
        max_video_channel_users=guild_fields.max_video_channel_users,
        vanity_url_code=guild_fields.vanity_url_code,
        description=guild_fields.description,
        banner_hash=guild_fields.banner_hash,
        premium_tier=guild_fields.premium_tier,
        nsfw_level=guild_fields.nsfw_level,
        premium_subscription_count=guild_fields.premium_subscription_count,
        preferred_locale=guild_fields.preferred_locale,
        public_updates_channel_id=guild_fields.public_updates_channel_id,
        approximate_member_count=approximate_member_count,
        approximate_active_member_count=approximate_active_member_count,
        roles=roles,
        emojis=emojis,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_role" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_role" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_role" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_role">deserialize_role</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>,
) -> <a href='../guilds.html#hikari.guilds.Role'>Role</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_role -- Parse a raw payload from Discord into a role object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_role"
>deserialize_role</a></code>
</p>
<p>Parse a raw payload from Discord into a role object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a></code></dt>
<dd>The ID of the guild this role belongs to. This is used to ensure
that the guild a role belongs to is remembered by allowing for a
context based artificial <code>guild_id</code> attribute.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.Role'>Role</a></code></dt>
<dd>The deserialized role object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1189-L1221" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_role(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: snowflakes.Snowflake,
) -&gt; guild_models.Role:
    bot_id: typing.Optional[snowflakes.Snowflake] = None
    integration_id: typing.Optional[snowflakes.Snowflake] = None
    is_premium_subscriber_role: bool = False
    if &#34;tags&#34; in payload:
        tags_payload = payload[&#34;tags&#34;]
        if &#34;bot_id&#34; in tags_payload:
            bot_id = snowflakes.Snowflake(tags_payload[&#34;bot_id&#34;])
        if &#34;integration_id&#34; in tags_payload:
            integration_id = snowflakes.Snowflake(tags_payload[&#34;integration_id&#34;])
        if &#34;premium_subscriber&#34; in tags_payload:
            is_premium_subscriber_role = True

    return guild_models.Role(
        app=self._app,
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        guild_id=guild_id,
        name=payload[&#34;name&#34;],
        color=color_models.Color(payload[&#34;color&#34;]),
        is_hoisted=payload[&#34;hoist&#34;],
        position=int(payload[&#34;position&#34;]),
        permissions=permission_models.Permissions(int(payload[&#34;permissions&#34;])),
        is_managed=payload[&#34;managed&#34;],
        is_mentionable=payload[&#34;mentionable&#34;],
        bot_id=bot_id,
        integration_id=integration_id,
        is_premium_subscriber_role=is_premium_subscriber_role,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_select_menu" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_select_menu" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_select_menu" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_select_menu">deserialize_select_menu</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../messages.html#hikari.messages.SelectMenuComponent'>SelectMenuComponent</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_select_menu -- Parse a raw payload from Discord into a select menu component object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_select_menu"
>deserialize_select_menu</a></code>
</p>
<p>Parse a raw payload from Discord into a select menu component object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../messages.html#hikari.messages.SelectMenuComponent'>SelectMenuComponent</a></code></dt>
<dd>The deserialized button component.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2016-L2041" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_select_menu(self, payload: data_binding.JSONObject) -&gt; message_models.SelectMenuComponent:
    options: typing.List[message_models.SelectMenuOption] = []
    for option_payload in payload[&#34;options&#34;]:
        emoji = None
        if emoji_payload := option_payload.get(&#34;emoji&#34;):
            emoji = self.deserialize_emoji(emoji_payload)

        options.append(
            message_models.SelectMenuOption(
                label=option_payload[&#34;label&#34;],
                value=option_payload[&#34;value&#34;],
                description=option_payload.get(&#34;description&#34;),
                emoji=emoji,
                is_default=option_payload.get(&#34;default&#34;, False),
            )
        )

    return message_models.SelectMenuComponent(
        type=message_models.ComponentType(payload[&#34;type&#34;]),
        custom_id=payload[&#34;custom_id&#34;],
        options=options,
        placeholder=payload.get(&#34;placeholder&#34;),
        min_values=payload.get(&#34;min_values&#34;, 1),
        max_values=payload.get(&#34;max_values&#34;, 1),
        is_disabled=payload.get(&#34;disabled&#34;, False),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_standard_sticker" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_standard_sticker" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_standard_sticker" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_standard_sticker">deserialize_standard_sticker</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../stickers.html#hikari.stickers.StandardSticker'>StandardSticker</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_standard_sticker -- Parse a raw payload from Discord into a standard sticker object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_standard_sticker"
>deserialize_standard_sticker</a></code>
</p>
<p>Parse a raw payload from Discord into a standard sticker object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../stickers.html#hikari.stickers.StandardSticker'>StandardSticker</a></code></dt>
<dd>The deserialized standard sticker object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1963-L1972" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_standard_sticker(self, payload: data_binding.JSONObject) -&gt; sticker_models.StandardSticker:
    return sticker_models.StandardSticker(
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        description=payload[&#34;description&#34;],
        format_type=sticker_models.StickerFormatType(payload[&#34;format_type&#34;]),
        pack_id=snowflakes.Snowflake(payload[&#34;pack_id&#34;]),
        sort_value=payload[&#34;sort_value&#34;],
        tags=[tag.strip() for tag in payload[&#34;tags&#34;].split(&#34;,&#34;)],
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_sticker_pack" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_sticker_pack" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_sticker_pack" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_sticker_pack">deserialize_sticker_pack</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../stickers.html#hikari.stickers.StickerPack'>StickerPack</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_sticker_pack -- Parse a raw payload from Discord into a sticker pack object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_sticker_pack"
>deserialize_sticker_pack</a></code>
</p>
<p>Parse a raw payload from Discord into a sticker pack object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../stickers.html#hikari.stickers.StickerPack'>StickerPack</a></code></dt>
<dd>The deserialized sticker pack object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1941-L1954" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_sticker_pack(self, payload: data_binding.JSONObject) -&gt; sticker_models.StickerPack:
    pack_stickers: typing.List[sticker_models.StandardSticker] = []
    for sticker_payload in payload[&#34;stickers&#34;]:
        pack_stickers.append(self.deserialize_standard_sticker(sticker_payload))

    return sticker_models.StickerPack(
        id=snowflakes.Snowflake(payload[&#34;id&#34;]),
        name=payload[&#34;name&#34;],
        description=payload[&#34;description&#34;],
        cover_sticker_id=snowflakes.Snowflake(payload[&#34;cover_sticker_id&#34;]),
        stickers=pack_stickers,
        sku_id=snowflakes.Snowflake(payload[&#34;sku_id&#34;]),
        banner_hash=payload[&#34;banner_asset_id&#34;],
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_template" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_template" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_template" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_template">deserialize_template</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../templates.html#hikari.templates.Template'>Template</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_template -- Parse a raw payload from Discord into a template object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_template"
>deserialize_template</a></code>
</p>
<p>Parse a raw payload from Discord into a template object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../templates.html#hikari.templates.Template'>Template</a></code></dt>
<dd>The deserialized template object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2506-L2569" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_template(self, payload: data_binding.JSONObject) -&gt; template_models.Template:
    source_guild_payload = payload[&#34;serialized_source_guild&#34;]
    # For some reason the guild ID isn&#39;t on the actual guild object in this special case.
    guild_id = snowflakes.Snowflake(payload[&#34;source_guild_id&#34;])
    default_message_notifications = guild_models.GuildMessageNotificationsLevel(
        source_guild_payload[&#34;default_message_notifications&#34;]
    )
    explicit_content_filter = guild_models.GuildExplicitContentFilterLevel(
        source_guild_payload[&#34;explicit_content_filter&#34;]
    )

    roles: typing.Dict[snowflakes.Snowflake, template_models.TemplateRole] = {}
    for role_payload in source_guild_payload[&#34;roles&#34;]:
        role = template_models.TemplateRole(
            app=self._app,
            id=snowflakes.Snowflake(role_payload[&#34;id&#34;]),
            name=role_payload[&#34;name&#34;],
            permissions=permission_models.Permissions(int(role_payload[&#34;permissions&#34;])),
            color=color_models.Color(role_payload[&#34;color&#34;]),
            is_hoisted=role_payload[&#34;hoist&#34;],
            is_mentionable=role_payload[&#34;mentionable&#34;],
        )
        roles[role.id] = role

    channels = {}
    for channel_payload in source_guild_payload[&#34;channels&#34;]:
        channel = self.deserialize_channel(channel_payload, guild_id=guild_id)
        assert isinstance(channel, channel_models.GuildChannel)
        channels[channel.id] = channel

    afk_channel_id = source_guild_payload[&#34;afk_channel_id&#34;]
    system_channel_id = source_guild_payload[&#34;system_channel_id&#34;]

    source_guild = template_models.TemplateGuild(
        app=self._app,
        id=guild_id,
        # For some reason in this case they use the key &#34;icon_hash&#34; rather than &#34;icon&#34;.
        # Cause Discord:TM:
        icon_hash=source_guild_payload[&#34;icon_hash&#34;],
        name=source_guild_payload[&#34;name&#34;],
        description=source_guild_payload[&#34;description&#34;],
        verification_level=guild_models.GuildVerificationLevel(source_guild_payload[&#34;verification_level&#34;]),
        default_message_notifications=default_message_notifications,
        explicit_content_filter=explicit_content_filter,
        preferred_locale=source_guild_payload[&#34;preferred_locale&#34;],
        afk_timeout=datetime.timedelta(seconds=source_guild_payload[&#34;afk_timeout&#34;]),
        roles=roles,
        channels=channels,
        afk_channel_id=snowflakes.Snowflake(afk_channel_id) if afk_channel_id is not None else None,
        system_channel_id=snowflakes.Snowflake(system_channel_id) if system_channel_id is not None else None,
        system_channel_flags=guild_models.GuildSystemChannelFlag(source_guild_payload[&#34;system_channel_flags&#34;]),
    )

    return template_models.Template(
        code=payload[&#34;code&#34;],
        name=payload[&#34;name&#34;],
        description=payload[&#34;description&#34;],
        usage_count=payload[&#34;usage_count&#34;],
        creator=self.deserialize_user(payload[&#34;creator&#34;]),
        created_at=time.iso8601_datetime_string_to_datetime(payload[&#34;created_at&#34;]),
        updated_at=time.iso8601_datetime_string_to_datetime(payload[&#34;updated_at&#34;]),
        source_guild=source_guild,
        is_unsynced=bool(payload[&#34;is_dirty&#34;]),
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_unicode_emoji" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_unicode_emoji" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_unicode_emoji" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_unicode_emoji">deserialize_unicode_emoji</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../emojis.html#hikari.emojis.UnicodeEmoji'>UnicodeEmoji</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_unicode_emoji -- Parse a raw payload from Discord into a unicode emoji object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_unicode_emoji"
>deserialize_unicode_emoji</a></code>
</p>
<p>Parse a raw payload from Discord into a unicode emoji object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../emojis.html#hikari.emojis.UnicodeEmoji'>UnicodeEmoji</a></code></dt>
<dd>The deserialized unicode emoji object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1045-L1046" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_unicode_emoji(self, payload: data_binding.JSONObject) -&gt; emoji_models.UnicodeEmoji:
    return emoji_models.UnicodeEmoji(payload[&#34;name&#34;])</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_user" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_user" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_user" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_user">deserialize_user</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../users.html#hikari.users.User'>User</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_user -- Parse a raw payload from Discord into a user object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_user"
>deserialize_user</a></code>
</p>
<p>Parse a raw payload from Discord into a user object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../users.html#hikari.users.User'>User</a></code></dt>
<dd>The deserialized user object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2586-L2600" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_user(self, payload: data_binding.JSONObject) -&gt; user_models.User:
    user_fields = self._set_user_attributes(payload)
    flags = (
        user_models.UserFlag(payload[&#34;public_flags&#34;]) if &#34;public_flags&#34; in payload else user_models.UserFlag.NONE
    )
    return user_models.UserImpl(
        app=self._app,
        id=user_fields.id,
        discriminator=user_fields.discriminator,
        username=user_fields.username,
        avatar_hash=user_fields.avatar_hash,
        is_bot=user_fields.is_bot,
        is_system=user_fields.is_system,
        flags=flags,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_vanity_url" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_vanity_url" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_vanity_url" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_vanity_url">deserialize_vanity_url</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../invites.html#hikari.invites.VanityURL'>VanityURL</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_vanity_url -- Parse a raw payload from Discord into a vanity url object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_vanity_url"
>deserialize_vanity_url</a></code>
</p>
<p>Parse a raw payload from Discord into a vanity url object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../invites.html#hikari.invites.VanityURL'>VanityURL</a></code></dt>
<dd>The deserialized vanity url object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1536-L1537" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_vanity_url(self, payload: data_binding.JSONObject) -&gt; invite_models.VanityURL:
    return invite_models.VanityURL(app=self._app, code=payload[&#34;code&#34;], uses=int(payload[&#34;uses&#34;]))</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_region" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_voice_region" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_region" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_region">deserialize_voice_region</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../voices.html#hikari.voices.VoiceRegion'>VoiceRegion</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_voice_region -- Parse a raw payload from Discord into a voice region object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_voice_region"
>deserialize_voice_region</a></code>
</p>
<p>Parse a raw payload from Discord into a voice region object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../voices.html#hikari.voices.VoiceRegion'>VoiceRegion</a></code></dt>
<dd>The deserialized voice region object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2662-L2670" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_voice_region(self, payload: data_binding.JSONObject) -&gt; voice_models.VoiceRegion:
    return voice_models.VoiceRegion(
        id=payload[&#34;id&#34;],
        name=payload[&#34;name&#34;],
        is_vip=payload[&#34;vip&#34;],
        is_optimal_location=payload[&#34;optimal&#34;],
        is_deprecated=payload[&#34;deprecated&#34;],
        is_custom=payload[&#34;custom&#34;],
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_state" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_voice_state" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_state" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_voice_state">deserialize_voice_state</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
    *,
    guild_id: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>snowflakes.Snowflake</a>] = UNDEFINED,
    member: <a href='../undefined.html#hikari.undefined.UndefinedOr'>undefined.UndefinedOr</a>[<a href='../guilds.html#hikari.guilds.Member'>guild_models.Member</a>] = UNDEFINED,
) -> <a href='../voices.html#hikari.voices.VoiceState'>VoiceState</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_voice_state -- Parse a raw payload from Discord into a voice state object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_voice_state"
>deserialize_voice_state</a></code>
</p>
<p>Parse a raw payload from Discord into a voice state object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="other-parameters">Other Parameters</h2>
<dl>
<dt><strong><code>guild_id</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../snowflakes.html#hikari.snowflakes.Snowflake'>Snowflake</a>]</code></dt>
<dd>The ID of the guild this voice state belongs to. If this is specified
then this will be prioritised over <code>"guild_id"</code> in the payload.</dd>
<dt><strong><code>member</code></strong> :&ensp;<code><a href='../undefined.html#hikari.undefined.UndefinedOr'>UndefinedOr</a>[<a href='../guilds.html#hikari.guilds.Member'>Member</a>]</code></dt>
<dd>The object of the member this voice state belongs to. If this is
specified then this will be prioritised over <code>"member"</code> in the
payload.</dd>
</dl>
<div class="alert alert-success">
<p class="admonition-title">Note</p>
<p>At the time of writing, <code>GUILD_CREATE</code> events are the only known
place where neither <code>guild_id</code> nor <code>member</code> will be keys on the
payload. In this case, you will need to provide the former
parameters explicitly.</p>
</div>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../voices.html#hikari.voices.VoiceState'>VoiceState</a></code></dt>
<dd>The deserialized voice state object.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/exceptions.html#KeyError'>KeyError</a></code></dt>
<dd>
<p>If <code>guild_id</code> is left as <code><a href='../undefined.html#hikari.undefined.UNDEFINED'>UNDEFINED</a></code> when
<code>"guild_id"</code> is not present in the passed payload for the payload of
the voice state.</p>
<p>This will also be raised if no <code>member</code> data was passed in any
acceptable place.</p>
</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2624-L2660" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_voice_state(
    self,
    payload: data_binding.JSONObject,
    *,
    guild_id: undefined.UndefinedOr[snowflakes.Snowflake] = undefined.UNDEFINED,
    member: undefined.UndefinedOr[guild_models.Member] = undefined.UNDEFINED,
) -&gt; voice_models.VoiceState:
    if guild_id is undefined.UNDEFINED:
        guild_id = snowflakes.Snowflake(payload[&#34;guild_id&#34;])

    channel_id: typing.Optional[snowflakes.Snowflake] = None
    if (raw_channel_id := payload[&#34;channel_id&#34;]) is not None:
        channel_id = snowflakes.Snowflake(raw_channel_id)

    if member is undefined.UNDEFINED:
        member = self.deserialize_member(payload[&#34;member&#34;], guild_id=guild_id)

    requested_to_speak_at: typing.Optional[datetime.datetime] = None
    if raw_requested_to_speak_at := payload.get(&#34;request_to_speak_timestamp&#34;):
        requested_to_speak_at = time.iso8601_datetime_string_to_datetime(raw_requested_to_speak_at)

    return voice_models.VoiceState(
        app=self._app,
        guild_id=guild_id,
        channel_id=channel_id,
        user_id=snowflakes.Snowflake(payload[&#34;user_id&#34;]),
        member=member,
        session_id=payload[&#34;session_id&#34;],
        is_guild_deafened=payload[&#34;deaf&#34;],
        is_guild_muted=payload[&#34;mute&#34;],
        is_self_deafened=payload[&#34;self_deaf&#34;],
        is_self_muted=payload[&#34;self_mute&#34;],
        is_streaming=payload.get(&#34;self_stream&#34;, False),
        is_video_enabled=payload[&#34;self_video&#34;],
        is_suppressed=payload[&#34;suppress&#34;],
        requested_to_speak_at=requested_to_speak_at,
    )</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_webhook" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_webhook" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_webhook" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_webhook">deserialize_webhook</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../webhooks.html#hikari.webhooks.PartialWebhook'>PartialWebhook</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_webhook -- Parse a raw payload from Discord into a webhook object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_webhook"
>deserialize_webhook</a></code>
</p>
<p>Parse a raw payload from Discord into a webhook object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../webhooks.html#hikari.webhooks.PartialWebhook'>PartialWebhook</a></code></dt>
<dd>The deserialized webhook object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L2738-L2745" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_webhook(self, payload: data_binding.JSONObject) -&gt; webhook_models.PartialWebhook:
    webhook_type = webhook_models.WebhookType(payload[&#34;type&#34;])

    if converter := self._webhook_type_mapping.get(webhook_type):
        return converter(payload)

    _LOGGER.debug(f&#34;Unrecognised webhook type {webhook_type}&#34;)
    raise errors.UnrecognisedEntityError(f&#34;Unrecognised webhook type {webhook_type}&#34;)</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_welcome_screen" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="deserialize_welcome_screen" href="#hikari.impl.entity_factory.EntityFactoryImpl.deserialize_welcome_screen" id="hikari.impl.entity_factory.EntityFactoryImpl.deserialize_welcome_screen">deserialize_welcome_screen</a>(
    payload: <a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>data_binding.JSONObject</a>,
) -> <a href='../guilds.html#hikari.guilds.WelcomeScreen'>WelcomeScreen</a>: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="deserialize_welcome_screen -- Parse a raw payload from Discord into a guild welcome screen object …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.deserialize_welcome_screen"
>deserialize_welcome_screen</a></code>
</p>
<p>Parse a raw payload from Discord into a guild welcome screen object.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>payload</code></strong> :&ensp;<code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The JSON payload to deserialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../guilds.html#hikari.guilds.WelcomeScreen'>WelcomeScreen</a></code></dt>
<dd>The deserialized guild welcome screen object.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1116-L1136" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def deserialize_welcome_screen(self, payload: data_binding.JSONObject) -&gt; guild_models.WelcomeScreen:
    channels: typing.List[guild_models.WelcomeChannel] = []

    for channel_payload in payload[&#34;welcome_channels&#34;]:
        raw_emoji_id = channel_payload[&#34;emoji_id&#34;]
        emoji_id = snowflakes.Snowflake(raw_emoji_id) if raw_emoji_id else None

        emoji_name: typing.Union[None, emoji_models.UnicodeEmoji, str]
        if (emoji_name := channel_payload[&#34;emoji_name&#34;]) and not emoji_id:
            emoji_name = emoji_models.UnicodeEmoji(emoji_name)

        channels.append(
            guild_models.WelcomeChannel(
                channel_id=snowflakes.Snowflake(channel_payload[&#34;channel_id&#34;]),
                description=channel_payload[&#34;description&#34;],
                emoji_id=emoji_id,
                emoji_name=emoji_name,
            )
        )

    return guild_models.WelcomeScreen(description=payload[&#34;description&#34;], channels=channels)</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_command_option" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="serialize_command_option" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_command_option" id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_command_option">serialize_command_option</a>(
    option: <a href='../commands.html#hikari.commands.CommandOption'>commands.CommandOption</a>,
) -> Dict[<a href='https://docs.python.org/3/library/stdtypes.html#str'>str</a>, Any]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="serialize_command_option -- Serialize a command option object to a json serializable dict …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.serialize_command_option"
>serialize_command_option</a></code>
</p>
<p>Serialize a command option object to a json serializable dict.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>option</code></strong> :&ensp;<code><a href='../commands.html#hikari.commands.CommandOption'>CommandOption</a></code></dt>
<dd>The command option object to serialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The serialized representation of the command option.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1884-L1898" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def serialize_command_option(self, option: commands.CommandOption) -&gt; data_binding.JSONObject:
    payload: data_binding.JSONObject = {
        &#34;type&#34;: option.type,
        &#34;name&#34;: option.name,
        &#34;description&#34;: option.description,
        &#34;required&#34;: option.is_required,
    }

    if option.choices is not None:
        payload[&#34;choices&#34;] = [{&#34;name&#34;: choice.name, &#34;value&#34;: choice.value} for choice in option.choices]

    if option.options is not None:
        payload[&#34;options&#34;] = [self.serialize_command_option(suboption) for suboption in option.options]

    return payload</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_command_permission" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="serialize_command_permission" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_command_permission" id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_command_permission">serialize_command_permission</a>(
    permission: <a href='../commands.html#hikari.commands.CommandPermission'>commands.CommandPermission</a>,
) -> Dict[<a href='https://docs.python.org/3/library/stdtypes.html#str'>str</a>, Any]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="serialize_command_permission -- Serialize a command permission object to a json serializable dict …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.serialize_command_permission"
>serialize_command_permission</a></code>
</p>
<p>Serialize a command permission object to a json serializable dict.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>permission</code></strong> :&ensp;<code><a href='../commands.html#hikari.commands.CommandPermission'>CommandPermission</a></code></dt>
<dd>The command permission object to serialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The serialized representation of the command permission.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1725-L1726" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def serialize_command_permission(self, permission: commands.CommandPermission) -&gt; data_binding.JSONObject:
    return {&#34;id&#34;: str(permission.id), &#34;type&#34;: permission.type, &#34;permission&#34;: permission.has_access}</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_embed" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="serialize_embed" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_embed" id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_embed">serialize_embed</a>(
    embed: <a href='../embeds.html#hikari.embeds.Embed'>embed_models.Embed</a>,
) -> Tuple[Dict[<a href='https://docs.python.org/3/library/stdtypes.html#str'>str</a>, Any], List[<a href='../files.html#hikari.files.Resource'>Resource</a>[<a href='../files.html#hikari.files.AsyncReader'>AsyncReader</a>]]]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="serialize_embed -- Serialize an embed object to a json serializable dict …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.serialize_embed"
>serialize_embed</a></code>
</p>
<p>Serialize an embed object to a json serializable dict.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>embed</code></strong> :&ensp;<code><a href='../embeds.html#hikari.embeds.Embed'>Embed</a></code></dt>
<dd>The embed object to serialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='https://docs.python.org/3/library/typing.html#typing.Tuple'>Tuple</a>[<a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a>, <a href='https://docs.python.org/3/library/typing.html#typing.List'>List</a>[<a href='../files.html#hikari.files.Resource'>Resource</a>]]</code></dt>
<dd>A tuple with two items in it. The first item will be the serialized
embed representation. The second item will be a list of resources
to upload with the embed.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L937-L1039" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def serialize_embed(  # noqa: C901 - Function too complex
    self,
    embed: embed_models.Embed,
) -&gt; typing.Tuple[data_binding.JSONObject, typing.List[files.Resource[files.AsyncReader]]]:

    payload: data_binding.JSONObject = {}
    uploads: typing.List[files.Resource[files.AsyncReader]] = []

    if embed.title is not None:
        payload[&#34;title&#34;] = embed.title

    if embed.description is not None:
        payload[&#34;description&#34;] = embed.description

    if embed.url is not None:
        payload[&#34;url&#34;] = embed.url

    if embed.timestamp is not None:
        payload[&#34;timestamp&#34;] = embed.timestamp.isoformat()

    if embed.color is not None:
        payload[&#34;color&#34;] = int(embed.color)

    if embed.footer is not None:
        footer_payload: data_binding.JSONObject = {}

        if embed.footer.text is not None:
            footer_payload[&#34;text&#34;] = embed.footer.text

        if embed.footer.icon is not None:
            if not isinstance(embed.footer.icon.resource, files.WebResource):
                uploads.append(embed.footer.icon.resource)

            footer_payload[&#34;icon_url&#34;] = embed.footer.icon.url

        payload[&#34;footer&#34;] = footer_payload

    if embed.image is not None:
        image_payload: data_binding.JSONObject = {}

        if not isinstance(embed.image.resource, files.WebResource):
            uploads.append(embed.image.resource)

        image_payload[&#34;url&#34;] = embed.image.url
        payload[&#34;image&#34;] = image_payload

    if embed.thumbnail is not None:
        thumbnail_payload: data_binding.JSONObject = {}

        if not isinstance(embed.thumbnail.resource, files.WebResource):
            uploads.append(embed.thumbnail.resource)

        thumbnail_payload[&#34;url&#34;] = embed.thumbnail.url
        payload[&#34;thumbnail&#34;] = thumbnail_payload

    if embed.author is not None:
        author_payload: data_binding.JSONObject = {}

        if embed.author.name is not None:
            author_payload[&#34;name&#34;] = embed.author.name

        if embed.author.url is not None:
            author_payload[&#34;url&#34;] = embed.author.url

        if embed.author.icon is not None:
            if not isinstance(embed.author.icon.resource, files.WebResource):
                uploads.append(embed.author.icon.resource)
            author_payload[&#34;icon_url&#34;] = embed.author.icon.url

        payload[&#34;author&#34;] = author_payload

    if embed.fields:
        field_payloads: data_binding.JSONArray = []
        for i, field in enumerate(embed.fields):

            # Yep, these are technically two unreachable branches. However, this is an incredibly
            # common mistake to make when working with embeds and not using a static type
            # checker, so I have added these as additional safeguards for UX and ease
            # of debugging. The case that there are `None` should be detected immediately by
            # static type checkers, regardless.
            name = str(field.name) if field.name is not None else None
            value = str(field.value) if field.value is not None else None

            if name is None:
                raise TypeError(f&#34;in embed.fields[{i}].name - cannot have `None`&#34;)
            if not name:
                raise TypeError(f&#34;in embed.fields[{i}].name - cannot have empty string&#34;)
            if not name.strip():
                raise TypeError(f&#34;in embed.fields[{i}].name - cannot have only whitespace&#34;)

            if value is None:
                raise TypeError(f&#34;in embed.fields[{i}].value - cannot have `None`&#34;)
            if not value:
                raise TypeError(f&#34;in embed.fields[{i}].value - cannot have empty string&#34;)
            if not value.strip():
                raise TypeError(f&#34;in embed.fields[{i}].value - cannot have only whitespace&#34;)

            # Name and value always have to be specified; we can always
            # send a default `inline` value also just to keep this simpler.
            field_payloads.append({&#34;name&#34;: name, &#34;value&#34;: value, &#34;inline&#34;: field.is_inline})
        payload[&#34;fields&#34;] = field_payloads

    return payload, uploads</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_permission_overwrite" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="serialize_permission_overwrite" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_permission_overwrite" id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_permission_overwrite">serialize_permission_overwrite</a>(
    overwrite: <a href='../channels.html#hikari.channels.PermissionOverwrite'>channel_models.PermissionOverwrite</a>,
) -> Dict[<a href='https://docs.python.org/3/library/stdtypes.html#str'>str</a>, Any]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="serialize_permission_overwrite -- Serialize a permission overwrite object to a json serializable dict …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.serialize_permission_overwrite"
>serialize_permission_overwrite</a></code>
</p>
<p>Serialize a permission overwrite object to a json serializable dict.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>overwrite</code></strong> :&ensp;<code><a href='../channels.html#hikari.channels.PermissionOverwrite'>PermissionOverwrite</a></code></dt>
<dd>The permission overwrite object to serialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The serialized representation of the permission overwrite.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L581-L589" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def serialize_permission_overwrite(self, overwrite: channel_models.PermissionOverwrite) -&gt; data_binding.JSONObject:
    # https://github.com/discord/discord-api-docs/pull/1843/commits/470677363ba88fbc1fe79228821146c6d6b488b9
    # allow and deny can be strings instead now.
    return {
        &#34;id&#34;: str(overwrite.id),
        &#34;type&#34;: overwrite.type,
        &#34;allow&#34;: str(int(overwrite.allow)),
        &#34;deny&#34;: str(int(overwrite.deny)),
    }</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
<div id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_welcome_channel" class="anchor">
<dt>
<pre><code class="hljs python"><abbr title='A standard Python function.'>def</abbr> <a title="serialize_welcome_channel" href="#hikari.impl.entity_factory.EntityFactoryImpl.serialize_welcome_channel" id="hikari.impl.entity_factory.EntityFactoryImpl.serialize_welcome_channel">serialize_welcome_channel</a>(
    welcome_channel: <a href='../guilds.html#hikari.guilds.WelcomeChannel'>guild_models.WelcomeChannel</a>,
) -> Dict[<a href='https://docs.python.org/3/library/stdtypes.html#str'>str</a>, Any]: ...</code></pre>
</dt>
<dd>
<p class="inheritance">
<em><small>Inherited from:</small></em>
<code><a title="EntityFactory -- Interface for components that serialize and deserialize JSON payloads." href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory"
>EntityFactory</a></code>.<code><a title="serialize_welcome_channel -- Serialize a welcome channel object to a json serializable dict …" href="../api/entity_factory.html#hikari.api.entity_factory.EntityFactory.serialize_welcome_channel"
>serialize_welcome_channel</a></code>
</p>
<p>Serialize a welcome channel object to a json serializable dict.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>welcome_channel</code></strong> :&ensp;<code><a href='../guilds.html#hikari.guilds.WelcomeChannel'>WelcomeChannel</a></code></dt>
<dd>The guild welcome channel object to serialize.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a href='../internal/data_binding.html#hikari.internal.data_binding.JSONObject'>JSONObject</a></code></dt>
<dd>The serialized representation of the welcome channel.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
<br />
<a href="https://github.com/hikari-py/hikari/blob/3bdf1e44d6f73760631a8d27dd70a5783da80ceb/hikari/impl/entity_factory.py#L1138-L1150" class="git-link dotted">Browse git</a>
</summary>
<pre><code class="python">def serialize_welcome_channel(self, welcome_channel: guild_models.WelcomeChannel) -&gt; data_binding.JSONObject:
    payload: data_binding.JSONObject = {
        &#34;channel_id&#34;: str(welcome_channel.channel_id),
        &#34;description&#34;: welcome_channel.description,
    }

    if welcome_channel.emoji_id is not None:
        payload[&#34;emoji_id&#34;] = str(welcome_channel.emoji_id)

    elif welcome_channel.emoji_name is not None:
        payload[&#34;emoji_name&#34;] = str(welcome_channel.emoji_name)

    return payload</code></pre>
</details>
</dd>
</div>
<div class="sep"></div>
</dl>
<div class="sep"></div>
</dd>
</div>
</dl>
</section>
</div>
</div>
</div>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>